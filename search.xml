<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Random Forest]]></title>
    <url>%2F2018%2F05%2F18%2FRandom-Forest%2F</url>
    <content type="text"><![CDATA[ä¹‹å‰æˆ‘ä»¬è®²åˆ°äº†å†³ç­–æ ‘ï¼ŒçŽ°åœ¨æˆ‘ä»¬æ¥è®²ä¸€ä¸‹éšæœºæ£®æž—ï¼ŒæŠŠè¿™æ®µçŸ¥è¯†è¡¥ä¸Šã€‚ é¦–å…ˆä»€ä¹ˆæ˜¯éšæœºæ£®æž—ï¼Ÿéšæœºæ£®æž—å°±æ˜¯ç”¨éšæœºçš„æ–¹å¼å»ºç«‹ä¸€ä¸ªæ£®æž—ï¼Œåœ¨æ£®æž—é‡Œæœ‰å¾ˆå¤šå†³ç­–æ ‘ç»„æˆï¼Œå¹¶ä¸”æ¯ä¸€æ£µå†³ç­–æ ‘ä¹‹é—´æ˜¯æ²¡æœ‰å…³è”çš„ã€‚å½“æœ‰ä¸€ä¸ªæ–°æ ·æœ¬çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®©æ£®æž—çš„æ¯ä¸€æ£µå†³ç­–æ ‘åˆ†åˆ«è¿›è¡Œåˆ¤æ–­ï¼Œçœ‹çœ‹è¿™ä¸ªæ ·æœ¬å±žäºŽå“ªä¸€ç±»ï¼Œç„¶åŽç”¨æŠ•ç¥¨çš„æ–¹å¼ï¼Œå“ªä¸€ç±»è¢«é€‰æ‹©çš„å¤šï¼Œä½œä¸ºæœ€ç»ˆçš„åˆ†ç±»ç»“æžœã€‚åœ¨å›žå½’é—®é¢˜ä¸­ï¼Œéšæœºæ£®æž—è¾“å‡ºæ‰€æœ‰å†³ç­–æ ‘è¾“å‡ºçš„å¹³å‡å€¼ã€‚ éšæœºæ£®æž—æ—¢å¯ä»¥ç”¨äºŽåˆ†ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºŽå›žå½’ã€‚ å®ƒæ˜¯ä¸€ç§é™ç»´æ‰‹æ®µï¼Œç”¨äºŽå¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼ã€‚ å®ƒæ˜¯é›†æˆå­¦ä¹ çš„é‡è¦æ–¹æ³•ã€‚ ä¸¤ä¸ªéšæœºæŠ½å– æ ·æœ¬æœ‰æ”¾å›žéšæœºæŠ½å–å›ºå®šæ•°ç›® æž„å»ºå†³ç­–æ ‘æ—¶ï¼Œç‰¹å¾éšæœºæŠ½å– è§£é‡Šï¼šä¸¤ä¸ªéšæœºæ€§çš„å¼•å…¥å¯¹éšæœºæ£®æž—çš„åˆ†ç±»æ€§èƒ½è‡³å…³é‡è¦ã€‚ç”±äºŽå®ƒä»¬çš„å¼•å…¥ï¼Œä½¿å¾—éšæœºæ£®æž—ä¸å®¹æ˜“é™·å…¥è¿‡æ‹Ÿåˆï¼Œå¹¶ä¸”å…·æœ‰å¾ˆå¥½å¾—æŠ—å™ªèƒ½åŠ›ï¼ˆæ¯”å¦‚ï¼šå¯¹ç¼ºçœå€¼ä¸æ•æ„Ÿï¼‰ éšæœºæ£®æž—ç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿåœ¨éšæœºæ£®æž—ä¸­ï¼Œæ¯ä¸€ä¸ªå†³ç­–æ ‘â€œç§æ¤â€å’Œâ€œç”Ÿé•¿â€çš„å››ä¸ªæ­¥éª¤ï¼š å‡è®¾æˆ‘ä»¬è®¾å®šè®­ç»ƒé›†ä¸­çš„æ ·æœ¬ä¸ªæ•°ä¸ºNï¼Œç„¶åŽé€šè¿‡æœ‰æ”¾å›žçš„æœ‰æ”¾å›žçš„éšæœºé€‰æ‹©Nä¸ªæ ·æœ¬(ä¸€æ¬¡)ï¼Œç”¨è¿™é€‰æ‹©å¥½äº†çš„Nä¸ªæ ·æœ¬ç”¨æ¥è®­ç»ƒä¸€ä¸ªå†³ç­–æ ‘ï¼Œä½œä¸ºå†³ç­–æ ‘æ ¹èŠ‚ç‚¹å¤„çš„æ ·æœ¬ï¼› å½“æ¯ä¸ªæ ·æœ¬æœ‰Mä¸ªå±žæ€§æ—¶ï¼Œåœ¨å†³ç­–æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹éœ€è¦åˆ†è£‚æ—¶ï¼Œéšæœºä»Žè¿™Mä¸ªå±žæ€§ä¸­é€‰å–å‡ºmä¸ªå±žæ€§ï¼Œæ»¡è¶³æ¡ä»¶m &lt;&lt; Mã€‚ç„¶åŽä»Žè¿™mä¸ªå±žæ€§ä¸­é‡‡ç”¨æŸç§ç­–ç•¥ï¼ˆæ¯”å¦‚è¯´ä¿¡æ¯å¢žç›Šï¼‰æ¥é€‰æ‹©1ä¸ªå±žæ€§ä½œä¸ºè¯¥èŠ‚ç‚¹çš„åˆ†è£‚å±žæ€§ã€‚ æ¯æ£µå†³ç­–æ ‘éƒ½æœ€å¤§å¯èƒ½åœ°è¿›è¡Œç”Ÿé•¿è€Œä¸è¿›è¡Œå‰ªæžï¼› é€šè¿‡å¯¹æ‰€æœ‰çš„å†³ç­–æ ‘è¿›è¡ŒåŠ æ€»æ¥é¢„æµ‹æ–°çš„æ•°æ®ï¼ˆåœ¨åˆ†ç±»æ—¶é‡‡ç”¨å¤šæ•°æŠ•ç¥¨ï¼Œåœ¨å›žå½’æ—¶é‡‡ç”¨å¹³å‡ï¼‰ã€‚ éšæœºæ£®æž—çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š ç”±äºŽæ¯æ¬¡ä¸å†è€ƒè™‘å…¨éƒ¨çš„å±žæ€§ï¼Œè€Œæ˜¯ä¸€ä¸ªå±žæ€§å­é›†ï¼Œæ‰€ä»¥ç›¸æ¯”äºŽBaggingè®¡ç®—å¼€é”€æ›´å°ï¼Œè®­ç»ƒæ•ˆçŽ‡æ›´é«˜ å¯¹é«˜ç»´æ•°æ®çš„å¤„ç†èƒ½åŠ›å¼ºï¼Œå¯ä»¥å¤„ç†æˆåƒä¸Šä¸‡çš„è¾“å…¥å˜é‡ï¼Œæ˜¯ä¸€ä¸ªéžå¸¸ä¸é”™çš„é™ç»´æ–¹æ³• èƒ½å¤Ÿè¾“å‡ºç‰¹å¾çš„é‡è¦ç¨‹åº¦, åŸºäºŽoobè¯¯åˆ†ç±»çŽ‡å’ŒåŸºäºŽGiniç³»æ•°çš„å˜åŒ– æœ‰æ•ˆçš„å¤„ç†ç¼ºçœå€¼ ç¼ºç‚¹ï¼š åœ¨å™ªå£°è¾ƒå¤§çš„æ—¶å€™å®¹æ˜“è¿‡æ‹Ÿåˆ é‡è¦å‚æ•°éšæœºæ£®æž—åˆ†ç±»æ•ˆæžœï¼ˆé”™è¯¯çŽ‡ï¼‰ä¸Žä¸¤ä¸ªå› ç´ æœ‰å…³ï¼š æ£®æž—ä¸­ä»»æ„ä¸¤æ£µæ ‘çš„ç›¸å…³æ€§ï¼šç›¸å…³æ€§è¶Šå¤§ï¼Œé”™è¯¯çŽ‡è¶Šå¤§ï¼› æ£®æž—ä¸­æ¯æ£µæ ‘çš„åˆ†ç±»èƒ½åŠ›ï¼šæ¯æ£µæ ‘çš„åˆ†ç±»èƒ½åŠ›è¶Šå¼ºï¼Œæ•´ä¸ªæ£®æž—çš„é”™è¯¯çŽ‡è¶Šä½Žã€‚ å‡å°ç‰¹å¾é€‰æ‹©ä¸ªæ•°mï¼Œæ ‘çš„ç›¸å…³æ€§å’Œåˆ†ç±»èƒ½åŠ›ä¹Ÿä¼šç›¸åº”çš„é™ä½Žï¼›å¢žå¤§mï¼Œä¸¤è€…ä¹Ÿä¼šéšä¹‹å¢žå¤§ã€‚æ‰€ä»¥å…³é”®é—®é¢˜æ˜¯å¦‚ä½•é€‰æ‹©æœ€ä¼˜çš„mï¼ˆæˆ–è€…æ˜¯èŒƒå›´ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯éšæœºæ£®æž—å”¯ä¸€çš„ä¸€ä¸ªå‚æ•°ã€‚åœ¨å­¦ä¹ å¦‚ä½•é€‰æ‹©å‚æ•°å‰é¦–å…ˆä»‹ç»oobçš„æ¦‚å¿µã€‚ oobï¼šè¢‹å¤–é”™è¯¯çŽ‡ä¸ºäº†é€‰æ‹©æœ€ä¼˜çš„mï¼Œè¿™é‡Œéœ€è¦åˆ©ç”¨çš„æ˜¯è¢‹å¤–é”™è¯¯çŽ‡oobï¼ˆout-of-bag errorï¼‰ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æž„å»ºæ¯ä¸ªå†³ç­–æ ‘çš„æ—¶å€™ï¼Œé‡‡ç”¨çš„æ˜¯éšæœºæœ‰æ”¾å›žçš„æŠ½å–ï¼Œæ‰€ä»¥å¯¹äºŽæ¯æ£µæ ‘æ¥è¯´ï¼Œéƒ½æœ‰ä¸€äº›æ ·æœ¬(çº¦å 1/3)å®žé™…ä¸Šæ²¡æœ‰å‚ä¸Žæ ‘çš„ç”Ÿæˆï¼Œæ‰€ä»¥è¿™äº›æ ·æœ¬æˆä¸ºè¢‹å¤–æ ·æœ¬ï¼Œå³oobã€‚ä¸Žäº¤å‰éªŒè¯ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå†³ç­–æ ‘çš„obbæ ·æœ¬ä½œä¸ºè¿™æ£µæ ‘çš„éªŒè¯é›†ï¼Œå¯¹oobé›†åˆè¿›è¡Œä¼°è®¡çš„æ­¥éª¤å…¥ä¸‹ï¼š å¯¹æ¯ä¸ªæ ·æœ¬ï¼Œè®¡ç®—å®ƒä½œä¸ºoobæ ·æœ¬çš„æ ‘å¯¹å®ƒçš„åˆ†ç±»æƒ…å†µ å¤šæ•°æŠ•ç¥¨ä½œä¸ºè¯¥æ ·æœ¬çš„åˆ†ç±»ç»“æžœ ç”¨è¯¯åˆ†ä¸ªæ•°å æ ·æœ¬æ€»æ•°çš„æ¯”çŽ‡ä½œä¸ºéšæœºæ£®æž—çš„oobè¯¯åˆ†çŽ‡ oobè¯¯åˆ†çŽ‡æ˜¯éšæœºæ£®æž—æ³›åŒ–è¯¯å·®çš„ä¸€ä¸ªæ— åä¼°è®¡ï¼Œå®ƒçš„ç»“æžœè¿‘ä¼¼äºŽéœ€è¦å¤§é‡è®¡ç®—çš„kæŠ˜äº¤å‰éªŒè¯ã€‚æ‰€ä»¥æ²¡æœ‰å¿…è¦å¯¹å®ƒè¿›è¡Œäº¤å‰éªŒè¯æˆ–è€…ç”¨ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•é›†æ¥èŽ·å¾—è¯¯å·®çš„ä¸€ä¸ªæ— åä¼°è®¡ã€‚å®ƒå¯ä»¥åœ¨å†…éƒ¨è¿›è¡Œè¯„ä¼°ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç”Ÿæˆçš„è¿‡ç¨‹ä¸­å°±å¯ä»¥å¯¹è¯¯å·®å»ºç«‹ä¸€ä¸ªæ— åä¼°è®¡ã€‚ å½“æˆ‘ä»¬çŸ¥é“äº†oobçš„è®¡ç®—æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é€‰å–ä¸åŒçš„mï¼Œè®¡ç®—oob_errorï¼Œæ‰¾å‡ºoob_erroræœ€å°æ—¶å¯¹åº”çš„mçš„å€¼ã€‚è¿™å’Œäº¤å‰éªŒè¯çš„æ€æƒ³éžå¸¸çš„ç›¸ä¼¼ã€‚ RFç‰¹å¾é‡è¦æ€§çš„åº¦é‡æ–¹æ³• å¯¹äºŽæ¯ä¸€æ£µå†³ç­–æ ‘ï¼Œè®¡ç®—å…¶oob_error_0 é€‰å–ä¸€ä¸ªç‰¹å¾ï¼Œéšæœºå¯¹ç‰¹å¾åŠ å…¥å™ªå£°å¹²æ‰°ï¼Œå†æ¬¡è®¡ç®—oob error_1 ç‰¹å¾çš„é‡è¦æ€§=âˆ‘(oob_error_1-oob_error_0)/éšæœºæ£®æž—ä¸­å†³ç­–æ ‘çš„ä¸ªæ•° å¯¹éšæœºæ£®æž—ä¸­çš„ç‰¹å¾å˜é‡æŒ‰ç…§ç‰¹å¾é‡è¦æ€§é™åºæŽ’åºã€‚ ç„¶åŽé‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°é€‰å‡ºmä¸ªç‰¹å¾ã€‚ è§£é‡Šï¼šç”¨è¿™ä¸ªå…¬å¼æ¥åº¦é‡ç‰¹å¾é‡è¦æ€§ï¼ŒåŽŸå› æ˜¯ï¼šç»™æŸä¸ªç‰¹å¾éšæœºçš„åŠ å…¥å™ªå£°åŽï¼Œå¦‚æžœoob errorå¢žå¤§ï¼Œè¯´æ˜Žè¿™ä¸ªç‰¹å¾å¯¹æ ·æœ¬åˆ†ç±»çš„ç»“æžœå½±å“æ¯”è¾ƒå¤§ï¼Œè¯´æ˜Žé‡è¦ç¨‹åº¦æ¯”è¾ƒé«˜ã€‚ RFç‰¹å¾é€‰æ‹©é¦–å…ˆç‰¹å¾é€‰æ‹©çš„ç›®æ ‡æœ‰ä¸¤ä¸ªï¼š 1ï¼šæ‰¾åˆ°ä¸Žåˆ†ç±»ç»“æžœé«˜åº¦ç›¸å…³çš„ç‰¹å¾å˜é‡ã€‚ 2ï¼šé€‰æ‹©å‡ºæ•°ç›®è¾ƒå°‘çš„ç‰¹å¾å˜é‡å¹¶ä¸”èƒ½å¤Ÿå……åˆ†çš„é¢„æµ‹åº”å˜é‡çš„ç»“æžœã€‚ ç‰¹å¾é€‰æ‹©çš„æ­¥éª¤ï¼š ï¼ˆ1ï¼‰å¯¹äºŽæ¯ä¸€æ£µå†³ç­–æ ‘ï¼Œè®¡ç®—å…¶oob_error ï¼ˆ2ï¼‰éšæœºçš„ä¿®æ”¹OOBä¸­çš„æ¯ä¸ªç‰¹å¾xiçš„å€¼ï¼Œè®¡ç®—oob_error_2ï¼Œå†æ¬¡è®¡ç®—é‡è¦æ€§ ï¼ˆ3ï¼‰æŒ‰ç…§ç‰¹å¾çš„é‡è¦æ€§æŽ’åºï¼Œç„¶åŽå‰”é™¤åŽé¢ä¸é‡è¦çš„ç‰¹å¾ ï¼ˆ4ï¼‰ç„¶åŽé‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°é€‰å‡ºmä¸ªç‰¹å¾ã€‚ å‡ ä¸ªé—®é¢˜###ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆè¦éšæœºæŠ½å–æ ·æœ¬ï¼Ÿ ç­”ï¼šå¦‚æžœä¸è¿›è¡ŒéšæœºæŠ½æ ·ï¼Œå¯¹äºŽæ¯ä¸ªæ ‘çš„è®­ç»ƒé›†éƒ½æ˜¯ç›¸åŒçš„ï¼Œè®­ç»ƒå‡ºæ¥çš„ç»“æžœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æ­¤æ—¶è¿›è¡ŒæŠ•ç¥¨å†³ç­–æ²¡æœ‰æ„ä¹‰ã€‚ ###ï¼ˆ2ï¼‰ä¸ºä»€ä¹ˆè¦æœ‰æ”¾å›žçš„åŽ»æŠ½æ ·å‘¢? ç­”ï¼šå¦‚æžœä¸æ˜¯æœ‰æ”¾å›žçš„æŠ½æ ·ï¼Œé‚£ä¹ˆæ¯ä¸€æ£µæ ‘çš„è®­ç»ƒæ ·æœ¬æ˜¯ä¸åŒçš„ï¼Œéƒ½æ˜¯æ²¡æœ‰äº¤é›†çš„ï¼Œé‚£ä¹ˆæ¯æ£µæ ‘éƒ½æ˜¯æœ‰åçš„ï¼Œéƒ½æ˜¯ç‰‡é¢çš„ï¼Œæ ‘ä¸Žæ ‘ä¹‹é—´å¹¶ä¸æ˜¯å®Œå…¨å…¬å¹³çš„ã€‚æˆ‘ä»¬éœ€è¦çš„æ˜¯ï¼Œæ²¡é¢—å†³ç­–æ ‘æ˜¯å…¬å¹³çš„ï¼Œç„¶åŽè®©å®ƒä»¬æŠ•ç¥¨å†³ç­–å¾—å‡ºç»“æžœï¼Œå¹¶ä¸”è¿™æ ·å¯ä»¥é˜²æ­¢è¿‡åº¦æ‹Ÿåˆã€‚ ###ï¼ˆ3ï¼‰è¿™é‡ŒæŒ‡çš„æœ‰æ”¾å›žçš„æŠ½æ ·ï¼Œæ˜¯æ¯æ¬¡æŠ½ä¸€ä¸ªæ”¾å›žï¼Œè¿˜æ˜¯ä¸€æ¬¡æŠ½nä¸ªå†æ”¾å›žï¼Ÿ ç­”: æž„é€ å­æ•°æ®é›†ï¼Œå­æ•°æ®é›†çš„æ•°æ®é‡æ˜¯å’ŒåŽŸå§‹æ•°æ®é›†ç›¸åŒçš„ã€‚ä¸åŒå­æ•°æ®é›†çš„å…ƒç´ å¯ä»¥é‡å¤ï¼ŒåŒä¸€ä¸ªå­æ•°æ®é›†ä¸­çš„å…ƒç´ ä¹Ÿå¯ä»¥é‡å¤ã€‚ (4)éšæœºæ£®æž—ä¸ºä»€ä¹ˆå¯ä»¥ç”¨äºŽå¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼çš„æ•°æ®ï¼Ÿç­”ï¼šéšæœºæ£®æž—çš„å®¹é”™çŽ‡é«˜ï¼Œç”±äºŽéšæœºæ£®æž—å¤šæ£µæ ‘ï¼Œå¦‚æžœä¸€ä¸ªæ•°æ®ç¼ºå¤±äº†çš„å­—æ®µåˆšå¥½æœ‰äº›æ ‘ä¸éœ€è¦è¿™äº›ç‰¹å¾ï¼ŒäºŽæ˜¯å¯ä»¥ç”¨è¯¥äº›æ ‘è¿›è¡Œé¢„æµ‹ï¼Œä»Žè€Œå¾—åˆ°ç»“æžœã€‚è€Œå†³ç­–æ ‘çš„è¯å¾ˆæœ‰å¯èƒ½æ— æ³•è¿›è¡Œé¢„æµ‹ã€‚ (5)éšæœºæ£®æž—ä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Œä¸ºä»€ä¹ˆå¯¹å™ªå£°ä¸æ•æ„Ÿï¼Ÿç­”ï¼šä¸‰ä¸ªéšæœºæ€§çš„å¼•å…¥ï¼Œå³äº§ç”Ÿå†³ç­–æ ‘çš„æ ·æœ¬æ˜¯éšæœºç”Ÿæˆï¼Œæž„å»ºå†³ç­–æ ‘çš„ç‰¹å¾å€¼æ˜¯éšæœºé€‰å–ï¼Œæ ‘äº§ç”Ÿè¿‡ç¨‹ä¸­è£‚å˜çš„æ—¶å€™æ˜¯é€‰æ‹©Nä¸ªæœ€ä½³æ–¹å‘ä¸­çš„éšæœºä¸€ä¸ªè£‚å˜çš„ã€‚å½“éšæœºæ£®æž—äº§ç”Ÿçš„æ ‘çš„æ•°ç›®è¶‹è¿‘æ— ç©·çš„æ—¶å€™ï¼Œç†è®ºä¸Šæ ¹æ®å¤§æ•°å®šç†å¯ä»¥è¯æ˜Žè®­ç»ƒè¯¯å·®ä¸Žæµ‹è¯•è¯¯å·®æ˜¯æ”¶æ•›åˆ°ä¸€èµ·çš„ã€‚ å½“ç„¶å®žé™…è¿‡ç¨‹ä¸­ï¼Œç”±äºŽä¸å¯èƒ½äº§ç”Ÿæ— ç©·çš„å†³ç­–æ ‘ï¼Œæ¨¡åž‹å‚æ•°çš„è®¾ç½®é—®é¢˜ä¼šå½±å“åœ¨ç›¸åŒè¿è¡Œæ—¶é—´å†…æ‹Ÿåˆç»“æžœçš„è¿‡æ‹Ÿåˆç¨‹åº¦çš„ä¸åŒã€‚ä½†æ€»è€Œè¨€ä¹‹ï¼Œè°ƒæ•´å‚æ•°åŽï¼Œéšæœºæ£®æž—å¯ä»¥æœ‰æ•ˆçš„é™ä½Žè¿‡æ‹Ÿåˆçš„ç¨‹åº¦ã€‚ å¦å¤–å¤šé¢—å†³ç­–æ ‘ç»¼åˆå†³ç­–ï¼Œä»¥å¤šæ•°ä¸ºè¾“å‡ºä»£è¡¨ï¼Œä¹Ÿèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘è¯¯å·®ã€‚]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>theory</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é«˜æ–¯æ··åˆæ¨¡åž‹]]></title>
    <url>%2F2018%2F05%2F17%2F%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[æ··åˆé«˜æ–¯æ¨¡åž‹è¦è§£å†³çš„é—®é¢˜ä¸Žä¸€äº›å‡è®¾è§‚å¯Ÿåˆ°ä»ŽKä¸ªç±»ä¸­äº§ç”Ÿçš„æ ·æœ¬$X={x_1^T,x_2^T,â€¦,x_M^T}^T\in R^{M\times N}$ï¼ŒMä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬Nç»´ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªæ ·æœ¬æ²¡æœ‰å¯¹åº”çš„æ ‡ç­¾æ ‡è®°è¯¥æ ·æœ¬æ˜¯å±žäºŽå“ªä¸€ä¸ªç±»ï¼Œå¦‚ä½•ç¡®å®šè¿™äº›æ ·æœ¬æœ€æœ‰å¯èƒ½çš„åˆ†å¸ƒæ–¹å¼ï¼Ÿè¿™å°±æ˜¯ä¸€ä¸ªæ— ç›‘ç£å­¦ä¹ é—®é¢˜ã€‚ä½¿ç”¨æ··åˆé«˜æ–¯æ¨¡åž‹è§£å†³è¯¥èšç±»é—®é¢˜æ—¶ï¼Œå‡è®¾æ¯ä¸€ä¸ªç±»å†…éƒ¨çš„æ ·æœ¬æœä»Žé«˜æ–¯åˆ†å¸ƒï¼Œï¼ˆå¹¶ä¸”ç±»ä¸Žç±»ä¹‹é—´çš„äº’ç›¸ç‹¬ç«‹ï¼Ÿï¼‰ã€‚ åŸºäºŽä»¥ä¸Šå‡è®¾å¦‚ä½•å¯¹è§‚å¯Ÿåˆ°çš„æ ·æœ¬è¿›è¡Œå»ºæ¨¡ï¼Ÿä¿¡æ¯ä¸å®Œå…¨ï¼Œéœ€è¦å¼•å…¥éšå˜é‡æ¥è¡¨ç¤ºæ¯ä¸ªæ ·æœ¬å…·ä½“å±žäºŽå“ªä¸€ä¸ªç±»ã€‚å¼•å…¥å˜é‡$z_{mk}$è¡¨ç¤ºç¬¬mä¸ªæ ·æœ¬æ˜¯å¦å±žäºŽç¬¬kç±»ï¼Œè‹¥ç¬¬mä¸ªæ ·æœ¬å±žäºŽç¬¬kç±»åˆ™$z_{mk}=1$ï¼Œå¦åˆ™$z_{mk}=0$ã€‚æ˜¾ç„¶ï¼Œå¯¹äºŽä¸€ä¸ªæ ·æœ¬ï¼Œå…¶å¯¹åº”çš„kä¸ª$z$ä¸­åªæœ‰ä¸€ä¸ªä¸º1ï¼Œå…¶ä»–éƒ½ä¸º0ï¼Œå› ä¸ºä¸€ä¸ªæ ·æœ¬åªèƒ½å±žäºŽä¸€ä¸ªç±»ã€‚æ‰€ä»¥æœ‰$\sum_{k=1}^{K}z_{mk}=1$ã€‚ å¯¹äºŽæŸä¸€ä¸ªæ ·æœ¬$x$ï¼Œå…¶è¢«è§‚å¯Ÿåˆ°çš„æ¦‚çŽ‡ä¸º$p(x)$ï¼Œåˆ™å…¶å¯ç”±$x$ä¸Ž$z$çš„è”åˆåˆ†å¸ƒä¸­æ¶ˆåŽ»$z$å¾—åˆ°ï¼Œå³$p(x)=\sum_{z}{p(x,z)} =\sum_{k=1}^{K}{p(x,z_{k}=1)}$ã€‚ ç”±æ··åˆé«˜æ–¯æ¨¡åž‹çš„å‡è®¾å¯çŸ¥$p(x|z_{k}=1)=\mathcal{N}(x|\mu_k,\Sigma_k) $ï¼Œå³æ¯ä¸ªç±»çš„å†…éƒ¨çš„æ ·æœ¬æœä»Žé«˜æ–¯åˆ†å¸ƒã€‚ å¦‚æžœå†å‡è®¾å…ˆéªŒï¼šå¯¹äºŽä»»æ„ä¸€ä¸ªæ ·æœ¬$x$ï¼Œå…¶å±žäºŽç¬¬kç±»çš„æ¦‚çŽ‡ä¸º$p(z_k=1)=\pi_k$ã€‚å¯ä»¥ç†è§£ä¸ºä»»æ„å–ä¸€ä¸ªæ ·æœ¬$x$ï¼Œå¿½ç•¥å…¶æœ¬èº«çš„ç‰¹å¾ï¼Œå…¶å±žäºŽç¬¬kç±»çš„æ¦‚çŽ‡ä¸º$\pi_k$ã€‚ä¹Ÿå¯çœ‹åšç¬¬kç±»æ ·æœ¬åœ¨æ€»ä½“æ ·æœ¬ä¸­æ‰€å çš„æ¯”ä¾‹ï¼Œæ‰€ä»¥æœ‰$\sum_{k=1}^K\pi_k=1$ã€‚ åˆ™æ ¹æ®ä»¥ä¸Šçš„å‡è®¾å¯ä»¥å¾—åˆ°$x$ä¸Ž$z$çš„è”åˆåˆ†å¸ƒä¸º $p(x,z_k=1)=p(x|z_k=1)p(z_k=1)=\pi_k \mathcal{N}(x|\mu_k,\Sigma_k)$ã€‚ æ‰€ä»¥$p(x)=\sum_{z}{p(x,z)} =\sum_{k=1}^{K}{p(x,z_{k}=1)}=\sum_{k=1}^K\pi_k \mathcal{N}(x|\mu_k,\Sigma_k)$ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å¯¹æ ·æœ¬å»ºæ¨¡å®Œæˆï¼Œè‹¥æžœæˆ‘ä»¬çŸ¥é“éšå˜é‡$z$çš„å€¼çš„è¯ï¼Œè¿™ä¸ªé—®é¢˜å°±ç›´æŽ¥æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ¤åˆ«å¼æ¨¡åž‹GDAï¼Œç›´æŽ¥æ±‚å‡º$\mu_k$ä¸Ž$\Sigma_k$å°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æ€»ä½“æ ·æœ¬çš„åˆ†å¸ƒ$p(x)$ã€‚ å¯¹äºŽä¸€ä¸ªæ–°æ ·æœ¬éœ€è¦é¢„æµ‹å…¶æ‰€å±žçš„ç±»åˆ«ï¼Œå¯ä»¥é€šè¿‡è´å¶æ–¯å…¬å¼å¾—åˆ°ï¼šè§‚å¯Ÿåˆ°ä¸€ä¸ªæ ·æœ¬$x$ï¼Œå…¶å±žäºŽç¬¬kç±»çš„æ¦‚çŽ‡ä¸º$$p(z_k=1|x)=\frac{p(x,z_k=1)}{p(x)} =\frac{\pi_k\mathcal{N}(x|\mu_k,\Sigma_k)}{\sum_{k=1}^K\pi_k\mathcal{N}(x|\mu_k,\Sigma_k)}$$ä¸ºæ–¹ä¾¿å°†$p(z_k=1|x)$è®°åš$\gamma(z_k)$ã€‚ ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“zçš„å€¼ï¼Œæ— æ³•å°†æ¯ä¸€ä¸ªæ ·æœ¬$x_m$å¯¹åº”åˆ°ç›¸åº”çš„$z_k$ä¸ŠåŽ»ï¼ˆå³ä¸çŸ¥é“å“ªä¸ª$z_{mk}=1$ï¼‰ï¼Œæ‰€ä»¥æ— æ³•è®¡ç®—å‡º$\pi_k$ï¼Œä¹Ÿæ— æ³•æ ¹æ®ä¼¼ç„¶å‡½æ•°åŽ»ç›´æŽ¥è®¡ç®—$\mu_k$ä¸Ž$\Sigma_k$ã€‚ ç›´è§‚ç†è§£å¦‚å›¾1ï¼Œå›¾ä¸­çš„ç‚¹åœ¨æˆ‘ä»¬çœ‹æ¥æ˜Žæ˜¾åˆ†æˆä¸¤ä¸ªèšç±»ã€‚è¿™ä¸¤ä¸ªèšç±»ä¸­çš„ç‚¹åˆ†åˆ«é€šè¿‡ä¸¤ä¸ªä¸åŒçš„æ­£æ€åˆ†å¸ƒéšæœºç”Ÿæˆè€Œæ¥ã€‚ä½†æ˜¯å¦‚æžœæ²¡æœ‰GMMï¼Œé‚£ä¹ˆåªèƒ½ç”¨ä¸€ä¸ªçš„äºŒç»´é«˜æ–¯åˆ†å¸ƒæ¥æè¿°å›¾1ä¸­çš„æ•°æ®ã€‚å›¾1ä¸­çš„æ¤­åœ†å³ä¸ºäºŒå€æ ‡å‡†å·®çš„æ­£æ€åˆ†å¸ƒæ¤­åœ†ã€‚è¿™æ˜¾ç„¶ä¸å¤ªåˆç†ï¼Œæ¯•ç«Ÿè‚‰çœ¼ä¸€çœ‹å°±è§‰å¾—åº”è¯¥æŠŠå®ƒä»¬åˆ†æˆä¸¤ç±»ã€‚è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨GMMäº†ï¼å¦‚å›¾2ï¼Œæ•°æ®åœ¨å¹³é¢ä¸Šçš„ç©ºé—´åˆ†å¸ƒå’Œå›¾1ä¸€æ ·ï¼Œè¿™æ—¶ä½¿ç”¨ä¸¤ä¸ªäºŒç»´é«˜æ–¯åˆ†å¸ƒæ¥æè¿°å›¾2ä¸­çš„æ•°æ®ï¼Œåˆ†åˆ«è®°ä¸º$\mathcal{N}(\mu_1,\Sigma_1)$å’Œ$\mathcal{N}(\mu_2,\Sigma_2)$. å›¾ä¸­çš„ä¸¤ä¸ªæ¤­åœ†åˆ†åˆ«æ˜¯è¿™ä¸¤ä¸ªé«˜æ–¯åˆ†å¸ƒçš„äºŒå€æ ‡å‡†å·®æ¤­åœ†ã€‚å¯ä»¥çœ‹åˆ°ä½¿ç”¨ä¸¤ä¸ªäºŒç»´é«˜æ–¯åˆ†å¸ƒæ¥æè¿°å›¾ä¸­çš„æ•°æ®æ˜¾ç„¶æ›´åˆç†ã€‚å®žé™…ä¸Šå›¾ä¸­çš„ä¸¤ä¸ªèšç±»çš„ä¸­çš„ç‚¹æ˜¯é€šè¿‡ä¸¤ä¸ªä¸åŒçš„æ­£æ€åˆ†å¸ƒéšæœºç”Ÿæˆè€Œæ¥ã€‚å¦‚æžœå°†ä¸¤ä¸ªäºŒç»´é«˜æ–¯åˆ†å¸ƒ$\mathcal{N}(\mu_1,\Sigma_1)$å’Œ$\mathcal{N}(\mu_2,\Sigma_2)$åˆæˆä¸€ä¸ªäºŒç»´çš„åˆ†å¸ƒï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨åˆæˆåŽçš„åˆ†å¸ƒæ¥æè¿°å›¾2ä¸­çš„æ‰€æœ‰ç‚¹ã€‚æœ€ç›´è§‚çš„æ–¹æ³•å°±æ˜¯å¯¹è¿™ä¸¤ä¸ªäºŒç»´é«˜æ–¯åˆ†å¸ƒåšçº¿æ€§ç»„åˆï¼Œç”¨çº¿æ€§ç»„åˆåŽçš„åˆ†å¸ƒæ¥æè¿°æ•´ä¸ªé›†åˆä¸­çš„æ•°æ®ã€‚è¿™å°±æ˜¯é«˜æ–¯æ··åˆæ¨¡åž‹ï¼ˆGMMï¼‰ã€‚ ä¸ºä»€ä¹ˆæ— æ³•æ ¹æ®ä¼¼ç„¶å‡½æ•°è®¡ç®—$\mu_k$ä¸Ž$\Sigma_k$ï¼Ÿå†™å‡ºä¼¼ç„¶å‡½æ•°ï¼š$$p(X|\pi,\mu,\Sigma)=\prod_{m=1}^{M}p(x_m)= \prod_{m=1}^{M}(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))$$ å–å¯¹æ•°ï¼š$$\theta(\pi,\mu,\Sigma;X)=ln\ p(X|\pi,\mu,\Sigma)=ln\prod_{m=1}^{M}p(x_m)= ln\prod_{m=1}^{M}(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))=\sum_{m=1}^Mln(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))$$ ç¼ºå°‘éšå˜é‡$z$çš„ä¿¡æ¯ä¼šå¯¼è‡´ï¼š $\pi_k$æ— æ³•è®¡ç®—; $ln$ä¸­çš„æ±‚å’Œç¬¦å·æ— æ³•æ¶ˆé™¤ï¼ˆåœ¨GDAçš„ä¼¼ç„¶ä¸­æ ·æœ¬$x_m$ä¸å±žäºŽçš„ç±»æ ¹æœ¬å°±ä¸ä¼šå‡ºçŽ°åœ¨$ln$ä¸­ï¼‰ã€‚ å¯¹$\mu_k$æ±‚åå¯¼$$\frac{\partial ln\ p(X|\pi,\mu,\Sigma)}{\partial \mu_k}=\frac{\partial \sum_{m=1}^Mln(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))}{\partial \mu_k}$$$$=\sum_{m=1}^M\frac{\partial ln(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))}{\partial \mu_k}=\sum_{m=1}^M\frac{\pi_k}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}\frac{\partial \mathcal{N}(x_m|\mu_k,\Sigma_k)}{\partial \mu_k}$$$$=\sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}\frac{\partial (-\frac{1}{2}(x_m-\mu_k)^T\Sigma_k^{-1}(x_m-\mu_k))}{\partial \mu_k}$$$$=\sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}(-\frac{1}{2})\Sigma_k(x_m-\mu_k) $$ ä»¤$\frac{\partial ln\ p(X|\pi,\mu,\Sigma)}{\partial \mu_k}=0$å¾—$$-\sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}\Sigma_k(x_m-\mu_k)=0$$ å‡è®¾$\Sigma_k$å¯é€†ï¼Œåˆ™ä¸¤è¾¹åŒä¹˜ä»¥$\Sigma_k^{-1}$å¯æ¶ˆåŽ»$\Sigma_k$ï¼Œåˆ™å¯å¾—$$\mu_k\sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}=\sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}x_m$$ æ‰€ä»¥$$\mu_k=\frac{\sum_{m=1}^M\gamma(z_{mk})x_m}{\sum_{m=1}^M\gamma(z_{mk})}$$ è§‚å¯Ÿè¯¥å…¬å¼ï¼Œæ¯ä¸ªç±»çš„ç±»ä¸­å¿ƒç›¸å½“äºŽæ‰€æœ‰æ ·æœ¬çš„åŠ æƒå¹³å‡æ•°ï¼Œå¯¹äºŽç¬¬kç±»ï¼Œæ¯ä¸ªæ ·æœ¬çš„æƒé‡$w_{km}=\frac{\gamma(z_{mk})}{\sum_{m=1}^M\gamma(z_{mk})}$ã€‚ å¯¹$\Sigma_k$æ±‚åå¯¼$$\frac{\partial ln\ p(X|\pi,\mu,\Sigma)}{\partial \Sigma_k}=\frac{\partial \sum_{m=1}^Mln(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))}{\partial \Sigma_k}$$$$=\sum_{m=1}^M\frac{\partial ln(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))}{\partial \Sigma_k}=\sum_{m=1}^M\frac{\pi_k}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}\frac{\partial \mathcal{N}(x_m|\mu_k,\Sigma_k)}{\partial \Sigma_k}$$$$=\sum_{m=1}^M\frac{\pi_k}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}\frac{1}{(2\pi)^{N/2}}\frac{\partial\frac{1}{|\Sigma_k|^{1/2}}exp{-\frac{1}{2}(x_m-\mu_k)^T\Sigma_k^{-1}(x_m-\mu_k)}}{\partial \Sigma_k}$$$$=â€¦â€¦â€¦.$$ æœ€åŽä»¤$\frac{\partial ln\ p(X|\pi,\mu,\Sigma)}{\partial \Sigma_k}=0$å¾—åˆ°$$\Sigma_k\sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}=\sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}(x_m-\mu_k)(x_m-\mu_k)^T$$ æ‰€ä»¥$$\Sigma_k=\sum_{m=1}^M\frac{\gamma(z_{mk})(x_m-\mu_k)(x_m-\mu_k)^T}{\sum_{m=1}^M\gamma(z_{mk})}$$ ä»¥ä¸Šæ±‚å¯¼å¯ä»¥çœ‹å‡º$\mu_k$ä¸Ž$\Sigma_k$äº’ç›¸åµŒå¥—ï¼Œæ— æ³•å¾—åˆ°ä¸€ä¸ªé—­å¼è§£(è§£æžè§£)ã€‚ åœ¨ä¼¼ç„¶å‡½æ•°ä¸­$\pi_k$ä¹Ÿå±žäºŽæœªçŸ¥é‡ï¼Œä¹Ÿéœ€è¦å¯¹å…¶æ±‚å¯¼è¿›è¡Œä¼˜åŒ– åœ¨ä¼˜åŒ–$\pi_k$ä½¿ä¼¼ç„¶å‡½æ•°æœ€å°åŒ–çš„åŒæ—¶ï¼Œ$\pi_k$è¿˜éœ€è¦æ»¡è¶³æ¡ä»¶$\sum_{k=1}^K\pi_k=1$ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¹˜å­å°†è¯¥çº¦æŸåŠ å…¥ä¼¼ç„¶å‡½æ•°å¾—$$\theta(\pi,\mu,\Sigma;X)=ln\ p(X|\pi,\mu,\Sigma)+\lambda(\sum_{k=1}^K\pi_k-1)=\sum_{m=1}^Mln(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))+\lambda(\sum_{k=1}^K\pi_k-1)$$ å¯¹\pi_kæ±‚åå¯¼$$\frac{\partial \theta(\pi,\mu,\Sigma;X)}{\partial \pi_k}=\sum_{m=1}^M\frac{\partial ln(\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k))}{\partial \pi_k}+\lambda\frac{\sum_{k=1}^K\pi_k-1}{\partial \pi_k}=\sum_{m=1}^M\frac{\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}+\lambda$$ ä»¤$\frac{\partial \theta(\pi,\mu,\Sigma;X)}{\partial \pi_k}=0$å¾—$$\sum_{m=1}^M\frac{\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}+\lambda=0\Rightarrow \sum_{m=1}^M\frac{\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}{\sum_{k=1}^{K}\pi_k\mathcal{N}(x_m|\mu_k,\Sigma_k)}+\lambda\pi_k=0$$ æ‰€ä»¥$\sum_{m=1}^M\gamma(z_{mk})+\lambda\pi_k=0$ æ‰€ä»¥$$\sum_{k=1}^K(\sum_{m=1}^M\gamma(z_{mk})+\lambda\pi_k)=0\Rightarrow \sum_{k=1}^K\sum_{m=1}^M\gamma(z_{mk})+\lambda\sum_{k=1}^K\pi_k=0\Rightarrow \lambda=-\sum_{k=1}^K\sum_{m=1}^M\gamma(z_{mk})$$ å¸¦å…¥åŽŸå¼å¾—$$\pi_k=\frac{\sum_{m=1}^M\gamma(z_{mk})}{\sum_{k=1}^K\sum_{m=1}^M\gamma(z_{mk})}$$ EMæ–¹æ³•æ ¹æ®æœ€åˆæŽ¨å¯¼çš„æ¨¡åž‹ï¼Œå¦‚æžœæˆ‘ä»¬çŸ¥é“\pi_kï¼Œ\mu_kä¸Ž\Sigma_kï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç›¸å½“äºŽè§£å†³äº†é—®é¢˜ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸‰ä¸ªå‚æ•°å¾—åˆ°æ‰€éœ€çš„æ¦‚çŽ‡å¯†åº¦ï¼Œä»Žè€Œå¯ä»¥å¯¹åŽŸæ ·æœ¬è¿›è¡Œåˆ’åˆ†ï¼Œå¯¹æ–°æ ·æœ¬è¿›è¡Œé¢„æµ‹ã€‚ç„¶è€Œç»è¿‡æœ€å¤§ä¼¼ç„¶æ±‚è§£ï¼Œæˆ‘ä»¬å‘çŽ°æ— æ³•å¾—åˆ°é—­å¼è§£ã€‚ è§‚å¯Ÿ$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$çš„è¡¨è¾¾å¼ï¼Œå‘çŽ°æˆ‘ä»¬ä¹‹æ‰€ä»¥æˆ‘ä»¬è®¡ç®—å‡º$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$æ˜¯å› ä¸ºæˆ‘ä»¬æ— æ³•å¾—åˆ°$\gamma(z_k)$ï¼Œè€Œæ— æ³•è®¡ç®—$\gamma(z_k)$åˆæ˜¯å› ä¸º$\gamma(z_k)$ä¾èµ–äºŽ$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$ã€‚ å…¶ä¾èµ–å…³ç³»å¦‚ä¸‹å›¾ åˆ™ä»Žä¸Šå›¾å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼š åˆå§‹åŒ–$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$ã€‚ è®¡ç®—$\gamma(z_k)$ï¼Œå³é¢„æµ‹å¯¹äºŽä¸€ä¸ªæ ·æœ¬xä»–å±žäºŽå“ªä¸ªç±»$p(z_k=1|x)$ã€‚ å¯¹æ‰€æœ‰æ ·æœ¬é¢„æµ‹å®ŒæˆåŽæ ¹æ®$\gamma(z_k)$é‡æ–°è®¡ç®—$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$ã€‚ è‹¥æ²¡æœ‰è¾¾åˆ°é€€å‡ºæ¡ä»¶ï¼Œä»Ž1.æ­¥ç»§ç»­è¿­ä»£ã€‚ åˆå§‹åŒ–$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$æ­¥éª¤ï¼Œå¯ä»¥é€‰æ‹©å‘æ ·æœ¬ç©ºé—´éšæœºå¸ƒç½®å‡ ä¸ª$\Sigma=I$çš„é«˜æ–¯åˆ†å¸ƒå¾—åˆ°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨K-meansç®—æ³•è¿›è¡Œåˆå§‹èšç±»åŽï¼Œå¯¹æ¯ä¸ªç±»ç”Ÿæˆä¸€ä¸ªåˆå§‹é«˜æ–¯åˆ†å¸ƒå¾—åˆ°ã€‚ å®Œæ•´æ··åˆé«˜æ–¯æ¨¡åž‹çš„EMç®—æ³•å¦‚ä¸‹ï¼š åˆå§‹åŒ–$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$ï¼Œå¯ä»¥é€‰æ‹©å‘æ ·æœ¬ç©ºé—´éšæœºå¸ƒç½®å‡ ä¸ª$\Sigma=I$çš„é«˜æ–¯åˆ†å¸ƒå¾—åˆ°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨K-meansç®—æ³•è¿›è¡Œåˆå§‹èšç±»åŽï¼Œå¯¹æ¯ä¸ªç±»ç”Ÿæˆä¸€ä¸ªåˆå§‹é«˜æ–¯åˆ†å¸ƒå¾—åˆ°ã€‚ ï¼ˆE stepï¼‰è®¡ç®—$\gamma(z_k)$ï¼Œå³é¢„æµ‹å¯¹äºŽä¸€ä¸ªæ ·æœ¬$x$ä»–å±žäºŽå“ªä¸ªç±»$$p(z_k=1|x)=\frac{\pi_k\mathcal{N}(x|\mu_k,\Sigma_k)}{\sum_{k=1}^K\pi_k\mathcal{N}(x|\mu_k,\Sigma_k)}$$ ï¼ˆM stepï¼‰å¯¹æ‰€æœ‰æ ·æœ¬é¢„æµ‹å®ŒæˆåŽæ ¹æ®$\gamma(z_k)$é‡æ–°è®¡ç®—$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$ã€‚$$\mu_k^{new}=\frac{\sum_{m=1}^M\gamma(z_{mk})x_m}{\sum_{m=1}^M\gamma(z_{mk})},\Sigma_k^{new}=\sum_{m=1}^M\frac{\gamma(z_{mk})(x_m-\mu_k)(x_m-\mu_k)^T}{\sum_{m=1}^M\gamma(z_{mk})}ï¼Œ\pi_k^{new}=\frac{\sum_{m=1}^M\gamma(z_{mk})}{\sum_{k=1}^K\sum_{m=1}^M\gamma(z_{mk})}$$ è¯„ä¼°ä¼¼ç„¶å‡½æ•°$$\theta(\pi^{new},\mu^{new},\Sigma^{new};X)=\sum_{m=1}^Mln(\sum_{k=1}^{K}\pi_k^{new}\mathcal{N}(x_m|\mu_k^{new},\Sigma_k^{new}))$$è‹¥ä¼¼ç„¶å‡½æ•°çš„å˜åŒ–æ²¡æœ‰ä½ŽäºŽæŸä¸ªé˜ˆå€¼ï¼Œç»§ç»­è¿­ä»£ï¼š$$\pi_k=\pi_k^{new}ï¼Œ\mu_k=\mu_k^{new}ï¼Œ\Sigma_k=\Sigma_k^{new}ã€‚$$ å…¶ä¸­ç¬¬2æ­¥è¢«ç§°ä¸ºE stepï¼Œå³æœŸæœ›ï¼ˆåˆ†ç±»ï¼‰(expectation)æ­¥éª¤ï¼Œå…¶æ ¹æ®ç›®å‰å·²çŸ¥çš„å‚æ•°$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$å¯¹æ ·æœ¬çš„ç±»åž‹è¿›è¡Œé¢„æµ‹ã€‚ç¬¬3æ­¥è¢«ç§°ä¸ºM stepï¼Œå³æœ€å¤§åŒ–ï¼ˆä¼¼ç„¶å‡½æ•°ï¼‰ï¼ˆmaximizationï¼‰æ­¥éª¤ï¼Œæ ¹æ®2æ­¥å¾—åˆ°çš„æ–°çš„åˆ†ç±»æƒ…å†µæœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°$\theta(\pi^{new},\mu^{new},\Sigma^{new};X)$ï¼Œå³ä½¿ç”¨ç¬¬3æ­¥ä¸­çš„ä¸‰ä¸ªå…¬å¼è®¡ç®—$\pi_k$ï¼Œ$\mu_k$ä¸Ž$\Sigma_k$å°±ç›¸å½“äºŽæœ€å¤§åŒ–äº†ä¼¼ç„¶å‡½æ•°ã€‚ å¯ä»¥å—åˆ°å¯ç¤ºï¼Œè¦ä¼˜åŒ–å‚æ•°å…·æœ‰å‰é¢æ‰€å±•ç¤ºçš„å›¾ä¸­ä¾èµ–å…³ç³»çš„é—®é¢˜ï¼Œå‡å¯ä»¥å¥—ç”¨EMæ–¹æ³•çš„è¿­ä»£æ¨¡å¼ï¼Œå¯¹ç›®æ ‡å‡½æ•°è¿›è¡Œä¼˜åŒ–ã€‚ ä¸‹é¢ç»™å‡ºä¸€ä¸ªsklearnçš„ä¾‹å­1234567891011121314151617import numpy as npfrom sklearn import datasetsfrom sklearn.cluster import KMeansfrom sklearn.mixture import GaussianMixturex = np.array([[1.2,2.6],[2.8,3.9],[3.2,4],[3,3],[1,1],[-1,0.2],[-2,-1],[2,0]])#K-Meanskmeans=KMeans(n_clusters=2)kmeans.fit(x)print( 'K-Meanså‡å€¼ = \n', kmeans.cluster_centers_ )print(kmeans.predict(x))gmm=GaussianMixture(n_components=2,covariance_type='full')gmm.fit(x)print('GMMå‡å€¼ = \n', gmm.means_ )print(gmm.fit(x))]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linear Regression]]></title>
    <url>%2F2018%2F05%2F15%2FLinear-Regression%2F</url>
    <content type="text"><![CDATA[å‡è®¾$h(x)=y$ï¼Œæœ‰å¤§é‡æ ·æœ¬ï¼Œæ±‚$h(x)$æ˜¯ä»€ä¹ˆ?é‚£ä¹ˆå¯ä»¥å‡è®¾$$h(x)=\theta_{0} x^0 +\theta _{1}x^1+\theta _{2}x^2+â€¦+\theta _{n}x^n+â€¦$$å› ä¸º$x^0=1$æ‰€ä»¥$\theta_{0} *x^0$å¯ä»¥ç®€åŒ–ä¸º$\theta_{0} $ ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œå…ˆè®°åªæœ‰$\theta_{0}$ å’Œ$\theta_{1}$ çš„æƒ…å†µï¼ŒåŽŸå…¬å¼å°±ç®€åŒ–ä¸ºäº†ï¼š$$h(x)=\theta_{0} +\theta_{1} *x$$ å‡è®¾å®žé™…ç»“æžœä¸º$y$ï¼Œå…¶ä¸­$y=f(x)$é‚£ä¹ˆï¼Œ$h(x)$åœ¨ä»€ä¹ˆæƒ…å†µä¸‹æœ€æŽ¥è¿‘$f(x)$å‘¢ï¼Ÿ å½“ç„¶æ˜¯$h(x)-f(x)$æœ€æŽ¥è¿‘0çš„æƒ…å†µä¸‹å•¦ã€‚ é‚£å¤§é‡æ ·æœ¬ï¼ˆmç»„æ ·æœ¬ï¼‰å‘¢ï¼Ÿæˆ‘ä»¬ç»™$h(x)-f(x)$åšä¸€ä¸ªå¹³æ–¹ï¼Œå³$(h(x)-f(x))^2$ï¼Œè¿™æ ·ä¿è¯å®ƒä¸ºæ­£ï¼Œä¸ºæ­£äº†ä»¥åŽï¼Œå°±æ˜¯æ±‚æœ€å°äº†å¯¹å§ã€‚ ç„¶åŽæŠŠè¿™äº›æ ·æœ¬ç›¸åŠ ï¼š$\sum_{i}^{m}{} (h(x_{i} )-f(x_{i} ))^2$è¿™ä¸ªç›¸åŠ åŽçš„å€¼æœ€å°çš„æ—¶å€™ï¼Œå°±æ˜¯æˆ‘ä»¬çš„å‡å®šå‡½æ•°hï¼ˆxï¼‰æœ€æŽ¥è¿‘å®žé™…å‡½æ•°fï¼ˆxï¼‰çš„æ—¶å€™ã€‚ ç”±äºŽæ–¹ç¨‹ä¸­æ²¡æœ‰$f(x)$ï¼Œè€Œ$f(x)=y$ï¼Œæ‰€ä»¥æ–¹ç¨‹å¯ä»¥å†™ä¸ºï¼š$\sum_{i}^{m}{} (h(x_{i} )-y_{i} )^2$ æˆ‘ä»¬å®šä¹‰è§‚æµ‹ç»“æžœ$y$å’Œé¢„æµ‹ç»“æžœ$yâ€™$ä¹‹é—´çš„å·®åˆ«ä¸ºRss:$$Rss = \sum_{i=1}^{m}({y_i-y_iâ€™} )^2= \sum_{i=1}^{m}({y_i-h(x_i)} )^2 = (y-h(x))^T*(y-h(x))$$ è®¾è‹¥å‚æ•°çš„çŸ©é˜µä¸º$\theta$,åˆ™$h(x)=\theta*x$ é‚£ä¹ˆ$$Rss = (y-h(X))^T(y-h(X)) = (y-\theta x)^T(y-\theta x) $$ æŒ‰ç…§æˆ‘ä»¬çš„å®šä¹‰ï¼Œè¿™ä¸ªRssçš„æ„æ€æ˜¯yå’Œyâ€™ä¹‹é—´çš„å·®ï¼Œé‚£ä¹ˆå½“Rssæ— é™è¶‹è¿‘äºŽ0çš„æ—¶å€™ï¼Œåˆ™yâ‰ˆyâ€™ï¼Œå³æˆ‘ä»¬æ±‚å¾—çš„é¢„æµ‹ç»“æžœå°±ç­‰äºŽå®žé™…ç»“æžœã€‚ äºŽæ˜¯ï¼Œä»¤Rssç­‰äºŽæŸä¸€æžå°å€¼$\delta$ ï¼Œåˆ™$(y-\theta x)^T*(y-\theta x) = \delta $ å¯¹å‚æ•°$\theta$æ±‚å¯¼ï¼Œå¾—ï¼š$$\frac{d}{d\theta}(y-\theta x)^T(y-\theta x) = 2x^T(y-\theta x) = 0$$ å±•å¼€ï¼Œå¾—$ x^Ty=x^T\thetax=x^T x\theta$ è¿›è€Œå°±å¯ä»¥å¾—åˆ°$\theta ==(x^Tx)^{-1}x^T*y$ äºŽæ˜¯æˆ‘ä»¬å°±å¾—åˆ°æ­£è§„æ–¹ç¨‹äº†ã€‚ å½“ç„¶è¿˜æœ‰ç”¨æ¢¯åº¦ä¸‹é™æ–¹æ³•æ¥æ±‚è§£ã€‚è¿™é‡Œå°±ä¸åšè¯¦è§£äº†ã€‚]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»Žå½¢å¼æ–‡æ³•åˆ°æ•°å­¦çš„æžé™(1)]]></title>
    <url>%2F2018%2F05%2F12%2F%E4%BB%8E%E5%BD%A2%E5%BC%8F%E6%96%87%E6%B3%95%E5%88%B0%E6%95%B0%E5%AD%A6%E7%9A%84%E6%9E%81%E9%99%90-1%2F</url>
    <content type="text"><![CDATA[ä»Žå½¢å¼æ–‡æ³•åˆ°æ•°å­¦çš„æžé™ (1) - ä¹”å§†æ–¯åŸºå’Œä»–çš„å½¢å¼æ–‡æ³•è¯ºå§†Â·ä¹”å§†æ–¯åŸºï¼ˆNoam Chomskyï¼‰ï¼Œç¾Žå›½è¯­è¨€å­¦å®¶ï¼Œä¸ºç§‘å­¦ä½œå‡ºçš„æœ€å¤§è´¡çŒ®ä¾¿æ˜¯ä»–æå‡ºçš„å½¢å¼æ–‡æ³•ã€‚è¿™ä¸ªæ¦‚å¿µä¸€ç»æå‡ºï¼Œç›´æŽ¥ä¿ƒæˆäº†ä¸çŸ¥é“å¤šå°‘é‡è¦æŠ€æœ¯ï¼Œå…¶ä¸­æ”¶ç›Šæœ€å¤šçš„é¢†åŸŸå¯èƒ½å°±æ˜¯ä¿¡æ¯è¡Œä¸šäº†ã€‚ è¯­æ³•åˆ†æžå™¨åœ¨è®¡ç®—æœºä¸­ï¼Œè¦æƒ³ä½¿å†™å¥½çš„ä»£ç è¿è¡Œèµ·æ¥ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªå«åšâ€œç¼–è¯‘â€çš„ä¸­é—´è¿‡ç¨‹ï¼Œå°†ä»£ç è½¬æ¢æˆå¯ç›´æŽ¥ç”±æœºå™¨æ‰§è¡Œçš„æ–‡ä»¶ï¼ˆè¿™é‡Œåªæ¶‰åŠç¼–è¯‘åž‹è¯­è¨€ï¼‰ã€‚ä¸ºäº†è®©è®¡ç®—æœºåœ¨ç¼–è¯‘æ—¶è¯»æ‡‚ä½ å†™çš„ä»£ç ï¼Œä¸€ä¸ªé€‚å½“çš„è¯­æ³•åˆ†æžå™¨æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ æ¯ç§è¯­è¨€éƒ½æœ‰è‡ªå·±ä¸åŒçš„è¯­æ³•ï¼Œè¯­æ³•åˆ†æžå™¨æŒ‰ç…§å„ç§è¯­è¨€å®šä¹‰çš„è¯­æ³•ï¼Œé€å­—ç¬¦åœ°å°†æºä»£ç è§£æžæˆä¸€æ£µè¯­æ³•æ ‘ã€‚è€Œç”¨æ¥æè¿°è¿™ç§è¯­æ³•çš„å·¥å…·ï¼Œå°±æ˜¯ä¹”å§†æ–¯åŸºçš„å½¢å¼æ–‡æ³•ã€‚ å·´å…‹æ–¯-ç‘™å°”èŒƒå¼è¦å®šä¹‰ä¸€å¥—è¯­æ³•å¾ˆç®€å•ï¼Œä¸‹é¢æ˜¯ä¸€ç»„ï¼ˆç®€é™‹çš„ï¼‰ç¤ºä¾‹ï¼š1234567&lt;sentence&gt; := [ &lt;subject&gt; ] &lt;predicate&gt; &#123; &lt;object&gt; &#125;&lt;subject&gt; := &lt;nominal-phrase&gt;&lt;object&gt; := &lt;nominal-phrase&gt;&lt;nominal-phrase&gt; := &lt;quantifier&gt; &lt;noun&gt;&lt;quantifier&gt; := &lt;article&gt; | &lt;number&gt;&lt;article&gt; := &quot;a&quot; | &quot;an&quot; | &quot;the&quot;... å¦‚ä½ æ‰€è§ï¼Œæ‰€æœ‰çš„å­—é¢é‡éƒ½å¾ˆç›´è§‚ã€æµ…æ˜¾ï¼Œåªæ˜¯æœ‰å‡ ä¸ªç¬¦å·éœ€è¦è§£é‡Šä¸€ä¸‹ï¼š æ¯æ¡è¯­æ³•çš„æœ€å·¦é¡¹æ˜¯å®ƒçš„åå­—ï¼Œç”¨å°–æ‹¬å·æ‹¬èµ·æ¥ï¼Œè·Ÿéšä¸€ä¸ªå†’å·å’Œä¸€ä¸ªç­‰å·ï¼Œè¡¨ç¤ºå®šä¹‰ï¼› åœ¨è¯­æ³•å®šä¹‰é‡Œå¼•ç”¨å…¶ä»–è¯­æ³•ï¼Œä¹Ÿç”¨å°–æ‹¬å·æ‹¬èµ·è¦å¼•ç”¨çš„åå­—å³å¯ï¼› è‹¥è¦è¡¨ç¤ºå‡ºçŽ°ä¸Žå¦å‡å¯çš„é€‰é¡¹ï¼Œç”¨æ–¹æ‹¬å·æ‹¬èµ·ï¼Œæ¯”å¦‚ &lt;sentence&gt; é‡Œçš„ &lt;subject&gt;ï¼› è‹¥è¦è¡¨ç¤ºå‡ºçŽ°ä»»æ„æ¬¡æ•°ï¼ˆåŒ…æ‹¬ 0 æ¬¡ï¼‰ï¼Œç”¨å¤§æ‹¬å·æ‹¬èµ·ï¼Œæ¯”å¦‚ &lt;sentence&gt; é‡Œçš„ &lt;object&gt;ï¼› è‹¥è¦è¡¨ç¤ºå¤šä¸ªæ¨¡å¼é‡Œä»»é€‰ï¼Œç”¨ç«–æ åˆ†éš”å¼€ï¼› è‹¥è¦è¡¨ç¤ºæ¬²åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œç”¨åŒå¼•å·æ‹¬èµ·ã€‚ è¿™ç§ä¹¦å†™è®°å·æ˜¯è·å…°å­¦è€…ç‘™å°”ï¼ˆNaurï¼‰æœ€å…ˆæå‡ºçš„ï¼ŒåŽç»ç¾Žå›½å­¦è€…å·´å…‹æ–¯ï¼ˆBakusï¼‰å®Œå–„ï¼Œå½¢æˆäº†çŽ°åœ¨çš„å·´å…‹æ–¯-ç‘™å°”èŒƒå¼ã€‚ä¹”å§†æ–¯åŸºåœ¨ä»–è‡ªå·±çš„å½¢å¼æ–‡æ³•é‡Œï¼Œä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼B-N èŒƒå¼çš„ä¹¦å†™æ–¹å¼ã€‚ ä»–æŠŠæ‰€æœ‰å‡ºçŽ°åœ¨å°–æ‹¬å·é‡Œçš„é‚£äº›åç§°ç§°ä½œâ€œéžç»ˆç»“ç¬¦â€ï¼Œæ„ä¸ºå¯ä»¥ç»§ç»­å‘ä¸‹åˆ†è§£æˆæ›´å°çš„å•ä½ï¼›å°†å‡ºçŽ°åœ¨å¼•å·é‡Œçš„å­—ç¬¦ä¸²ç§°ä½œâ€œç»ˆç»“ç¬¦â€ï¼Œæ„ä¸ºæœ€å°å•ä½ï¼Œä¸å¯ç»§ç»­åˆ†è§£ã€‚åœ¨è¯­è¨€å­¦ä¸­ï¼Œé€šå¸¸ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºéžç»ˆç»“ç¬¦ï¼Œè€Œç”¨å°å†™å­—æ¯è¡¨ç¤ºç»ˆç»“ç¬¦ã€‚ è¯­æ³•å±‚çº§ä¹”å§†æ–¯åŸºç»™ä»–çš„æ–‡æ³•æ ¹æ®ä¸åŒçš„è§„åˆ™åˆ’åˆ†äº†ä¸åŒçš„ç­‰çº§ï¼Œä»¥è¡¨ç¤ºå®ƒä»¬æ‰€æè¿°è¯­è¨€çš„â€œè‡ªç”±â€ç¨‹åº¦ã€‚12340 åž‹è¯­è¨€ï¼šä»»æ„è¯­æ³•æ‰€æè¿°çš„è¯­è¨€éƒ½æ˜¯ 0 åž‹çš„ä¸Šä¸‹æ–‡æœ‰å…³ï¼ˆ1 åž‹ï¼‰è¯­è¨€ï¼šå¯¹äºŽæ‰€æœ‰è¯­æ³•éƒ½æœ‰ aAb := cBd å½¢å¼çš„è¯­è¨€ï¼Œç§°ä¹‹ä¸ºä¸Šä¸‹æ–‡æœ‰å…³è¯­è¨€ä¸Šä¸‹æ–‡æ— å…³ï¼ˆ2 åž‹ï¼‰è¯­è¨€ï¼šå¯¹äºŽæ‰€æœ‰è¯­æ³•éƒ½æœ‰ A := aBb å½¢å¼çš„è¯­è¨€ï¼Œç§°ä¹‹ä¸ºä¸Šä¸‹æ–‡æ— å…³è¯­è¨€æ­£åˆ™ï¼ˆ3 åž‹ï¼‰è¯­è¨€ï¼šå¯¹äºŽæ‰€æœ‰è¯­æ³•éƒ½æœ‰ A := aB æˆ– A := Ba å½¢å¼çš„è¯­è¨€ï¼Œç§°ä¹‹ä¸ºæ­£åˆ™è¯­è¨€ å¯ä»¥çœ‹å‡ºï¼Œä»Žä¸Šåˆ°ä¸‹å¯¹è¯­æ³•çš„é™åˆ¶æ„ˆå‘å¢žå¤šï¼Œè¯­è¨€çš„å¤šæ ·æ€§ä¹Ÿéšä¹‹å‡å°‘ã€‚å¯¹äºŽ 1 å’Œ 2 åž‹è¯­è¨€çš„å‘½åä¸­çš„â€œæœ‰å…³â€ã€â€œæ— å…³â€ï¼Œæ˜¯æŒ‡éžç»ˆç»“ç¬¦çš„è§£æžæ˜¯å¦å—å…¶é‚»æŽ¥çš„ç»ˆç»“ç¬¦å½±å“ã€‚ å¤§éƒ¨åˆ†è‡ªç„¶è¯­è¨€éƒ½æ˜¯ä¸Šä¸‹æ–‡æœ‰å…³è¯­è¨€ã€‚æ¯”å¦‚è‹±è¯­ä¸­&quot;I broke a window&quot;å’Œ&quot;The window broke&quot;ä¸­çš„&quot;broke&quot;ä¾¿æ˜¯å—åˆ°å®¾è¯­æœ‰æ— çš„å½±å“è€Œåˆ†åˆ«æˆä¸ºäº†åŠç‰©å’Œä¸åŠç‰©åŠ¨è¯ã€‚ ä¸Šä¸‹æ–‡æ— å…³è¯­è¨€ä¸»è¦è¢«ç”¨äºŽè®¾è®¡ç¨‹åºï¼Œè¿™æ˜¯å› ä¸ºè§£æž 2 åž‹è¯­è¨€æ—¶ä¸éœ€è€ƒè™‘è¯­æ³•ç»“æž„æ‰€å¤„çš„ä¸Šä¸‹æ–‡ï¼Œå…¶è¯­æ³•è§£æžå™¨ç›¸å¯¹å®¹æ˜“å®žçŽ°ã€‚ å¯ä»¥çœ‹å‡ºï¼Œæ­£åˆ™è¯­è¨€çš„è¡¨è¾¾èƒ½åŠ›æžä¸ºå—é™ï¼Œå› ä¸ºå…¶è§£æžè¿‡ç¨‹åªèƒ½åœ¨æ¯ä¸€æ­¥ä¸­å¢žæ·»ä¸€å‰ç¼€æˆ–åŽç¼€ã€‚å¯¹äºŽæ€»æ˜¯å¢žåŠ å‰ç¼€çš„æ­£åˆ™è¯­è¨€ï¼Œæˆ‘ä»¬ç§°ä¸ºå·¦çº¿æ€§è¯­è¨€ï¼Œåä¹‹ç§°ä¸ºå³çº¿æ€§è¯­è¨€ã€‚äº‹å®žä¸Šï¼Œå¯¹è¿™ç§é«˜åº¦å—é™çš„è¯­è¨€ï¼Œäººä»¬å·²ç»è®¾è®¡å‡ºæ¥ä¸€äº›å¼ºå¤§çš„ç”¨æ¥è§£æžå®ƒä»¬çš„å·¥å…·äº†ï¼Œæ¯”å¦‚æ­£åˆ™è¡¨è¾¾å¼ã€‚ è¯­æ³•æŽ¨å¯¼å¯¹äºŽä»»æ„ä¸€ç»„è¯­æ³•å’Œä¸€ä¸ªæŒ‡å®šçš„éžç»ˆç»“ç¬¦ï¼Œæ€»æ˜¯å¯ä»¥æ ¹æ®å…¶ä¸­çš„è§„åˆ™å°†è¿™ä¸ªéžç»ˆç»“ç¬¦æ‰©å±•æˆä¸€ä¸ªç»ˆç»“ç¬¦ä¸²ï¼ˆå¯èƒ½æ˜¯æ— é™çš„ï¼‰ã€‚æ¯”å¦‚å¯¹äºŽè¿™æ¡ï¼ˆæ­£åˆ™ï¼‰æ–‡æ³•ï¼š1&lt;A&gt; := &quot;a&quot; &lt;A&gt; | &quot;&quot; ä¸æ–­åœ°å°† &lt;A&gt;æ›¿æ¢ä¸º&quot;a&quot;ï¼Œä¾¿å¯ä»¥æŽ¨å‡ºä¸‹åˆ—å­—ç¬¦ä¸²ï¼š1a, aa, aaa, aaaa, ... å¦‚æžœä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ç»ˆç»“ç¬¦å’Œéžç»ˆç»“ç¬¦ï¼‰èƒ½ç”±æŸç»„è¯­æ³•æŽ¨å¯¼è¿‡æ¥ï¼Œå°±è¯´è¿™ä¸ªå­—ç¬¦ä¸²è§„çº¦åˆ°è¿™ç»„è¯­æ³•ã€‚ æ•°å­¦æŽ¨ç†åœ¨æ•°å­¦ä¸Šï¼Œæˆ‘ä»¬æŠŠæœ€å¼€å§‹ç»™å®šçš„é‚£ç»„è¯­æ³•å«åšâ€œå…¬ç†â€ï¼ŒæŠŠç”±æ‰€æœ‰ç»ˆç»“ç¬¦å¯èƒ½æž„æˆçš„å­—ç¬¦ä¸²ç§°ä½œâ€œå‘½é¢˜â€ã€‚æ‰€æœ‰çš„å…¬ç†éƒ½æ˜¯å…¬è®¤ä¸ºçœŸçš„å‘½é¢˜ï¼Œæ¯”å¦‚æ¬§å¼å‡ ä½•é‡Œçš„â€œè¿‡ä¸¤ç‚¹å¿…æœ‰ä¸€æ¡ç›´çº¿â€ã€‚ å¯¹äºŽé‚£äº›å¯ä»¥è§„çº¦åˆ°å…¬ç†çš„å‘½é¢˜ï¼Œæˆ‘ä»¬è¯´å®ƒä»¬æ˜¯ä¹Ÿæ˜¯çœŸçš„ï¼Œå¹¶ç§°å®ƒä»¬ä¸ºâ€œå®šç†â€ã€‚è€Œå…¬ç†åˆ°å®šç†çš„æŽ¨å¯¼è¿‡ç¨‹ï¼Œè‡ªç„¶å°±å«â€œè¯æ˜Žâ€ã€‚ æ‰€æœ‰çš„å…¬ç†éƒ½å¯ä»¥åœ¨è‡ªå·±å‰é¢åŠ ä¸Šä¸€ä¸ªç»ˆç»“ç¬¦â€œéžâ€ï¼Œæ¥å˜æˆè‡ªå·±çš„åå‘½é¢˜ã€‚å¯¹äºŽæ‰€æœ‰èƒ½è§„çº¦åˆ°å…¬ç†çš„åå‘½é¢˜çš„å‘½é¢˜ï¼Œæˆ‘ä»¬è¯´å®ƒä»¬æ˜¯å‡çš„ã€‚è¿™æ ·ï¼Œæ‰€æœ‰å‘½é¢˜å°±æœ‰äº†è‡ªå·±çš„çœŸå‡ï¼Œæˆ–è€…æ›´ä¸“ä¸šä¸€ç‚¹åœ°ï¼Œå«å®ƒä»¬â€œçœŸå€¼â€ã€‚ å¯¹äºŽä»»æ„çš„æ•°å­¦å‘½é¢˜ï¼Œåªéœ€è¦å¯¹å®ƒä»¬è¿›è¡Œè§„çº¦ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½å›žåˆ°æœ€åˆçš„å…¬ç†å³å¯çŸ¥é“å®ƒä»¬æ­£ç¡®ä¸Žå¦äº†ã€‚ è¿™ä¼¼ä¹Žçœ‹ä¸ŠåŽ»å¤ªç¾Žå¥½äº†ï¼Œä½ æ€Žä¹ˆèƒ½ä¿è¯æ‰€æœ‰å‘½é¢˜éƒ½ä¸€å®šèƒ½è§„çº¦åˆ°å…¬ç†æˆ–å®ƒä»¬çš„åå‘½é¢˜ä¸ŠåŽ»å‘¢ï¼Ÿæœ‰æ²¡æœ‰å¯èƒ½å­˜åœ¨ä¸€ä¸ªå‘½é¢˜ï¼Œå®ƒæ ¹æœ¬å°±ä¸å¯èƒ½é€šè¿‡æœ‰é™æ¬¡è§„çº¦ï¼Œå¾—åˆ°æœ€åˆçš„å…¬ç†å‘¢ï¼Ÿ è¿˜çœŸçš„æœ‰ä¸€ä¸ªç¥žäººæŒ–åˆ°äº†è¿™ä¹ˆä¸€ä¸ªå¤§å‘ï¼Œç›´æŽ¥å¦å®šäº†æ•°å­¦çš„å®Œå¤‡æ€§ï¼ˆå³æ‰€æœ‰å‘½é¢˜å‡èƒ½è¯æ˜Žæˆ–è¯ä¼ªï¼‰ã€‚è‡³äºŽè¿™äººæ˜¯è°ï¼Œä»¥åŠè¿™å‘æ€Žä¹ˆæŒ–çš„ï¼Œè¯·çœ‹ä¸‹å›žåˆ†è§£ã€‚]]></content>
      <categories>
        <category>math</category>
      </categories>
      <tags>
        <tag>math, NLP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ”¯æŒå‘é‡æœº(SVM)è¯¦è§£]]></title>
    <url>%2F2018%2F05%2F07%2F%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA-SVM-%E8%AF%A6%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[P.S. é‰´äºŽä¸ªäººæ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰è¡¨è¿°é”™è¯¯ä¹‹å¤„æ•¬è¯·æŒ‡å‡ºï¼Œæ„¿æˆ‘ä»¬å…±åŒè¿›æ­¥~ åŸºæœ¬åž‹æŽ¨å¯¼SVMä¸€ç›´æ˜¯æˆ‘æœ€å–œæ¬¢çš„å‡ ä¸ªç®—æ³•ä¹‹ä¸€ï¼Œæ‰€ä»¥æ²¡äº‹å–œæ¬¢æŽ¨ä¸€æŽ¨ã€‚ è¿™é‡Œå°è¯•ç”¨ç®€å•ç›´ç™½çš„è¯­è¨€æ¥å¯¹å®ƒçš„æŽ¨å¯¼è¿‡ç¨‹è¿›è¡Œä»‹ç»~å¦‚æžœä½ è§‰å¾—ä½ å·²ç»æŠŠé«˜æ•°å’Œé«˜ä¸­æ•°å­¦å¿˜å¾—å·®ä¸å¤šäº†ï¼Œæˆ‘æƒ³è¿™æˆ–è®¸å°±æ˜¯ä½ ä¸€ç›´åœ¨æ‰¾çš„ç®€æ˜ŽSVMæŽ¨å¯¼è¿‡ç¨‹ä»‹ç»~ðŸ˜‹ ç»™å®š$D={(x_1,y_1),(x_2,y_2),â€¦,(x_m,y_m)},y_i \in {-1,+1}$ï¼ŒSVMè€ƒè™‘åŸºäºŽè®­ç»ƒé›†$D$åœ¨æ ·æœ¬ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢(hiperplane)ï¼Œå°†ä¸åŒç±»åˆ«çš„æ ·æœ¬åˆ†å¼€ã€‚ åˆ’åˆ†è¶…å¹³é¢æ–¹ç¨‹ï¼š$${\bf \omega}^Tx+b=0 \tag{1}$$ï¼ˆåˆ«æ…Œï¼Œå®ƒå…¶å®žå°±æ˜¯ä¸€æ¡ç›´çº¿å…¬å¼è€Œå·²ï¼‰å…¶ä¸­$\omega=(\omega_1;\omega_2;â€¦;\omega_d;)$ä¸ºæ³•å‘é‡ï¼Œå†³å®šäº†è¶…å¹³é¢çš„æ–¹å‘ï¼›$b$ä¸ºä½ç§»é¡¹ï¼Œå†³å®šäº†è¶…å¹³é¢ä¸ŽåŽŸç‚¹ä¹‹é—´çš„è·ç¦»ã€‚é€šå¸¸åˆ’åˆ†è¶…å¹³é¢ç”¨$(\omega,b)$æ¥è¡¨ç¤ºï¼Œå› ä¸ºå…¶å¯è¢«æ³•å‘é‡$\omega$å’Œä½ç§»$b$ç¡®å®šã€‚æ ·æœ¬ç©ºé—´ä¸­ä»»æ„ç‚¹$x$åˆ°è¶…å¹³é¢$(\omega,b)$çš„è·ç¦»å¯å†™ä¸º$$r=\frac{|\omega^Tx+b|}{||\omega||} \tag{2}$$ï¼ˆå†æ¬¡åˆ«æ…Œï¼Œè®©æˆ‘ä»¬è½¬åŠ¨æˆ‘ä»¬æŽŒæ¡äº†åˆä¸­æ•°å­¦çŸ¥è¯†çš„å°è„‘ç“œæ¥æƒ³ä¸€ä¸‹ï¼Œå…¶å®žè¿™å°±æ˜¯ç‚¹åˆ°ç›´çº¿çš„è·ç¦»å…¬å¼å¯¹å§ï¼‰å‡è®¾è¶…å¹³é¢$(\omega,b)$èƒ½å°†è®­ç»ƒæ ·æœ¬æ­£ç¡®åˆ†ç±»ï¼Œå¯¹äºŽ$(x_i,y_i)\in D$,æœ‰ä»¥ä¸‹å¼å­ï¼š$$\begin{cases}\omega^Tx_i+b &gt; 0, &amp; y_i = +1\\omega^Tx_i+b &lt; 0, &amp; y_i = -1\end{cases} \tag{3}$$è¿™å…¶å®žä¾¿æ˜¯é€»è¾‘å›žå½’çš„æ€è·¯ï¼Œéžé»‘å³ç™½ï¼Œä½†æ˜¯è¿™æ˜Žæ˜¾å¯¹è‡ªå·±çš„ç®—æ³•å¤ªè‡ªä¿¡äº†å¯¹å§ã€‚æˆ‘ä»¬å¯çˆ±çš„æ”¯æŒå‘é‡æœºå¯¹æ­¤è¡¨ç¤ºæ€€ç–‘ï¼Œå¹¶ä¸”å¤šç•™äº†ä¸€ä¸ªå¿ƒçœ¼ï¼ŒäºŽæ˜¯å®ƒä»¤ï¼š$$\begin{cases}\omega^Tx_i+b \geq +1, &amp; y_i = +1\\omega^Tx_i+b \leq -1, &amp; y_i = -1\end{cases} \tag{4}$$ å¦‚å›¾æ‰€ç¤ºï¼š å…¶ä¸­è·ç¦»åˆ’åˆ†è¶…å¹³é¢æœ€è¿‘çš„å‡ ä¸ªè®­ç»ƒæ ·æœ¬ç‚¹ä½¿ä¸Šå¼çš„ç­‰å·æˆç«‹ï¼Œè¿™å‡ ä¸ªè®­ç»ƒæ ·æœ¬å°±è¢«ç§°ä½œæ”¯æŒå‘é‡ï¼ˆsupport vectorï¼‰ï¼Œä¸¤ä¸ªå¼‚ç±»æ”¯æŒå‘é‡åˆ°è¶…å¹³é¢çš„è·ç¦»ä¹‹å’Œï¼Œä¹Ÿç§°ä¸ºé—´éš”ï¼ˆmarginï¼‰ï¼Œä¸º$$\gamma = \frac{2}{||\omega||} \tag{5}$$(å…¶å®žå°±æ˜¯ $\omega^Tx_i+b = +1 $å’Œ$ \omega^Tx_i+b = -1 $ä¸¤ä¸ªè¶…å¹³é¢ä¹‹é—´çš„è·ç¦»å…¬å¼) é‚£ä¹ˆæŒ‰æˆ‘ä»¬çš„è®¾æƒ³ï¼Œæˆ‘ä»¬åšåˆ†ç±»å­¦ä¹ ï¼Œå®žé™…ä¸Šå°±æ˜¯ä¸ºäº†æ‰¾åˆ°ä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢å°†è¿™äº›æ ·æœ¬ç»™éš”å¼€ï¼Œé‚£ä¹ˆä»€ä¹ˆæ ·å­çš„åˆ’åˆ†è¶…å¹³é¢æ˜¯æœ€æœ‰æ•ˆçš„å‘¢ï¼Ÿä»Žç›´è§‚ä¸Šæ¥çœ‹ï¼Œä½äºŽæ­£è´Ÿæ ·æœ¬â€œæ­£ä¸­é—´â€çš„åˆ’åˆ†è¶…å¹³é¢ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾çº¢è‰²çš„é‚£ä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢ï¼Œåº”è¯¥æ˜¯æœ€å¥½çš„ï¼Œå› ä¸ºå®ƒçš„é²æ£’æ€§æœ€å¥½ï¼Œå¯¹æœªçŸ¥æ ·æœ¬çš„æ³›åŒ–æ€§æœ€å¥½ã€‚ é‚£ä¹ˆå¦‚ä½•åŽ»å¾—åˆ°è¿™ä¸ªåˆšå¥½ä½äºŽæ­£è´Ÿæ ·æœ¬â€œæ­£ä¸­é—´â€çš„åˆ’åˆ†è¶…å¹³é¢å‘¢ï¼Ÿæ€è€ƒä¸€ä¸‹ï¼Œæ˜¯ä¸æ˜¯åªè¦æˆ‘ä»¬è®©é—´éš”æœ€å¤§ï¼Œè¿™æ ·åªè¦æˆ‘ä»¬å–é—´éš”ä¸­é—´çš„é‚£æ¡ç›´çº¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªæœ€æ£’çš„åˆ’åˆ†è¶…å¹³é¢äº†ï¼Ÿæ¢å¥è¯è¯´ï¼Œå¯¹äºŽåŸºäºŽSVMçš„åˆ†ç±»å­¦ä¹ è€Œè¨€ï¼Œé—®é¢˜å·²ç»ä»Žæ‰¾åˆ°ä¸€ä¸ªæœ€å¥½çš„åˆ’åˆ†è¶…å¹³é¢è½¬æ¢ä¸ºäº†æ‰¾åˆ°æ ·æœ¬ç©ºé—´é‡Œçš„æœ€å¤§åŒ–é—´éš”ã€‚æˆ‘ä»¬ç”¨æ•°å­¦è¯­è¨€æ¥æè¿°ä¸€ä¸‹è¿™ä¸ªæ›´æ–°åŽçš„é—®é¢˜ï¼Œå°±å˜æˆäº†æ‰¾åˆ°èƒ½æ»¡è¶³$å¼(4)$çš„çº¦æŸæ¡ä»¶çš„å‚æ•°$\omega$å’Œ$b$ï¼Œå¹¶ä¸”è¦ä½¿å¾—$\gamma = \frac{2}{||\omega||}$ä¸­çš„$\gamma$æœ€å¤§ã€‚ç”¨æ•°å­¦å…¬å¼æ¥è¡¨ç¤ºæ˜¯è¿™ä¸ªæ ·å­:$$max_{\omega,b} \frac{2}{||\omega||},s.t. y_i(\omega^Tx_i+b) \geq 1, i = 1,2,â€¦,m \tag{6}$$OKï¼Œä½ å¯èƒ½ä¼šå–Šï¼šç­‰ç­‰ç­‰ç­‰ï¼Œ$max_{\omega,b} \frac{2}{||\omega||}$æ˜¯è¡¨ç¤º$\max ,\gamma$æˆ‘æ‡‚ï¼Œä½†æ˜¯ä½ è¿™ä¸ªæ¡ä»¶$y_i(\omega^Tx_i+b) \geq 1, i = 1,2,â€¦,m$æ˜¯ä»€ä¹ˆé¬¼ä½ è¦ä¸è¦è§£é‡Šä¸€ä¸‹ï¼Ÿ å—¯å’³ï¼Œè®©æˆ‘ä»¬æš‚åœä¸€ä¸‹ï¼Œå›žçœ‹ä¸€ä¸‹çº¦æŸæ¡ä»¶(å³æ­£ç¡®åˆ†ç±»çš„æ¡ä»¶)ï¼š$$\begin{cases}\omega^Tx_i+b \geq +1, &amp; y_i = +1\\omega^Tx_i+b \leq -1, &amp; y_i = -1\end{cases} \tag{7}$$æ³¨æ„ï¼Œæ˜¯ä¸æ˜¯ä¸Šä¸‹ä¸¤ä¸ªçº¦æŸæ¡ä»¶çš„å·¦å³å¼å­ç›¸ä¹˜ï¼ˆ$ \omega^Tx_i+b \geq +1 y_i = +1$ or $\omega^Tx_i+b \leq -1 y_i = -1$ ï¼‰å°±ç­‰äºŽ$y_i(\omega^Tx_i+b) \geq 1$äº†ï¼Ÿ OKï¼Œè®©æˆ‘ä»¬ç»§ç»­å¾€ä¸‹ã€‚å¯¹äºŽå¼å­$$max_{\omega,b} \frac{2}{||\omega||},s.t. y_i(\omega^Tx_i+b) \geq 1, i = 1,2,â€¦,m \tag{8}$$æ˜¾ç„¶ï¼Œä¸ºäº†æœ€å¤§åŒ–é—´éš”ï¼Œä»…éœ€æœ€å¤§åŒ–$\frac{1}{||\omega||}$ï¼Œä¸ºäº†ä½¿ç›®æ ‡å‡½æ•°å…‰æ»‘ä»Žè€Œæ–¹ä¾¿è®¡ç®—ï¼ŒäºŽæ˜¯è¿™ç­‰ä»·äºŽæœ€å°åŒ–$||\omega||^2$ã€‚äºŽæ˜¯ä¸Šå¼æˆ‘ä»¬å¯ä»¥é‡å†™ä¸ºï¼š$$min_{\omega,b}\frac{1}{2}||\omega||^2,s.t. y_i(\omega^Tx_i+b) \geq 1, i = 1,2,â€¦,m \tag{9}$$è¿™å°±æ˜¯SVMçš„åŸºæœ¬åž‹ã€‚ æˆ‘ä»¬éœ€è¦æ³¨æ„åˆ°ï¼Œå®ƒå…¶å®žæ˜¯ä¸€ä¸ªå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼ˆconvex quadratic programmingï¼‰ï¼Œå¯ä»¥ç”¨ä¹‹å‰çš„æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ±‚è§£ã€‚ SVMçš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°é¦–å…ˆå›žé¡¾ä¸€ä¸‹æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ ‡å‡†åž‹$$\min \ f(x)ï¼› \ \ s.t. g_i(x) \leq 0ï¼› i = 1,â€¦,m, h_i(x) = 0ï¼› i = 1,â€¦,m \tag{10}$$ä½ å¯ä»¥çœ‹åˆ°ï¼ŒSVMåŸºæœ¬å¼ç›¸å¯¹æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ ‡å‡†åž‹è€Œè¨€ï¼Œæœ‰$f(\omega, b) = \frac{1}{2}||\omega||^2$$g(\omega, b) = 1-y_i(\omega^Tx_i+b) \leq 0,i=1,2,â€¦,m.$$h(\omega, b) = 0$ å› æ­¤ï¼Œæˆ‘ä»¬å°†SVMçš„$f(\omega, b)ã€g(\omega, b)ã€h(\omega, b)$ä»£å…¥(10)åŽï¼Œå°±å¯ä»¥å¾—åˆ°è¯¥é—®é¢˜çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°äº†ï¼Œå³$$L(\omega,b, \alpha) = \frac{1}{2}||\omega||^2 + \sum_{i=1}^m \alpha_i (1-y_i(\omega^Tx_i + b)) \tag{11}$$å…¶ä¸­$\alpha = (\alpha_1; \alpha_2;â€¦;\alpha_m)$,æ‹‰æ ¼æœ—æ—¥ä¹˜å­$\alpha_i \geq 0$ã€‚ é€šå¸¸ä¸€ä¸ªä¼˜åŒ–é—®é¢˜å¯ä»¥ä»Žä¸¤ä¸ªè§’åº¦æ¥è€ƒè™‘ï¼Œå³ä¸»é—®é¢˜(primal problem)å’Œå¯¹å¶é—®é¢˜(dual problem)ã€‚åœ¨çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ä¸­ï¼Œå¸¸å¸¸åˆ©ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§å°†åŽŸå§‹é—®é¢˜ï¼ˆä¸»é—®é¢˜ï¼‰è½¬æ¢æˆå¯¹å¶é—®é¢˜ï¼Œé€šè¿‡è§£å¯¹å¶é—®é¢˜æ¥å¾—åˆ°åŽŸå§‹é—®é¢˜çš„è§£ã€‚è¿™æ ·åšæ˜¯å› ä¸ºå¯¹å¶é—®é¢˜çš„å¤æ‚åº¦å¾€å¾€ä½ŽäºŽä¸»é—®é¢˜ã€‚æ‰€ä»¥åœ¨æ±‚è§£SVMçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿä¼šé€šè¿‡å…¶æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§ï¼Œå°†è¯¥ä¸»é—®é¢˜$å¼(9)$è½¬æ¢æˆå¯¹å¶é—®é¢˜ï¼Œç„¶åŽè¿›è¡Œæ±‚è§£ã€‚ SVMçš„å¯¹å¶é—®é¢˜éœ€è¦è¯´æ˜Žçš„æ˜¯ï¼Œå› ä¸ºä¸»é—®é¢˜æœ¬èº«æ˜¯ä¸€ä¸ªå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œå› æ­¤å®ƒæ˜¯èƒ½ç›´æŽ¥ç”¨çŽ°æˆçš„ä¼˜åŒ–è®¡ç®—åŒ…æ±‚è§£çš„ï¼Œä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•å¾—åˆ°å…¶å¯¹å¶é—®é¢˜æ˜¯ä¸ºäº†ä¼˜åŒ–è¿ç®—æ•ˆçŽ‡ã€‚ é‚£ä¹ˆè®©æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹SVMçš„ä¸»é—®é¢˜$å¼(9)$å’ŒSVMçš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°$å¼(10)$ï¼Œå…¶ä¸­$\alpha = (\alpha_1; \alpha_2;â€¦;\alpha_m)$,æ‹‰æ ¼æœ—æ—¥ä¹˜å­$\alpha_i \geq 0$ã€‚ ä½ å¯ä»¥å‘çŽ°ï¼ŒSVMæ°æ°æ»¡è¶³äº†å‰é¢åšå®¢ä¸­æˆ‘ä»¬è®²è¿‡çš„çš„å¼ºå¯¹å¶æ€§ã€‚ å› æ­¤ï¼Œè€ƒè™‘ä»¤$L(\omega,b, \alpha)$å¯¹$\omega$å’Œ$b$çš„åå¯¼ä¸º0å¯å¾—$$\omega = \sum_{i=1}^m \alpha_i y_i x_i \tag{12}$$$$0 = \sum_{i=1}^m \alpha_i y_i \tag{13}$$å°†å¼(12)ä»£å…¥(11)ï¼Œå°±å¯ä»¥å°†$L(\omega,b, \alpha)$ä¸­çš„$\omega$å’Œ$b$æ¶ˆåŽ»ï¼Œå†è€ƒè™‘å¼(13)çš„çº¦æŸï¼Œå°±å¾—åˆ°å¼ï¼ˆ9ï¼‰çš„å¯¹å¶é—®é¢˜ã€‚$$max_{\alpha} \sum_{i=1}^m \alpha_i - \frac{1}{2} \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j y_i y_j x_i^T x_j \tag{14}$$$$s.t. \sum_{i=1}^m \alpha_i y_i = 0, \alpha_i \geq 0, i=1,2,â€¦,m$$ æ±‚è§£è¯¥æ¨¡åž‹ï¼Œè§£å‡º$\alpha$åŽï¼Œæ±‚å‡º$\omega$å’Œ$b$å³å¯å¾—åˆ°æ¨¡åž‹$$f(x) = \omega^T x + b = \sum_{i=1}^m \alpha_i y_i x_i^Tx + b \tag{15}$$ä»Žå¯¹å¶é—®é¢˜ï¼ˆ14ï¼‰è§£å‡ºçš„$\alpha_i$æ˜¯å¼(11)ä¸­çš„æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œå®ƒæ°å¥½å¯¹åº”ç€è®­ç»ƒæ ·æœ¬$(x_i,y_i)$ã€‚å› ä¸ºå¼(9)ä¸­æœ‰ä¸ç­‰å¼çº¦æŸï¼Œå› æ­¤ä¸Šè¿°è¿‡ç¨‹è¿˜éœ€æ»¡è¶³KKTæ¡ä»¶ï¼Œå³$$\begin{cases}\alpha_i \geq 0\ y_i f(x_i)-1 \geq 0\ \alpha_i(y_i f(x_i)-1) = 0\end{cases} \tag{16}$$ äºŽæ˜¯ï¼Œå¯¹ä»»æ„è®­ç»ƒæ ·æœ¬$(x_i,y_i)$ï¼Œæ€»æœ‰$\alpha_i=0$æˆ–$y_i f(x_i)=1$ã€‚ è‹¥$\alpha_i = 0$ï¼Œåˆ™è¯¥æ ·æœ¬å°†ä¸ä¼šåœ¨å¼ï¼ˆ4.1ï¼‰çš„æ±‚å’Œä¸­å‡ºçŽ°ï¼Œä¹Ÿå°±ä¸ä¼šå¯¹$f(x)$äº§ç”Ÿä»»ä½•å½±å“ï¼› è‹¥$\alpha_i &gt; 0$ï¼Œåˆ™å¿…æœ‰$y_i f(x_i)=1$ï¼Œæ‰€å¯¹åº”çš„æ ·æœ¬ç‚¹ä½äºŽæœ€å¤§é—´éš”è¾¹ç•Œä¸Šï¼Œæ˜¯ä¸€ä¸ªæ”¯æŒå‘é‡ã€‚ è¿™æ˜¾ç¤ºå‡ºæ”¯æŒå‘é‡æœºçš„ä¸€ä¸ªé‡è¦æ€§è´¨ï¼š è®­ç»ƒå®ŒæˆåŽï¼Œå¤§éƒ¨åˆ†çš„è®­ç»ƒæ ·æœ¬éƒ½ä¸éœ€ä¿ç•™ï¼Œæœ€ç»ˆæ¨¡åž‹ä»…ä¸Žæ”¯æŒå‘é‡æœ‰å…³ã€‚ é‚£ä¹ˆå¦‚ä½•æ±‚è§£å¼ï¼ˆ14ï¼‰å‘¢ï¼Ÿä¸éš¾å‘çŽ°ï¼Œè¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œå¯ä½¿ç”¨é€šç”¨çš„äºŒæ¬¡è§„åˆ’ç®—æ³•æ¥æ±‚è§£ï¼Œè¿™ä¸€éƒ¨åˆ†å¯ä»¥å‚è€ƒåˆšæ‰å¯¹ã€äºŒæ¬¡è§„åˆ’ã€‘çš„è®²è§£ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨SMOç­‰ç®—æ³•å¯¹å…¶è¿›è¡Œæ±‚è§£ã€‚å…³äºŽSMOç®—æ³•ï¼Œæˆ‘ä»¬å°±ä¸‹æ¬¡å†è¯´å•¦~ ç¼–ç¨‹å®žçŽ°è§æˆ‘GitHubã€‚ å‚è€ƒèµ„æ–™ [1] ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æŽèˆª è‘— æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾[2]ã€Šæœºå™¨å­¦ä¹ ã€‹ å‘¨å¿—åŽ è‘— æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾[3] Stanford CS229 Machine Learningçš„æ•™å­¦èµ„æ–™ï¼šhttp://cs229.stanford.edu/section/cs229-cvxopt.pdf]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§]]></title>
    <url>%2F2018%2F05%2F02%2F%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E5%AF%B9%E5%81%B6%E6%80%A7%2F</url>
    <content type="text"><![CDATA[é¢„å¤‡çŸ¥è¯†å‡¸é›†é¦–å…ˆæ˜¯å‡¸é›†ï¼Œè¿™ä¸ªçš„å‡ ä½•æ„ä¹‰å¦‚å›¾æ‰€ç¤ºï¼ŒæŒ‡é›†åˆä¸­ä»»æ„ä¸¤ç‚¹é—´çš„çº¿æ®µæ°¸è¿œåœ¨é›†åˆä¸­çš„é›†åˆã€‚ ä½ å¯ä»¥çœ‹åˆ°ï¼Œå·¦å›¾ä¸­ä»»æ„ä¸¤ç‚¹ï¼Œå®ƒä»¬çš„çº¿æ®µä¸€å®šä¼šåœ¨Cè¿™ä¸ªé›†åˆä¸­ï¼Œæ‰€ä»¥å®ƒå°±æ˜¯ä¸€ä¸ªå‡¸é›†ï¼Œä½†æ˜¯å¯¹äºŽå³å›¾è€Œè¨€ï¼Œå…¶çº¿æ®µå°±å¯èƒ½ä¼šæœ‰éƒ¨åˆ†ä¸åœ¨é›†åˆä¸­ï¼Œå› æ­¤å®ƒä¸æ˜¯å‡¸é›†ã€‚ å¦‚æžœæˆ‘ä»¬ç”¨æ•°å­¦å®šä¹‰æ¥æè¿°å‡¸é›†çš„è¯ï¼Œå®ƒæ˜¯æŒ‡è¿™æ ·çš„ä¸€ä¸ªé›†åˆ$C$ï¼šå¯¹ä»»æ„$x,y \in C, \lambda \in R, 0 \leq \lambda \leq 1$ï¼Œéƒ½æœ‰$$\lambda x + (1-\lambda)y \in C \tag{1}$$ å¸¸è§çš„å‡¸é›†æœ‰ï¼š nç»´å®žæ•°ç©ºé—´ï¼› ä¸€äº›èŒƒæ•°çº¦æŸå½¢å¼çš„é›†åˆï¼› ä»¿å°„å­ç©ºé—´ï¼› å‡¸é›†çš„äº¤é›†ï¼› nç»´åŠæ­£å®šçŸ©é˜µé›†ã€‚ å‡¸å‡½æ•°é‚£ä¹ˆçŸ¥é“å‡¸é›†æ˜¯ä»€ä¹ˆæ„æ€åŽï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å‡¸å‡½æ•°ã€‚å‡¸å‡½æ•°çš„å‡ ä½•æ„ä¹‰æ˜¯ï¼Œå‡½æ•°ä»»æ„ä¸¤ç‚¹(x, y)è¿žçº¿ä¸Šçš„å€¼ä¸€å®šå¤§äºŽå¯¹åº”è‡ªå˜é‡åŒº(x, y)é—´å†…çš„å‡½æ•°å€¼(f(x),f(y))ï¼Œç¤ºä¾‹å›¾å¦‚ä¸‹ï¼š ä½ å¯ä»¥çœ‹åˆ°ï¼Œå°†xyè¿žæŽ¥èµ·æ¥çš„ç›´çº¿ä¸Šçš„å€¼ï¼Œä¸€å®šå¤§äºŽxyä¸¤ç‚¹èŒƒå›´å†…çš„å‡½æ•°å€¼$f(x)$ å¦‚æžœæˆ‘ä»¬ç”¨æ•°å­¦å®šä¹‰æ¥æè¿°å‡¸å‡½æ•°çš„è¯ï¼Œå‡¸å‡½æ•°$f(x)$æ˜¯è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°ï¼šå®šä¹‰åŸŸä¸ºå‡¸é›†$D(f)$ï¼Œä¸”å¯¹äºŽä»»æ„$x,y \in D(f),\lambda \in R, 0 \leq \lambda \leq 1$ï¼Œæœ‰$$f(\lambda x + (1-\lambda)y) \leq \lambda f(x) + (1-\lambda)f(y) \tag{2}$$ å¸¸è§çš„å‡¸å‡½æ•°æœ‰: æŒ‡æ•°å‡½æ•°æ—ï¼›éžè´Ÿå¯¹æ•°å‡½æ•°ï¼›ä»¿å°„å‡½æ•°ï¼›äºŒæ¬¡å‡½æ•°ï¼›å¸¸è§çš„èŒƒæ•°å‡½æ•°ï¼›å‡¸å‡½æ•°éžè´ŸåŠ æƒçš„å’Œç­‰ã€‚ ##å‡¸ä¼˜åŒ–é—®é¢˜ è®²è§£å®Œå‡¸é›†å’Œå‡¸å‡½æ•°çš„å®šä¹‰ï¼Œç»ˆäºŽåˆ°å‡¸ä¼˜åŒ–é—®é¢˜äº†ã€‚å‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå®žé™…ä¸Šå°±æ˜¯ç ”ç©¶å®šä¹‰äºŽå‡¸é›†ä¸­çš„å‡¸å‡½æ•°æœ€å°åŒ–é—®é¢˜ã€‚æ­£å¼çš„è¯´ï¼Œå‡¸ä¼˜åŒ–é—®é¢˜åœ¨ä¼˜åŒ–é—®é¢˜ä¸­çš„å½¢å¼æ˜¯è¿™æ ·çš„$$\min \ f(x), \ \ s.t. x \in C \tag{3}$$å…¶ä¸­$f$æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œ$C$ä¸ºå‡¸é›†ï¼Œ$x$æ˜¯ä¼˜åŒ–å˜é‡ã€‚å› ä¸ºä¸Šé¢è¿™ä¸ªè¡¨è¾¾è¿˜æ˜¯æœ‰äº›å«ç³Šï¼Œæ‰€ä»¥å‡¸ä¼˜åŒ–é—®é¢˜æˆ‘ä»¬æ›´å¸¸ç”¨è¿™ä¸ªå½¢å¼æ¥è¡¨ç¤ºå®ƒ$$\min \ f(x), \ \ s.t. g_i(x) \leq 0, i = 1,â€¦,m, h_i(x) = 0, i = 1,â€¦,m \tag{4}$$å…¶ä¸­$f$æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œ$g_i$æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°, $h_i$ä¸ºä»¿å°„å‡½æ•°ï¼Œ$x$æ˜¯ä¼˜åŒ–å˜é‡ã€‚ å¸¸è§çš„å‡¸ä¼˜åŒ–é—®é¢˜æœ‰: çº¿æ€§è§„åˆ’ã€äºŒæ¬¡è§„åˆ’ã€äºŒæ¬¡çº¦æŸçš„äºŒæ¬¡è§„åˆ’ã€åŠæ­£å®šè§„åˆ’ã€‚ äºŒæ¬¡è§„åˆ’äºŒæ¬¡è§„åˆ’ï¼ˆQuadratic Programmingï¼Œç®€ç§°QPï¼‰æ˜¯ä¸€ç±»å…¸åž‹çš„ä¼˜åŒ–é—®é¢˜ï¼ŒåŒ…æ‹¬å‡¸äºŒæ¬¡è§„åˆ’å’Œéžå‡¸äºŒæ¬¡ä¼˜åŒ–ã€‚åœ¨æ­¤ç±»é—®é¢˜ä¸­ï¼Œç›®æ ‡å‡½æ•°æ˜¯å˜é‡çš„äºŒæ¬¡å‡½æ•°ï¼Œè€Œçº¦æŸæ¡ä»¶æ˜¯å˜é‡çš„çº¿æ€§ä¸ç­‰å¼ã€‚å‡å®šå˜é‡ä¸ªæ•°ä¸º$d$ï¼Œçº¦æŸæ¡ä»¶çš„ä¸ªæ•°æ˜¯$m$ï¼Œåˆ™æ ‡å‡†çš„äºŒæ¬¡è§„åˆ’é—®é¢˜å½¢å¦‚$$min_x \frac{1}{2} x^TQx + c^Tx,\ s.t. Ax \leq b \tag{5}$$å…¶ä¸­$x$ä¸º$d$ç»´å‘é‡ï¼Œ$ Q\in R^{d \times d}$ä¸ºå®žå¯¹ç§°çŸ©é˜µï¼Œ$ A \in R^{m \times d}$ä¸ºå®žçŸ©é˜µï¼Œ$b \in R^m$å’Œ$c \in R^d$ä¸ºå®žå‘é‡ï¼Œ$Ax \leq b$çš„æ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªçº¦æŸã€‚ æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼ˆLargrange multipliersï¼‰æ˜¯ä¸€ç§å¯»æ‰¾å¤šå…ƒå‡½æ•°åœ¨ä¸€ç»„çº¦æŸä¸‹çš„æžå€¼çš„æ–¹æ³•ã€‚é€šè¿‡å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œå¯å°†æœ‰$d$ä¸ªå˜é‡ä¸Ž$k$ä¸ªçº¦æŸæ¡ä»¶çš„æœ€ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºå…·æœ‰$d+k$ä¸ªå˜é‡çš„æ— çº¦æŸä¼˜åŒ–é—®é¢˜æ±‚è§£ã€‚è¿™æ ·è¯´ä½ å¯èƒ½ä¼šè§‰å¾—å¾ˆæŠ½è±¡ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬å…ˆä¸¾ä¸€ä¸ªç¨å¾®ç®€å•ä¸€ç‚¹çš„ä¾‹å­ã€‚ ç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜å…ˆè€ƒè™‘ä¸€ä¸ªç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ï¼Œå‡å®š$x$ä¸º$d$ç»´å‘é‡ï¼Œæˆ‘ä»¬æƒ³è¦å¯»æ‰¾$x$çš„æŸä¸ªå–å€¼$x^*$ï¼Œä½¿å¾—ç›®æ ‡å‡½æ•°$f(x)$æœ€å°ä¸”åŒæ—¶æ»¡è¶³$g(x)=0$çš„çº¦æŸã€‚ä»Žå‡ ä½•è§’åº¦çœ‹ï¼Œè¿™ä¸ªé—®é¢˜çš„ç›®æ ‡æ˜¯åœ¨æ–¹ç¨‹$g(x)=0$ç¡®å®šçš„$d-1$ç»´æ›²é¢ä¸Šå¯»æ‰¾èƒ½ä½¿ç›®æ ‡å‡½æ•°æœ€å°åŒ–çš„ç‚¹ã€‚å¦‚å›¾æ‰€ç¤º é€šè¿‡ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬ä¸éš¾å¾—åˆ°å¦‚ä¸‹ç»“è®ºï¼šå¯¹äºŽçº¦æŸæ›²é¢ä¸Šçš„ä»»æ„ç‚¹$x$ï¼Œè¯¥ç‚¹çš„æ¢¯åº¦$\nabla g(x)$æ­£äº¤äºŽçº¦æŸæ›²é¢ï¼›åœ¨æœ€ä¼˜ç‚¹$x^$ï¼Œç›®æ ‡å‡½æ•°åœ¨è¯¥ç‚¹çš„æ¢¯åº¦$\nabla f(x^)$æ­£äº¤äºŽçº¦æŸæ›²é¢ï¼› ç”±æ­¤å¯çŸ¥ï¼Œåœ¨æœ€ä¼˜ç‚¹$x^$ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ¢¯åº¦$\nabla g(x)$å’Œ$\nabla f(x)$çš„æ–¹å‘å¿…ç›¸åŒæˆ–ç›¸åï¼Œå³å­˜åœ¨$\lambda \neq 0$($\lambda$ç§°ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­)ä½¿å¾—$$\nabla f(x^) + \lambda \nabla g(x^*) = 0 \tag{6}$$åŸºäºŽä¸Šé¢è¿™ä¸ªå¼å­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•°$$L(x,\lambda) = f(x) + \lambda g(x) \tag{7}$$ ä½ å¯èƒ½ä¼šç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆæ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¼šæ˜¯è¿™ä¸ªæ ·å­ã€‚é‚£ä¹ˆè®©æˆ‘ä»¬å¯¹è¿™ä¸ªå‡½æ•°è¿›è¡Œæ±‚å¯¼çœ‹çœ‹ï¼šå½“$L(x,\lambda)$å¯¹$x$æ±‚å¯¼æ—¶ï¼š(å› ä¸ºè¦æ±‚æœ€ä¼˜è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç½®$\nabla_x L(x, \lambda)$ä¸º0)$$\nabla_x L(x, \lambda) = \nabla f(x) + \lambda \nabla g(x) = 0 \tag{8}$$å½“$L(x,\lambda)$å¯¹$\lambda$æ±‚å¯¼æ—¶ï¼šï¼ˆæˆ‘ä»¬åŒæ ·ç½®$\nabla_{\lambda} L(x, \lambda)$ä¸º0ï¼‰$$\nabla_{\lambda} L(x, \lambda) = 0 + g(x) = 0 \tag{9}$$ æ³¨æ„ï¼Œåœ¨ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¯»æ‰¾$x$çš„æŸä¸ªå–å€¼$x^*$ï¼Œä½¿å¾—ç›®æ ‡å‡½æ•°$f(x)$æœ€å°ä¸”åŒæ—¶æ»¡è¶³$g(x)=0$çš„çº¦æŸã€‚é‚£ä¹ˆé€šè¿‡æ‹‰æ ¼æœ—æ—¥å‡½æ•°çš„ä¸¤æ¬¡å¯¹ä¸åŒå˜é‡çš„æ±‚å¯¼ï¼Œä½ å¯ä»¥å‘çŽ°å¼(8) = å¼(6)ï¼Œè¿™æ˜¯ä¸ºäº†ä½¿å¾—ç›®æ ‡å‡½æ•°$f(x)$æœ€å° å¼(9) = çº¦æŸæ¡ä»¶$g(x)=0$ï¼Œè¿™æ˜¯ä¸ºäº†æ»¡è¶³çº¦æŸæ¡ä»¶ å› æ­¤ï¼ŒåŽŸçº¦æŸä¼˜åŒ–é—®é¢˜å°±è½¬åŒ–ä¸ºäº†å¯¹æ‹‰æ ¼æœ—æ—¥å‡½æ•°$L(x, \lambda)$çš„æ— çº¦æŸä¼˜åŒ–é—®é¢˜ã€‚ ä¸ç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜çŽ°åœ¨è€ƒè™‘ä¸ç­‰å¼çº¦æŸ$g(x) \leq 0$ï¼Œå¦‚å›¾4æ‰€ç¤ºï¼Œæ­¤æ—¶æœ€ä¼˜ç‚¹$x^*$è¦ä¹ˆåœ¨$g(x) &lt; 0 $çš„åŒºåŸŸé‡Œï¼Œè¦ä¹ˆåœ¨è¾¹ç•Œ$g(x) = 0$ä¸Šã€‚ å¯¹äºŽ$g(x)&lt;0$çš„æƒ…å½¢ï¼Œçº¦æŸ$g(x) \leq 0$ä¸èµ·ä½œç”¨ï¼Œå¯ç›´æŽ¥é€šè¿‡æ¡ä»¶$\nabla f(x)=0$æ¥èŽ·å¾—æœ€ä¼˜ç‚¹ï¼Œè¿™ç­‰ä»·äºŽå°†$\lambda$ç½®0ï¼Œç„¶åŽå¯¹$\nabla_x L(x, \lambda)$ç½®0å¾—åˆ°æœ€ä¼˜ç‚¹å¯¹äºŽ$g(x)=0$çš„æƒ…å½¢ï¼Œç±»ä¼¼äºŽä¸Šé¢æˆ‘ä»¬å¯¹ç­‰å¼çº¦æŸçš„åˆ†æžï¼Œä½†éœ€æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶$\nabla f(x^)$çš„æ–¹å‘å¿…ä¸Ž$\nabla g(x^)$ç›¸åï¼Œå³å­˜åœ¨å¸¸æ•°$\lambda &gt; 0$ä½¿å¾—$\nabla f(x^) + \lambda \nabla g(x^) = 0$ å¯¹ä¸Šé¢æè¿°çš„ä¸¤ç§æƒ…å†µè¿›è¡Œæ•´åˆï¼Œåœ¨çº¦æŸ$g(x) \leq 0$ä¸‹æœ€å°åŒ–$f(x)$çš„ä»»åŠ¡ï¼Œå¯ä»¥è½¬åŒ–ä¸ºåœ¨å¦‚ä¸‹çº¦æŸä¸‹æœ€å°åŒ–$L(x,\lambda) = f(x) + \lambda g(x)$çš„ä»»åŠ¡ï¼š$$\begin{cases}g(x) \leq 0\ \lambda \geq 0\ \lambda_j g_j(x) = 0\end{cases} \tag{10}$$ å¼(2.10)å°±æ˜¯å¤§åé¼Žé¼Žçš„Karush-Kuhn-Tuckerï¼ˆç®€ç§°KKTï¼‰æ¡ä»¶ã€‚å¤šä¸ªçº¦æŸæ¡ä»¶çš„ä¼˜åŒ–é—®é¢˜ åœ¨å¯¹ç­‰å¼çº¦æŸä¼˜åŒ–é—®é¢˜å’Œä¸ç­‰å¼çº¦æŸä¼˜åŒ–é—®é¢˜è¿›è¡Œè®²è§£åŽï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æŽ¨å¹¿åˆ°å¤šä¸ªçº¦æŸã€‚è€ƒè™‘å…·æœ‰$m$ä¸ªç­‰å¼çº¦æŸå’Œ$n$ä¸ªä¸ç­‰å¼çº¦æŸï¼Œä¸”å¯è¡ŒåŸŸ$D \subset R^d$éžç©ºçš„ä¼˜åŒ–é—®é¢˜$$min_x \ f(x),\ \ s.t. \ h_i(x)=0 \ (i = 1,â€¦,m), \ g_j(x) \leq 0 \ (j = 1,â€¦,m) \tag{11}$$å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­$\lambda = (\lambda_1, \lambda_2, â€¦, \lambda_m)^T$å’Œ$\mu = (\mu_1,\mu_2,â€¦,\mu_n)^T$ï¼Œç›¸åº”çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸º$$L(x,\lambda, \mu) = f(x) + \sum_{i=1}^m \lambda_i h_i(x) +\sum_{j=1}^n \mu_j g_j(x) \tag{12}$$ç”±ä¸ç­‰å¼çº¦æŸå¼•å…¥çš„KKTæ¡ä»¶(j=1,2,â€¦,n)ä¸º$$\begin{cases}g_j(x) \leq 0\ \mu_j \geq 0\ \mu_j g_j(x) = 0\end{cases} \tag{13}$$ å¯¹å¶é—®é¢˜å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œä¸€ä¸ªä¼˜åŒ–é—®é¢˜å¯ä»¥ä»Žä¸¤ä¸ªè§’åº¦æ¥è€ƒè™‘ï¼Œå³ä¸»é—®é¢˜(primal problem)å’Œå¯¹å¶é—®é¢˜(dual problem)ã€‚åœ¨çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ä¸­ï¼Œå¸¸å¸¸åˆ©ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§å°†åŽŸå§‹é—®é¢˜ï¼ˆä¸»é—®é¢˜ï¼‰è½¬æ¢æˆå¯¹å¶é—®é¢˜ï¼Œé€šè¿‡è§£å¯¹å¶é—®é¢˜æ¥å¾—åˆ°åŽŸå§‹é—®é¢˜çš„è§£ã€‚è¿™æ ·åšæ˜¯å› ä¸ºå¯¹å¶é—®é¢˜çš„å¤æ‚åº¦å¾€å¾€ä½ŽäºŽä¸»é—®é¢˜ã€‚ å¤šçº¦æŸå¯¹å¶é—®é¢˜å¤šçº¦æŸå¯¹å¶é—®é¢˜çš„é€šç”¨è§£ å¤šçº¦æŸå¯¹å¶é—®é¢˜çš„ä¸»é—®é¢˜:$$min_x \ f(x),\ \ s.t. \ h_i(x)=0 \ (i = 1,â€¦,m), \ g_j(x) \leq 0 \ (j = 1,â€¦,m) \tag{11}$$å…¶ç›¸åº”çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸º$$L(x,\lambda, \mu) = f(x) + \sum_{i=1}^m \lambda_i h_i(x) +\sum_{j=1}^n \mu_j g_j(x) \tag{12}$$ åŸºäºŽ(12)ï¼Œå¯¹ä¸»é—®é¢˜(11)çš„æ‹‰æ ¼æœ—æ—¥å¯¹å¶å‡½æ•°$\Gamma: R^m \cdot R^n \rightarrow R$å®šä¹‰ä¸º$$\Gamma(\lambda,\mu) = inf_{x \in D} L(x,\lambda,\mu) = inf_{x \in D} (f(x) + \sum_{i=1}^m \lambda_i h_i(x) +\sum_{j=1}^n \mu_j g_j(x)) \tag{13}$$è‹¥$\tilde{x} \in D$ä¸ºä¸»é—®é¢˜(11)å¯è¡ŒåŸŸä¸­çš„ç‚¹ï¼Œåˆ™å¯¹ä»»æ„$\mu \geq 0$å’Œ$\lambda$éƒ½æœ‰$$\sum_{i=1}^m \lambda_i h_i(x) + \sum_{j=1}^n \mu_j g_j(x) \leq 0 \tag{14}$$è¿›è€Œæœ‰$$\Gamma(\lambda,\mu) = inf_{x \in D} L(x,\lambda,\mu) \leq L(\tilde{x},\lambda,\mu) \leq f(\tilde{x}) \tag{15}$$ è‹¥ä¸»é—®é¢˜(2.11)çš„æœ€ä¼˜å€¼ä¸º$p^$ï¼Œåˆ™å¯¹ä»»æ„$\mu \geq 0$å’Œ$\lambda$éƒ½æœ‰$$\Gamma(\lambda,\mu) \leq p^ \tag{3.4}$$å³å¯¹å¶å‡½æ•°ç»™å‡ºäº†ä¸»é—®é¢˜æœ€ä¼˜å€¼çš„ä¸‹ç•Œã€‚æ˜¾ç„¶ï¼Œè¿™ä¸ªä¸‹ç•Œå–å†³äºŽ$\mu$å’Œ$\lambda$çš„å€¼ã€‚äºŽæ˜¯ä¸€ä¸ªå¾ˆè‡ªç„¶çš„é—®é¢˜å°±æ˜¯ï¼šåŸºäºŽå¯¹å¶å‡½æ•°èƒ½èŽ·å¾—çš„æœ€å¥½ä¸‹ç•Œæ˜¯ä»€ä¹ˆï¼Ÿè¿™å°±å¼•å‡ºäº†ä¼˜åŒ–é—®é¢˜$$max_{\lambda, \mu} \Gamma(\lambda, \mu) \ \ s.t. \mu \geq 0 \tag{16}$$ å¼(16)å°±æ˜¯ä¸»é—®é¢˜ï¼ˆ11ï¼‰çš„å¯¹å¶é—®é¢˜ï¼Œå…¶ä¸­$\mu$å’Œ$\lambda$ç§°ä¸ºå¯¹å¶å˜é‡ï¼ˆdual variableï¼‰ã€‚æ— è®ºä¸»é—®é¢˜ï¼ˆ11ï¼‰çš„å‡¸æ€§å¦‚ä½•ï¼Œå¯¹å¶é—®é¢˜ï¼ˆ16ï¼‰å§‹ç»ˆæ˜¯å‡¸ä¼˜åŒ–é—®é¢˜ã€‚ è€ƒè™‘å¼(16)çš„æœ€ä¼˜å€¼$d^$ï¼Œæ˜¾ç„¶æœ‰$d^ \leq p^*$ï¼Œè¿™ç§°ä¸ºâ€œå¼±å¯¹å¶æ€§(weak duality)â€æˆç«‹ï¼› è‹¥$d^ = p^$ï¼Œåˆ™ç§°ä¸ºâ€œå¼ºå¯¹å¶æ€§ï¼ˆstrong dualityï¼‰â€æˆç«‹ï¼Œæ­¤æ—¶ç”±å¯¹å¶é—®é¢˜èƒ½èŽ·å¾—ä¸»é—®é¢˜çš„æœ€ä¼˜ä¸‹ç•Œï¼› å¯¹äºŽä¸€èˆ¬çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¼ºå¯¹å¶æ€§é€šå¸¸ä¸æˆç«‹ï¼Œä½†æ˜¯è‹¥ä¸»é—®é¢˜æ˜¯å‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå¦‚å¼(11)ä¸­$f(x)$å’Œ$g_j(x)$å‡ä¸ºå‡¸å‡½æ•°ï¼Œ$h_i(x)$ä¸ºä»¿å°„å‡½æ•°ï¼Œä¸”å…¶å¯è¡ŒåŸŸä¸­è‡³å°‘æœ‰ä¸€ç‚¹ä½¿ä¸ç­‰å¼çº¦æŸä¸¥æ ¼æˆç«‹ï¼Œåˆ™æ­¤æ—¶å¼ºå¯¹å¶æ€§æˆç«‹ã€‚ P.S. åœ¨å¼ºå¯¹å¶æ€§æˆç«‹æ—¶ï¼Œå°†æ‹‰æ ¼æœ—æ—¥å‡½æ•°åˆ†åˆ«å¯¹å…ƒå˜é‡å’Œå¯¹å¶å˜é‡æ±‚å¯¼ï¼Œå†åŒæ—¶ä»¤å¯¼æ•°ç­‰äºŽ0ï¼Œå³å¯å¾—åˆ°åŽŸå˜é‡ä¸Žå¯¹å¶å˜é‡çš„æ•°å€¼å…³ç³»ã€‚äºŽæ˜¯å¯¹å¶é—®é¢˜è§£å†³äº†ï¼Œä¸»é—®é¢˜ä¹Ÿå°±è§£å†³äº†ã€‚ å‚è€ƒèµ„æ–™ ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æŽèˆª è‘— æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾]]></content>
      <categories>
        <category>machine_leanring</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[logistic regression]]></title>
    <url>%2F2018%2F04%2F23%2Flogistic-regression%2F</url>
    <content type="text"><![CDATA[1 é€»è¾‘æ–¯è’‚åˆ†å¸ƒ(logistic distribution)å®šä¹‰ï¼šè®¾Xæ˜¯è¿žç»­éšæœºå˜é‡ï¼ŒXæœä»Žlogisticåˆ†å¸ƒæ˜¯æŒ‡Xå…·æœ‰ä¸‹åˆ—åˆ†å¸ƒå‡½æ•°å’Œå¯†åº¦å‡½æ•°ï¼š $$ F = P(X \leq x)=\frac{1}{1+exp(-\frac{(x-\mu)}{\gamma})} $$$$ f= Fâ€™(x) = \frac{exp(-\frac{(x-\mu)}{\gamma})}{\gamma[1+exp(-\frac{(x-\mu)}{\gamma})]^2} $$å¼ä¸­ï¼Œ$\mu$ä¸ºä½ç½®å‚æ•°ï¼Œ$\gamma &gt; 0$ä¸ºå½¢çŠ¶å‚æ•°ã€‚ å…¶åˆ†å¸ƒå›¾å½¢å¦‚ä¸‹ï¼š Fæ›²çº¿åœ¨ä¸­å¿ƒé™„è¿‘å¢žé•¿é€Ÿåº¦è¾ƒå¿«ï¼Œåœ¨ä¸¤ç«¯å¢žé•¿é€Ÿåº¦è¾ƒæ…¢ã€‚å½¢çŠ¶å‚æ•°$\gamma$å€¼è¶Šå°ï¼Œæ›²çº¿åœ¨ä¸­å¿ƒé™„è¿‘å¢žé•¿å¾—è¶Šå¿«ã€‚ 2 äºŒé¡¹é€»è¾‘æ–¯è’‚å›žå½’æ¨¡åž‹å®šä¹‰ï¼šäºŒé¡¹é€»è¾‘æ–¯è’‚å›žå½’æ¨¡åž‹æ˜¯å¦‚ä¸‹çš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒ$$P(y=1\mid x) = \frac{\exp(\omega^\top x+b)}{1 + \exp(\omega^\top x+b)} \tag{1}$$$$P(y=0\mid x) = \frac{1}{1 + \exp(\omega^\top x+b)} \tag{2}$$è¿™é‡Œï¼Œ$x\in R^n$æ˜¯è¾“å…¥ï¼Œ$y\in {0,1 }$æ˜¯è¾“å‡ºï¼Œ$\omega \in R^n$å’Œ$b\in R$æ˜¯å‚æ•°ï¼Œ$\omega$ç§°ä¸ºæƒå€¼å‘é‡ï¼Œ$b$ç§°ä¸ºåç½®ï¼Œ$\omega^\top x$ä¸º$w$å’Œ$x$çš„å†…ç§¯ã€‚ å¯¹äºŽç»™å®šçš„è¾“å…¥å®žä¾‹$x$ï¼ŒæŒ‰ç…§(1)å¼å’Œ(2)å¼å¯ä»¥åˆ†åˆ«æ±‚å¾—$P(y=1\mid x)$å’Œ$P(y=0\mid x)$ã€‚é€»è¾‘æ–¯è’‚å›žå½’æ¯”è¾ƒè¿™ä¸¤ä¸ªæ¡ä»¶æ¦‚çŽ‡å€¼çš„å¤§å°ï¼Œå°†å®žä¾‹$x$åˆ†åˆ°æ¦‚çŽ‡å€¼è¾ƒå¤§çš„é‚£ä¸€ç±»ã€‚ å®šä¹‰ï¼šä¸€ä¸ªäº‹ä»¶çš„å‡ çŽ‡(odds)æ˜¯æŒ‡è¯¥äº‹ä»¶å‘ç”Ÿçš„æ¦‚çŽ‡ä¸Žè¯¥äº‹ä»¶ä¸å‘ç”Ÿçš„æ¦‚çŽ‡çš„æ¯”å€¼ã€‚å¦‚æžœäº‹ä»¶å‘ç”Ÿçš„æ¦‚çŽ‡ä¸º$p$ï¼Œé‚£ä¹ˆè¯¥äº‹ä»¶çš„å‡ çŽ‡æ˜¯$\frac{p}{1-p}$ï¼Œè¯¥äº‹ä»¶çš„å¯¹æ•°å‡ çŽ‡(log odds)æˆ–è€…logitå‡½æ•°æ˜¯$$logit(p)=log\frac{p}{1-p}$$å¯¹äºŽé€»è¾‘æ–¯è’‚å›žå½’è€Œè¨€ï¼Œç”±(1),(2)å¼å¾—$$log\frac{P(y=1\mid x)}{1-P(y=1\mid x)}=\omega^\top x+b$$ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨é€»è¾‘æ–¯è’‚å›žå½’æ¨¡åž‹ä¸­ï¼Œè¾“å‡º$y=1$çš„å¯¹æ•°å‡ çŽ‡æ˜¯ç”±è¾“å…¥$x$çš„çº¿æ€§å‡½æ•°è¡¨ç¤ºçš„æ¨¡åž‹ã€‚ 3 æ¨¡åž‹å‚æ•°ä¼°è®¡å¯¹äºŽç»™å®šçš„è®­ç»ƒæ•°æ®é›†$T={(x_1,y_1),(x_2,y_2),â€¦,(x_N,y_N)}$ï¼Œå…¶ä¸­$x_i\in R^n$ï¼Œ$y_i\in {0,1 }$ï¼Œå¯ä»¥åº”ç”¨æžå¤§ä¼¼ç„¶ä¼°è®¡æ³•ä¼°è®¡æ¨¡åž‹å‚æ•°ï¼Œä»Žè€Œå¾—åˆ°é€»è¾‘æ–¯è’‚å›žå½’æ¨¡åž‹ã€‚ è®¾ï¼š$P(y=1\mid x)=\pi(x)$ï¼Œ$P(y=0\mid x)=1-\pi(x)$åˆ™ä¼¼ç„¶å‡½æ•°ä¸ºï¼š$$\prod_{i=1}^N [\pi(x_i)]^{y_i}[1-\pi(x_i)]^{1-y_i}$$å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºï¼š$$\begin{aligned}L(\omega,b)&amp;=\sum_{i=1}^N [y_i\ln(\pi(x_i))+(1-y_i)\ln(1-\pi(x_i))] \&amp;= \sum_{i=1}^N [y_i\ln\frac{\pi(x_i)}{1-\pi(x_i)}+\ln(1-\pi(x_i))] \&amp;=\sum_{i=1}^N \left [ y_i(\omega^\top x+b) -\ln \left ( 1+ exp(\omega^\top x+b) \right )\right ]\end{aligned}$$è¿™æ ·ï¼Œé—®é¢˜å°±å˜æˆäº†ä»¥å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºç›®æ ‡å‡½æ•°çš„æœ€ä¼˜åŒ–é—®é¢˜ï¼Œé€»è¾‘æ–¯è’‚å›žå½’å­¦ä¹ ä¸­é€šå¸¸é‡‡ç”¨çš„æ–¹æ³•æ˜¯æ¢¯åº¦ä¸‹é™æ³•åŠç‰›é¡¿æ³•ã€‚ 4 æ¢¯åº¦ä¸‹é™(ä¸Šå‡)æ³•æ±‚è§£åˆ©ç”¨æ¢¯åº¦ä¸‹é™(ä¸Šå‡)æ±‚è§£å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š$L(\omega,b)$å› ä¸ºè¦ä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¢¯åº¦ä¸Šå‡æ³•ã€‚ä¸ºäº†è®¡ç®—æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°†æƒå€¼å‘é‡å’Œè¾“å…¥å‘é‡åŠ ä»¥æ‰©å……ï¼Œä»è®°ä½œ$\omega,x$ï¼Œå³$$\omega=(\omega^{(1)},\omega^{(2)},â€¦,\omega^{(n)},b),\;x=(x^{(1)},x^{(2)},â€¦,x^{(n)},1)$$ æ¢¯åº¦ä¸Šå‡æ±‚è§£:è¿™æ—¶$$\omega_{new}^\top x_{new}=\omega_{old}^\top x_{old}+b_{old}$$æˆ‘ä»¬ä»¤ï¼š$$z=\omega^\top x; z_i=\omega^\top x_i;z_i^{(k)}=\omega_k^\top x_i$$$$\pi(z) = \frac{exp(z)}{1+exp(z)}= \frac{1}{1+exp(-z)} $$ äºŽæ˜¯æœ‰$$l(\omega)=\sum_{i=1}^N \left [ y_i(\omega^\top x) -\ln \left ( 1+ exp(\omega^\top x) \right )\right ]$$å…ˆæ±‚å„ä¸ªåå¯¼æ•°ï¼š$$\begin{aligned}\frac{\partial l(\omega)}{\partial \omega^{(j)}}&amp;=\frac{\partial }{\partial \omega^{(j)}}\left ( \sum_{i=1}^N \left [ y_i(\omega^\top x) -\ln \left ( 1+ exp(\omega^\top x) \right )\right ]\right ) \ &amp;= \sum_{i=1}^N \left [ y_i x_i^{(j)} - \frac{exp(w^\top x_i)}{1+exp(w^\top x_i)} x_i^{(j)}\right ] \ &amp;= \sum_{i=1}^N \left ( y_i - \frac{exp(w^\top x_i)}{1+exp(w^\top x_i)} \right ) x_i^{(j)} \ &amp;= \sum_{i=1}^N ( y_i - \pi(z_i) ) x_i^{(j)}\end{aligned}$$ å¾—åˆ°å‚æ•°çš„è¿­ä»£å…¬å¼ï¼š$$\omega_{k+1}^{(j)} = \omega_{k}^{(j)} +\lambda_k \cdot (-\sum_{i=1}^N ( y_i - \pi(z_i^{(k)}) ) ) x_i^{(j)} $$ä»¤$$s^{(k)}=(s_1^{(k)},s_2^{(k)},â€¦,s_N^{(k)}),s_i^{(k)}= y_i - \pi_k(z_i^{(k)}) $$åˆ™$$\begin{aligned}\triangledown l(\omega_{k}) &amp;= ( \frac{\partial l(\omega_{k})}{\partial \omega_{k}^{(0)}}, \frac{\partial l(\omega_{k})}{\partial \omega_{k}^{(1)}},â€¦, \frac{\partial l(\omega_{k})}{\partial \omega_{k}^{(n)}} ) \ &amp;= [\sum_{i=1}^N ( y_i - \pi(z_i^{(k)}) ) x_i^{(j)}],j=0,1,â€¦,n \&amp;=[\sum_{i=1}^N s_i^{(k)} x_i^{(j)}] \&amp;=s^{(k)}\cdot x\\end{aligned}$$ æ³¨æ„æ¢¯åº¦ä¸Šå‡ä¸ºæ­£æ¢¯åº¦æ–¹å‘,å³ $ P^{(k)} = \triangledown l(\omega_{k})$å³æœ‰ï¼š $$\omega_{k+1} = \omega_{k} +\lambda_k P^{(k)} = \omega_{k} +\lambda_k \cdot (s^{(k)}\cdot x) $$ æ±‚è§£ä¸€ç»´æœç´¢$$l(\omega_{k}+\lambda_k P^{(k)})=\max_{\lambda \geqslant 0}l(\omega_{k}+\lambda \cdot P^{(k)})$$ å¾— $$\lambda_k=\frac{ - \triangledown l(\omega_{k})^\top \triangledown l(\omega_{k}) }{\triangledown l(\omega_{k})^\top H(\omega_{k}) \triangledown l(\omega_{k})} $$ å…¶ä¸­ $$H(\omega_{k})=\begin{bmatrix}\frac{\partial^2 l(\omega_{k})}{\partial \omega_{k}^{(p)}\partial \omega_{k}^{(q)}}\end{bmatrix} ;p,q \in {0,1,2,..,n}$$ $$\frac{\partial^2 l(\omega_{k})}{\partial \omega_{k}^{(p)}\partial \omega_{k}^{(q)}} = \sum_{i=1}^N \piâ€™(\omega_k x_i) ( x_i^{(p)} x_i^{(q)}) $$ $$\piâ€™(z) = \frac{exp(-z)}{(1+exp(-z))^2}=\pi(z)(1-\pi(z))$$ 5 æ¨¡åž‹çš„ä¼˜ç¼ºç‚¹ç¼ºç‚¹ï¼š é€»è¾‘å›žå½’éœ€è¦å¤§æ ·æœ¬é‡ï¼Œå› ä¸ºæœ€å¤§ä¼¼ç„¶ä¼°è®¡åœ¨ä½Žæ ·æœ¬é‡çš„æƒ…å†µä¸‹ä¸å¦‚æœ€å°äºŒä¹˜æ³•æœ‰æ•ˆã€‚ ä¸ºé˜²æ­¢è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆï¼Œåº”è¯¥è®©æ¨¡åž‹æž„å»ºçš„å˜é‡æ˜¯æ˜¾è‘—çš„ã€‚ å¯¹æ¨¡åž‹ä¸­è‡ªå˜é‡å¤šé‡å…±çº¿æ€§è¾ƒä¸ºæ•æ„Ÿï¼Œéœ€è¦å¯¹è‡ªå˜é‡è¿›è¡Œç›¸å…³æ€§åˆ†æžï¼Œå‰”é™¤çº¿æ€§ç›¸å…³çš„å˜é‡ã€‚ ä¼˜ç‚¹ï¼šæ¨¡åž‹æ›´ç®€å•ï¼Œå¥½ç†è§£ï¼Œå®žçŽ°èµ·æ¥ï¼Œç‰¹åˆ«æ˜¯å¤§è§„æ¨¡çº¿æ€§åˆ†ç±»æ—¶æ¯”è¾ƒæ–¹ä¾¿ 6 æ¨¡åž‹å®žçŽ°è§æˆ‘GitHubã€‚ 7 æœ€åŽåœ¨å†™çš„è¿‡ç¨‹ä¸­æ‰å‘çŽ°ï¼Œæ²¡å†™ä¸€æ¬¡éƒ½è¦èŠ±æŒºé•¿çš„æ—¶é—´åŽ»ç†è§£ä»¥åŠä½¿ç”¨markdownç ä¸Šæ•°å­¦å…¬å¼ï¼Œä½†æ˜¯è¿™éƒ½å¾ˆå¤§çš„ä¿ƒè¿›äº†æˆ‘å¯¹åŽŸç†çš„ç†è§£ï¼ å‚è€ƒèµ„æ–™ ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æŽèˆª è‘— æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾ã€Šæœºå™¨å­¦ä¹ å®žæˆ˜ã€‹Peter Harrington è‘— äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ã€Šè¿ç­¹å­¦ã€‹ç¬¬å››ç‰ˆ æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[my kmeans]]></title>
    <url>%2F2018%2F04%2F15%2Fmy-kmeans%2F</url>
    <content type="text"></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¢¯åº¦ä¸‹é™æ³•]]></title>
    <url>%2F2018%2F04%2F02%2F%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95%2F</url>
    <content type="text"><![CDATA[æ¢¯åº¦ä¸‹é™æ³•åŽŸç†&amp;#8195&amp;#8195æ¢¯åº¦ä¸‹é™æ³•æ˜¯æ±‚è§£æ— çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜çš„ä¸€ç§æœ€å¸¸ç”¨çš„è¿­ä»£æ³•ã€‚é¡¾åæ€ä¹‰ï¼Œæ¢¯åº¦ä¸‹é™æ³•çš„è®¡ç®—è¿‡ç¨‹å°±æ˜¯æ²¿æ¢¯åº¦ä¸‹é™çš„æ–¹å‘æ±‚è§£æžå°å€¼ï¼ˆä¹Ÿå¯ä»¥æ²¿æ¢¯åº¦ä¸Šå‡æ–¹å‘æ±‚è§£æžå¤§å€¼ï¼‰ã€‚ &amp;#8195&amp;#8195å‡è®¾$f(x)$æ˜¯$R^n$ä¸Šå…·æœ‰ä¸€é˜¶è¿žç»­åå¯¼æ•°çš„å‡½æ•°ï¼Œè¦æ±‚è§£çš„æ— çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜æ˜¯$$\min_{x\in R^n} f(x)$$$x^*$è¡¨ç¤ºç›®æ ‡å‡½æ•°çš„æžå°å€¼ç‚¹ã€‚ é€‰å–é€‚å½“çš„åˆå€¼$x^{(0)}$ï¼Œä¸æ–­è¿­ä»£ï¼Œæ›´æ–°$x$çš„å€¼ï¼Œè¿›è¡Œç›®æ ‡å‡½æ•°çš„æžå°åŒ–ï¼Œç›´åˆ°æ”¶æ•›ã€‚ç”±äºŽè´Ÿæ¢¯åº¦æ–¹å‘æ˜¯ä½¿å‡½æ•°å€¼ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼Œåœ¨è¿­ä»£çš„æ¯ä¸€æ­¥ï¼Œä»¥è´Ÿæ¢¯åº¦æ–¹å‘æ›´æ–°$x$çš„å€¼ï¼Œä»Žè€Œè¾¾åˆ°å‡å°‘å‡½æ•°å€¼çš„ç›®çš„ã€‚ &amp;#8195&amp;#8195ç”±äºŽ$f(x)$å…·æœ‰ä¸€é˜¶è¿žç»­åå¯¼æ•°ï¼Œè‹¥ç¬¬kæ¬¡è¿­ä»£å€¼ä¸º$x^{(k)}$ï¼Œåˆ™å¯å°†$f(x)$åœ¨$x^{(k)}$é™„è¿‘è¿›è¡Œä¸€é˜¶æ³°å‹’å±•å¼€ï¼š$$f(x)=f(x^{(k)})+g_k^ \top \cdot(x-x^{(k)})$$å…¶ä¸­$g_k =g(x^{(k)})= -\triangledown f(x^{(k)}) $ä¸º$f(x)$åœ¨$x^{(k)}$çš„æ¢¯åº¦(æ¢¯åº¦ä¸Šå‡ä¸ºæ­£å·)ã€‚&amp;#8195&amp;#8195æ±‚å‡ºç¬¬k+1æ¬¡è¿­ä»£å€¼$x^{(k+1)}$:$$x^{(k+1)}\leftarrow x^{(k)}+\lambda_k P^{(k)} $$ å…¶ä¸­ï¼Œ$p^{(k)}$æ˜¯æœç´¢æ–¹å‘ï¼Œå–è´Ÿæ¢¯åº¦æ–¹å‘$P^{(k)}=-\triangledown f(x^{(k)}) $ï¼Œ$\lambda_k$æ˜¯æ­¥é•¿ï¼Œç”±ä¸€ç»´æœç´¢ç¡®å®šï¼Œå³$\lambda_k$ä½¿å¾—$$f(x^{(k)}+\lambda_k P^{(k)})=\min_{\lambda \geqslant 0}f(x^{(k)}+\lambda \cdot p^{(k)})$$ ä¸€ç»´æœç´¢æœ‰ä¸ªååˆ†é‡è¦çš„æ€§è´¨ï¼šåœ¨æœç´¢æ–¹å‘ä¸Šæ‰€å¾—æœ€ä¼˜ç‚¹å¤„ç›®æ ‡å‡½æ•°çš„æ¢¯åº¦å’Œè¯¥æœç´¢æ–¹å‘æ­£äº¤ã€‚å®šç†: è®¾ç›®æ ‡å‡½æ•°$f(x)$å…·æœ‰ä¸€é˜¶è¿žç»­åå¯¼æ•°ï¼Œ$x^{(k+1)}$ç”±å¦‚ä¸‹è§„åˆ™äº§ç”Ÿ$$ \left{ \begin{array}{c} \lambda_k: \min_\lambda f(x^{(k)}+\lambda P^{(k)}) \ x^{(k+1)} = x^{(k)}+\lambda_k P^{(k)} \end{array} \right.$$&#160;åˆ™æœ‰$$-\triangledown f(x^{(k+1)}) P^{(k)}=0 \tag{1}$$è¯æ˜Ž: æž„é€ å‡½æ•°$\varphi(\lambda)=f(x^{(k)}+\lambda P^{(k)})$ï¼Œåˆ™å¾—$$ \left{ \begin{array}{c} \varphi(\lambda_k)= \min_\lambda \varphi(\lambda) \ x^{(k+1)} = x^{(k)}+\lambda_k P^{(k)} \end{array} \right.$$å³$\lambda_k$ä¸º$\varphi(\lambda)$çš„æžå°å€¼ç‚¹ã€‚æ­¤å¤–$\varphiâ€™(\lambda)=\triangledown f(x^{(k)}+\lambda P^{(k)})^\top P^{(k)}$ã€‚ç”±$\varphiâ€™(\lambda)|_{\lambda=\lambda_k}=0$å¯å¾—$$\triangledown f(x^{(k)}+\lambda_k P^{(k)})^\top P^{(k)}=\triangledown f(x^{(k+1)})^\top P^{(k)}=0$$å®šç†å¾—è¯ã€‚ ä¸ºä»€ä¹ˆ$P^{(k)}=-\triangledown f(x^{(k)})$?&amp;#8195&amp;#8195å› ä¸ºå¯¹äºŽå……åˆ†å°çš„$\lambda$ï¼Œåªè¦$$f(x^{(k)})^\top P^{(k)}&lt;0 \tag{2}$$å°±å¯ä»¥ä¿è¯$$f(x^{(k)}+\lambda_k P^{(k)})&lt;f(x^{(k)}) \tag{3}$$&amp;#8195&amp;#8195çŽ°åœ¨è€ƒå¯Ÿä¸åŒçš„$P^{(k)}$ã€‚å‡å®š$P^{(k)}$çš„æ¨¡ä¸€å®š(ä¸”ä¸ä¸ºé›¶)ï¼Œå¹¶è®¾$\triangledown f(x^{(k)})$(å¦åˆ™ï¼Œ$x^{(k)}$æ˜¯å¹³ç¨³ç‚¹)ï¼Œä½¿å¾—(2)å¼æˆç«‹çš„$P^{(k)}$æœ‰æ— é™å¤šä¸ªï¼Œä¸ºäº†ä½¿ç›®æ ‡å‡½æ•°æ•°å€¼èƒ½å¾—åˆ°å°½é‡å¤§çš„æ”¹å–„ï¼Œå¿…é¡»å¯»æ±‚ä½¿$f(x^{(k)})^\top P^{(k)} $å–æœ€å°å€¼çš„$P^{(k)}$ï¼Œå› ä¸ºæœ‰$$f(x^{(k)})^\top P^{(k)}=|f(x^{(k)})| \cdot |P^{(k)}| \cdot \cos\theta$$å¼ä¸­$\theta$ä¸º$f(x^{(k)})$å’Œ$P^{(k)}$çš„å¤¹è§’ã€‚å½“$P^{(k)}$ä¸Ž$f(x^{(k)})$åå‘æ—¶ï¼Œ$\theta=180Â°,\cos\theta=-1$ã€‚è¿™æ—¶å¼(2)æˆç«‹ï¼Œä¸”å…¶å·¦ç«¯å–å¾—æœ€å°å€¼ã€‚ ä¸€ç»´æœç´¢&amp;#8195&amp;#8195ä¸ºäº†å¾—åˆ°ä¸‹ä¸€ä¸ªè¿‘ä¼¼æžå°å€¼ç‚¹ï¼Œåœ¨é€‰å®šäº†æœç´¢æ–¹å‘ä¹‹åŽï¼Œè¿˜è¦ç¡®å®šæ­¥é•¿$\lambda$ã€‚å½“é‡‡ç”¨å¯æŽ¥å—ç‚¹ç®—æ³•æ—¶ï¼Œå°±æ˜¯å–æŸä¸€$\lambda$è¿›è¡Œè¯•ç®—ï¼Œçœ‹æ˜¯å¦æ»¡è¶³ä¸ç­‰å¼(3)ï¼Œè‹¥ä¸Šè¿°ä¸ç­‰å¼æˆç«‹ï¼Œå°±å¯ä»¥è¿­ä»£ä¸‹åŽ»ã€‚å¦åˆ™ç¼©å°$\lambda$ä½¿å¾—å…¶æ»¡è¶³ä¸ç­‰å¼(3)ã€‚&amp;#8195&amp;#8195å¦ä¸€ç§æ–¹æ³•å°±æ˜¯åœ¨è´Ÿæ¢¯åº¦æ–¹å‘çš„ä¸€ç»´æœç´¢ï¼Œæ¥ç¡®å®šä½¿$f(x^{(k)})$æœ€å°çš„$\lambda_k$ã€‚æœ€å¸¸ç”¨çš„æœ‰è¯•æŽ¢æ³•(æ–æ³¢æ‹‰å¥‘ï¼Œ0.618æ³•)ï¼Œæ’å€¼æ³•(æŠ›ç‰©çº¿æ’å€¼ï¼Œä¸‰æ¬¡æ’å€¼)ï¼Œå¾®ç§¯åˆ†ä¸­çš„æ±‚æ ¹æ³•(åˆ‡çº¿æ³•ã€äºŒåˆ†æ³•ç­‰)ç­‰ã€‚ &amp;#8195&amp;#8195è‹¥$f(x)$å…·æœ‰äºŒé˜¶è¿žç»­åå¯¼æ•°ï¼Œåœ¨$x^{(k)}$ä½œ$f(x^{(k)}-\lambda \triangledown f(x^{(k)}) )$çš„æ³°å‹’å±•å¼€ï¼š$$f(x^{(k)}-\lambda \triangledown f(x^{(k)})) \approx f(x^{(k)}) -\triangledown f(x^{(k)})^\top \lambda \triangledown f(x^{(k)}) + \frac{1}{2}\lambda \triangledown f(x^{(k)})^\top H(x^{(k)}) \lambda \triangledown f(x^{(k)})$$å¯¹$\lambda$æ±‚å¯¼å¹¶ä¸”ä»¤å…¶ç­‰äºŽé›¶ï¼Œåˆ™å¾—è¿‘ä¼¼æœ€ä½³æ­¥é•¿$$\lambda_k=\frac{ \triangledown f(x^{(k)})^\top \triangledown f(x^{(k)}) }{\triangledown f(x^{(k)})^\top H(x^{(k)}) \triangledown f(x^{(k)})} \tag{4}$$å…¶ä¸­$$H(x^{(k)})=\begin{bmatrix}\frac{\partial^2 f(x^{(k)}))}{\partial x_1^2} &amp; \frac{\partial^2 f(x^{(k)}))}{\partial x_1 \partial x_2} &amp; â€¦ &amp;\frac{\partial^2 f(x^{(k)}))}{\partial x_1 \partial x_n} \\frac{\partial^2 f(x^{(k)}))}{\partial x_2 \partial x_1} &amp; \frac{\partial^2 f(x^{(k)}))}{\partial x_2^2} &amp; â€¦&amp;\frac{\partial^2 f(x^{(k)}))}{\partial x_2 \partial x_n} \â€¦&amp;&amp;&amp; \\frac{\partial^2 f(x^{(k)}))}{\partial x_n \partial x_1} &amp; \frac{\partial^2 f(x^{(k)}))}{\partial x_n \partial x_2} &amp; â€¦&amp;\frac{\partial^2 f(x^{(k)}))}{\partial x_n^2} \\end{bmatrix}$$ä¸º$f(x)$åœ¨ç‚¹$x^{(k)}$å¤„çš„æµ·èµ›(Hesse)çŸ©é˜µã€‚å¯è§è¿‘ä¼¼æœ€ä½³æ­¥é•¿ä¸åªä¸Žæ¢¯åº¦æœ‰å…³ï¼Œè¿˜ä¸Žæµ·èµ›çŸ©é˜µHä¹Ÿæœ‰å…³ç³»ï¼Œè®¡ç®—èµ·æ¥æ¯”è¾ƒéº»çƒ¦ã€‚&amp;#8195&amp;#8195æœ‰æ—¶ï¼Œå°†æœç´¢æ–¹å‘$P^{(k)}$çš„æ¨¡é•¿è§„æ ¼åŒ–ä¸º1ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹$$P^{(k)}=\frac{-\triangledown f(x^{(k)})}{ |\triangledown f(x^{(k)})|}$$åŒæ—¶ï¼Œå¼(4)å˜ä¸º$$\lambda_k=\frac{ \triangledown f(x^{(k)})^\top \triangledown f(x^{(k)}) |\triangledown f(x^{(k)})| }{\triangledown f(x^{(k)})^\top H(x^{(k)}) \triangledown f(x^{(k)})} $$ å›ºå®šæ­¥é•¿æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯æ­¥é•¿aå›ºå®šæ—¶çš„å¤§å°ï¼Œå¦‚æžœaå¤ªå°ï¼Œåˆ™ä¼šè¿­ä»£å¾ˆå¤šæ¬¡æ‰æ‰¾åˆ°æœ€ä¼˜è§£ï¼Œè‹¥aå¤ªå¤§ï¼Œå¯èƒ½è·³è¿‡æœ€ä¼˜ï¼Œä»Žè€Œæ‰¾ä¸åˆ°æœ€ä¼˜è§£ã€‚ ç®—æ³•æ¢¯åº¦ä¸‹é™æ³•ç®—æ³•å¦‚ä¸‹ï¼š è¾“å…¥ï¼šç›®æ ‡å‡½æ•°$f(x)$ï¼Œæ¢¯åº¦å‡½æ•°$g(x)=-\triangledown f(x)$ï¼Œè®¡ç®—ç²¾åº¦$\varepsilon $; è¾“å‡ºï¼š$f(x)$çš„æžå°å€¼ç‚¹$x^$ã€‚(1). å–åˆå§‹å€¼$x^{(0)}\in R^n$ï¼Œç½®k=0;(2). è®¡ç®—$f(x^{(k)})$;(3). è®¡ç®—æ¢¯åº¦$g_k =g(x^{(k)})$ï¼Œå½“$\left | g_k\right | &lt; \varepsilon$æ—¶ï¼Œåœæ­¢è¿­ä»£ï¼Œä»¤$x^=x^{(k)}$ï¼›å¦åˆ™ä»¤$P^{(k)}=-g(x^{(k)})$ï¼Œæ±‚$\lambda_k$ï¼Œä½¿å¾—$$f(x^{(k)}+\lambda_k p_k)=\min_{\lambda \geqslant 0}f(x^{(k)}+\lambda \cdot P^{(k)})$$(4). ç½®$x^{(k+1)}=x^{(k)}+\lambda_k P^{(k)} $ï¼Œè®¡ç®—$f(x^{(k+1)})$ï¼Œå½“$\left | f(x^{(k+1)})-f(x^{(k)}) \right | &lt; \varepsilon$æˆ–$\left | x^{(k+1)} - x^{(k)}\right | &lt; \varepsilon$æ—¶ï¼Œåœæ­¢è¿­ä»£ï¼Œä»¤$x^*=x^{(k)}$ï¼›å¦åˆ™ç½®$k=k+1$ï¼Œè½¬(3)ã€‚ éšæœºæ¢¯åº¦ä¸‹é™åå­—ä¸­å·²ç»ä½“çŽ°äº†æ ¸å¿ƒæ€æƒ³ï¼Œå³éšæœºé€‰å–ä¸€ä¸ªç‚¹åšæ¢¯åº¦ä¸‹é™ï¼Œè€Œä¸æ˜¯éåŽ†æ‰€æœ‰æ ·æœ¬åŽè¿›è¡Œå‚æ•°è¿­ä»£ã€‚ å› ä¸ºæ¢¯åº¦ä¸‹é™æ³•çš„ä»£ä»·å‡½æ•°è®¡ç®—éœ€è¦éåŽ†æ‰€æœ‰æ ·æœ¬ï¼Œè€Œä¸”æ˜¯æ¯æ¬¡è¿­ä»£éƒ½è¦éåŽ†ï¼Œç›´è‡³è¾¾åˆ°å±€éƒ¨æœ€ä¼˜è§£ï¼Œåœ¨æ ·æœ¬é‡åºžå¤§æ—¶å°±æ˜¾å¾—æ”¶æ•›é€Ÿåº¦æ¯”è¾ƒæ…¢äº†ï¼Œè®¡ç®—é‡éžå¸¸åºžå¤§ã€‚ éšæœºæ¢¯åº¦ä¸‹é™ä»…ä»¥å½“å‰æ ·æœ¬ç‚¹è¿›è¡Œæœ€å°å€¼æ±‚è§£ï¼Œé€šå¸¸æ— æ³•è¾¾åˆ°çœŸæ­£å±€éƒ¨æœ€ä¼˜è§£ï¼Œä½†å¯ä»¥æ¯”è¾ƒæŽ¥è¿‘ã€‚å±žäºŽå¤§æ ·æœ¬å…¼é¡¾è®¡ç®—æˆæœ¬çš„æŠ˜ä¸­æ–¹æ¡ˆã€‚ æœ€åŽ&amp;#8195&amp;#8195å½“ç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°æ—¶ï¼Œæ¢¯åº¦ä¸‹é™æ³•çš„è§£æ˜¯å…¨å±€æœ€ä¼˜è§£ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…¶è§£ä¸ä¿è¯æ˜¯å…¨å±€æœ€ä¼˜è§£ã€‚æ¢¯åº¦ä¸‹é™æ³•çš„æ”¶æ•›é€Ÿåº¦ä¹Ÿæœªå¿…æ˜¯å¾ˆå¿«çš„ã€‚ å‚è€ƒèµ„æ–™ ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æŽèˆª è‘— æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾ã€Šè¿ç­¹å­¦ã€‹ç¬¬å››ç‰ˆ æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾]]></content>
      <categories>
        <category>math</category>
        <category>algorithm</category>
      </categories>
      <tags>
        <tag>math</tag>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[my decision tree id3]]></title>
    <url>%2F2018%2F03%2F27%2Fmy-decision-tree-id3%2F</url>
    <content type="text"><![CDATA[å‰è¨€ æœ¬æ–‡ä¸»è¦è®²è¿°ä¸€ä¸‹å†³ç­–æ ‘çš„åŸºæœ¬ç®—æ³•â€“ID3ç”Ÿæˆå†³ç­–æ ‘ç®—æ³•ã€‚ä¸€å¼€å§‹çœ‹ä¾‹å­çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—å†³ç­–æ ‘å¥½ç®€å•å‘€ï¼Œåº”è¯¥å®žçŽ°èµ·æ¥ç”¨pandasä¹Ÿèƒ½åƒå®žçŽ°æœ´ç´ è´å¶æ–¯ä¸€æ ·å®¹æ˜“å®žçŽ°ï¼Œå¯æ˜¯åˆ°å®žè·µçš„æ—¶å€™æ‰å‘çŽ°ï¼Œè¿™ä¸ªå®žçŽ°èµ·æ¥ä¹Ÿå¥½éš¾å•Šorzã€‚åˆšå¼€å§‹å°è¯•ç›´æŽ¥é€šè¿‡ç®—giniæŒ‡æ•°ç”¨CARTç®—æ³•ç”Ÿæˆæ ‘ï¼Œä½†å‘çŽ°å½“ä¸¤ä¸ªçš„giniæŒ‡æ•°ç›¸åŒæ—¶æˆ‘çš„ç¨‹åºå°±æ²¡æ³•æ‹©ä¼˜é€‰æ‹©äº†ã€‚ã€‚ã€‚è¿™ä¸ªè¿˜æœ‰å¾…æ”¹è¿›ã€‚ã€‚æœ€åŽå‚è€ƒäº†ä¸€ä¸‹æœºå™¨å­¦ä¹ å®žæˆ˜è¿™æœ¬ä¹¦æŠŠid3ç”Ÿæˆå’Œå¯è§†åŒ–å†³ç­–æ ‘å®žçŽ°äº†ï¼ˆä¸å¾—ä¸è¯´è¿™æœ¬ä¹¦å¯è§†åŒ–éƒ¨åˆ†å†™å¾—æˆ‘éƒ½çœ‹ä¸æ‡‚äº†ã€‚ã€‚ã€‚ï¼‰ã€‚ æ­£æ–‡å®šä¹‰åˆ†ç±»å†³ç­–æ ‘æ¨¡åž‹æ˜¯ä¸€ç§æè¿°å¯¹å®žä¾‹è¿›è¡Œåˆ†ç±»çš„æ ‘å½¢ç»“æž„ã€‚å†³ç­–æ ‘ç”±ç»“ç‚¹å’Œæœ‰å‘è¾¹ç»„æˆã€‚ç»“ç‚¹æœ‰ä¸¤ç§ç±»åž‹ï¼šå†…éƒ¨èŠ‚ç‚¹å’Œå¶èŠ‚ç‚¹ï¼Œå†…éƒ¨èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾æˆ–å±žæ€§ï¼Œå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç±»ã€‚ æ ¸å¿ƒæ€æƒ³åˆ†ç±»å†³ç­–æ ‘çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯åœ¨ä¸€ä¸ªæ•°æ®é›†ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜ç‰¹å¾ï¼Œç„¶åŽä»Žè¿™ä¸ªç‰¹å¾çš„é€‰å€¼ä¸­æ‰¾ä¸€ä¸ªæœ€ä¼˜å€™é€‰å€¼(è¿™æ®µè¯ç¨åŽè§£é‡Š)ï¼Œæ ¹æ®è¿™ä¸ªæœ€ä¼˜å€™é€‰å€¼å°†æ•°æ®é›†åˆ†ä¸ºä¸¤ä¸ªå­æ•°æ®é›†ï¼Œç„¶åŽé€’å½’ä¸Šè¿°æ“ä½œï¼Œç›´åˆ°æ»¡è¶³æŒ‡å®šæ¡ä»¶ä¸ºæ­¢ã€‚ ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ 1ï¼šç†è§£å’Œè§£é‡Šèµ·æ¥ç®€å•ï¼Œä¸”å†³ç­–æ ‘æ¨¡åž‹å¯ä»¥æƒ³è±¡2ï¼šéœ€è¦å‡†å¤‡çš„æ•°æ®é‡ä¸å¤§ï¼Œè€Œå…¶ä»–çš„æŠ€æœ¯å¾€å¾€éœ€è¦å¾ˆå¤§çš„æ•°æ®é›†ï¼Œéœ€è¦åˆ›å»ºè™šæ‹Ÿå˜é‡ï¼ŒåŽ»é™¤ä¸å®Œæ•´çš„æ•°æ®ï¼Œä½†æ˜¯è¯¥ç®—æ³•å¯¹äºŽä¸¢å¤±çš„æ•°æ®ä¸èƒ½è¿›è¡Œå‡†ç¡®çš„é¢„æµ‹3ï¼šå†³ç­–æ ‘ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦(å³é¢„æµ‹æ•°æ®)æ˜¯ç”¨äºŽè®­ç»ƒå†³ç­–æ ‘çš„æ•°æ®ç‚¹çš„å¯¹æ•°4ï¼šèƒ½å¤Ÿå¤„ç†æ•°å­—å’Œæ•°æ®çš„ç±»åˆ«ï¼ˆéœ€è¦åšç›¸åº”çš„è½¬å˜ï¼‰ï¼Œè€Œå…¶ä»–ç®—æ³•åˆ†æžçš„æ•°æ®é›†å¾€å¾€æ˜¯åªæœ‰ä¸€ç§ç±»åž‹çš„å˜é‡5ï¼šèƒ½å¤Ÿå¤„ç†å¤šè¾“å‡ºçš„é—®é¢˜6ï¼šä½¿ç”¨ç™½ç›’æ¨¡åž‹ï¼Œå¦‚æžœç»™å®šçš„æƒ…å†µæ˜¯åœ¨ä¸€ä¸ªæ¨¡åž‹ä¸­è§‚å¯Ÿåˆ°çš„ï¼Œè¯¥æ¡ä»¶çš„è§£é‡Šå¾ˆå®¹æ˜“è§£é‡Šçš„å¸ƒå°”é€»è¾‘ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨ä¸€ä¸ªé»‘ç›’å­æ¨¡åž‹ï¼ˆä¾‹å¦‚äººå·¥ç¥žç»ç½‘ç»œï¼‰ï¼Œç»“æžœå¯èƒ½æ›´éš¾ä»¥è§£é‡Š7ï¼šå¯èƒ½ä½¿ç”¨ç»Ÿè®¡æ£€éªŒæ¥éªŒè¯æ¨¡åž‹ï¼Œè¿™æ˜¯ä¸ºäº†éªŒè¯æ¨¡åž‹çš„å¯é æ€§8ï¼šä»Žæ•°æ®ç»“æžœæ¥çœ‹ï¼Œå®ƒæ‰§è¡Œçš„æ•ˆæžœå¾ˆå¥½ï¼Œè™½ç„¶å®ƒçš„å‡è®¾æœ‰ç‚¹è¿åçœŸå®žæ¨¡åž‹ ç¼ºç‚¹ 1ï¼šå†³ç­–æ ‘ç®—æ³•å­¦ä¹ è€…å¯ä»¥åˆ›å»ºå¤æ‚çš„æ ‘ï¼Œä½†æ˜¯æ²¡æœ‰æŽ¨å¹¿ä¾æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„è¿‡æ‹Ÿåˆï¼Œä¸ºäº†é¿å…è¿™ç§é—®é¢˜ï¼Œå‡ºçŽ°äº†å‰ªæžçš„æ¦‚å¿µï¼Œå³è®¾ç½®ä¸€ä¸ªå¶å­ç»“ç‚¹æ‰€éœ€è¦çš„æœ€å°æ•°ç›®æˆ–è€…è®¾ç½®æ ‘çš„æœ€å¤§æ·±åº¦2ï¼šå†³ç­–æ ‘çš„ç»“æžœå¯èƒ½æ˜¯ä¸ç¨³å®šçš„ï¼Œå› ä¸ºåœ¨æ•°æ®ä¸­ä¸€ä¸ªå¾ˆå°çš„å˜åŒ–å¯èƒ½å¯¼è‡´ç”Ÿæˆä¸€ä¸ªå®Œå…¨ä¸åŒçš„æ ‘ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ä½¿ç”¨é›†æˆå†³ç­–æ ‘æ¥è§£å†³3ï¼šä¼—æ‰€å‘¨çŸ¥ï¼Œå­¦ä¹ ä¸€æ¶æžæœ€ä¼˜å†³ç­–æ ‘çš„é—®é¢˜æ˜¯NPâ€”â€”å¾—åˆ°å‡ æ–¹é¢å®Œå…¨çš„ä¼˜è¶Šæ€§ï¼Œç”šè‡³æ˜¯ä¸€äº›ç®€å•çš„æ¦‚å¿µã€‚å› æ­¤ï¼Œå®žé™…å†³ç­–æ ‘å­¦ä¹ ç®—æ³•æ˜¯åŸºäºŽå¯å‘å¼ç®—æ³•ï¼Œå¦‚è´ªå©ªç®—æ³•ï¼Œå¯»æ±‚åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„å±€éƒ¨æœ€ä¼˜å†³ç­–ã€‚è¿™æ ·çš„ç®—æ³•ä¸èƒ½ä¿è¯è¿”å›žå…¨å±€æœ€ä¼˜å†³ç­–æ ‘ã€‚è¿™å¯ä»¥å‡è½»è®­ç»ƒå¤šæ£µæ ‘çš„åˆå¥å­¦ä¹ è€…ï¼Œåœ¨é‚£é‡Œçš„åŠŸèƒ½å’Œæ ·æœ¬éšæœºæŠ½æ ·æ›´æ¢ã€‚4ï¼šè¿™é‡Œæœ‰ä¸€äº›æ¦‚å¿µæ˜¯å¾ˆéš¾çš„ç†è§£çš„ï¼Œå› ä¸ºå†³ç­–æ ‘æœ¬èº«å¹¶ä¸éš¾å¾ˆè½»æ˜“çš„è¡¨è¾¾å®ƒä»¬ï¼Œæ¯”å¦‚è¯´å¼‚æˆ–æ ¡éªŒæˆ–å¤ç”¨çš„é—®é¢˜ã€‚5ï¼šå†³ç­–æ ‘å­¦ä¹ è€…å¾ˆå¯èƒ½åœ¨æŸäº›ç±»å ä¸»å¯¼åœ°ä½æ—¶åˆ›å»ºæœ‰æœ‰åå¼‚çš„æ ‘ï¼Œå› æ­¤å»ºè®®ç”¨å¹³è¡¡çš„æ•°æ®è®­ç»ƒå†³ç­–æ ‘â€“å½“ç„¶æœ€é‡è¦çš„è¿˜æ˜¯å®¹æ˜“è¿‡æ‹Ÿåˆï¼ï¼Œæ‰€ä»¥è¿«åˆ‡éœ€è¦å‰ªçº¸æˆ–è€…é›†æˆå­¦ä¹ ã€‚ ä¸¾ä¸ªæ —å­å„ä½ç«‹å¿—äºŽè„±å•çš„å•èº«ç”·å¥³åœ¨æ‰¾å¯¹è±¡çš„æ—¶å€™å°±å·²ç»å®Œå®Œå…¨å…¨ä½¿ç”¨äº†å†³ç­–æ ‘çš„æ€æƒ³ã€‚å‡è®¾ä¸€ä½æ¯äº²åœ¨ç»™å¥³å„¿ä»‹ç»å¯¹è±¡æ—¶ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µå¯¹è¯ï¼š æ¯äº²ï¼šç»™ä½ ä»‹ç»ä¸ªå¯¹è±¡ã€‚å¥³å„¿ï¼šå¹´çºªå¤šå¤§äº†ï¼Ÿæ¯äº²ï¼š26ã€‚å¥³å„¿ï¼šé•¿çš„å¸…ä¸å¸…ï¼Ÿæ¯äº²ï¼šæŒºå¸…çš„ã€‚å¥³å„¿ï¼šæ”¶å…¥é«˜ä¸ï¼Ÿæ¯äº²ï¼šä¸ç®—å¾ˆé«˜ï¼Œä¸­ç­‰æƒ…å†µã€‚å¥³å„¿ï¼šæ˜¯å…¬åŠ¡å‘˜ä¸ï¼Ÿæ¯äº²ï¼šæ˜¯ï¼Œåœ¨ç¨ŽåŠ¡å±€ä¸Šç­å‘¢ã€‚å¥³å„¿ï¼šé‚£å¥½ï¼Œæˆ‘åŽ»è§è§ã€‚ è¿™ä¸ªå¥³ç”Ÿçš„å†³ç­–è¿‡ç¨‹å°±æ˜¯å…¸åž‹çš„åˆ†ç±»å†³ç­–æ ‘ã€‚ç›¸å½“äºŽå¯¹å¹´é¾„ã€å¤–è²Œã€æ”¶å…¥å’Œæ˜¯å¦å…¬åŠ¡å‘˜ç­‰ç‰¹å¾å°†ç”·äººåˆ†ä¸ºä¸¤ä¸ªç±»åˆ«ï¼šè§æˆ–è€…ä¸è§ã€‚å‡è®¾è¿™ä¸ªå¥³ç”Ÿçš„å†³ç­–é€»è¾‘å¦‚ä¸‹ï¼šä¸Šå›¾å®Œæ•´è¡¨è¾¾äº†è¿™ä¸ªå¥³å­©å†³å®šæ˜¯å¦è§ä¸€ä¸ªçº¦ä¼šå¯¹è±¡çš„ç­–ç•¥ï¼Œå…¶ä¸­ç»¿è‰²ç»“ç‚¹ï¼ˆå†…éƒ¨ç»“ç‚¹ï¼‰è¡¨ç¤ºåˆ¤æ–­æ¡ä»¶ï¼Œæ©™è‰²ç»“ç‚¹ï¼ˆå¶ç»“ç‚¹ï¼‰è¡¨ç¤ºå†³ç­–ç»“æžœï¼Œç®­å¤´è¡¨ç¤ºåœ¨ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶åœ¨ä¸åŒæƒ…å†µä¸‹çš„å†³ç­–è·¯å¾„ï¼Œå›¾ä¸­çº¢è‰²ç®­å¤´è¡¨ç¤ºäº†ä¸Šé¢ä¾‹å­ä¸­å¥³å­©çš„å†³ç­–è¿‡ç¨‹ã€‚ è¿™å¹…å›¾åŸºæœ¬å¯ä»¥ç®—æ˜¯ä¸€æ£µå†³ç­–æ ‘ï¼Œè¯´å®ƒâ€œåŸºæœ¬å¯ä»¥ç®—â€æ˜¯å› ä¸ºå›¾ä¸­çš„åˆ¤å®šæ¡ä»¶æ²¡æœ‰é‡åŒ–ï¼Œå¦‚æ”¶å…¥é«˜ä¸­ä½Žç­‰ç­‰ï¼Œè¿˜ä¸èƒ½ç®—æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å†³ç­–æ ‘ï¼Œå¦‚æžœå°†æ‰€æœ‰æ¡ä»¶é‡åŒ–ï¼Œåˆ™å°±å˜æˆçœŸæ­£çš„å†³ç­–æ ‘äº†ã€‚ï¼ˆä»¥ä¸Šçš„å†³ç­–æ ‘æ¨¡åž‹çº¯å±žçžŽç¼–ä¹±é€ ï¼Œæ—¨åœ¨ç›´è§‚ç†è§£å†³ç­–æ ‘ï¼Œä¸ä»£è¡¨ä»»ä½•å¥³ç”Ÿçš„æ‹©å¶è§‚ï¼Œå„ä½å¥³åŒå¿—æ— é¡»åœ¨æ­¤æŒ‘åˆºã€‚ã€‚ã€‚ï¼‰ å†³ç­–æ ‘çš„å­¦ä¹ å†³ç­–æ ‘å­¦ä¹ ç®—æ³•åŒ…å«ç‰¹å¾é€‰æ‹©ã€å†³ç­–æ ‘çš„ç”Ÿæˆä¸Žå‰ªæžè¿‡ç¨‹ã€‚å†³ç­–æ ‘çš„å­¦ä¹ ç®—æ³•é€šå¸¸æ˜¯é€’å½’åœ°é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼Œå¹¶ç”¨æœ€ä¼˜ç‰¹å¾å¯¹æ•°æ®é›†è¿›è¡Œåˆ†å‰²ã€‚å¼€å§‹æ—¶ï¼Œæž„å»ºæ ¹ç»“ç‚¹ï¼Œé€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼Œè¯¥ç‰¹å¾æœ‰å‡ ç§å€¼å°±åˆ†å‰²ä¸ºå‡ ä¸ªå­é›†ï¼Œæ¯ä¸ªå­é›†åˆ†åˆ«é€’å½’è°ƒç”¨æ­¤æ–¹æ³•ï¼Œè¿”å›žç»“ç‚¹ï¼Œè¿”å›žçš„ç»“ç‚¹å°±æ˜¯ä¸Šä¸€å±‚çš„å­ç»“ç‚¹ã€‚ç›´åˆ°æ‰€æœ‰ç‰¹å¾éƒ½å·²ç»ç”¨å®Œï¼Œæˆ–è€…æ•°æ®é›†åªæœ‰ä¸€ç»´ç‰¹å¾ä¸ºæ­¢ã€‚ï¼ˆè¿™é‡Œå°±ä¸ä»‹ç»å…³äºŽå†³ç­–æ ‘çš„å‰ªæžè¿‡ç¨‹ï¼Œæ—¥åŽå†ä»‹ç»ï¼‰ ç‰¹å¾é€‰æ‹©ç‰¹å¾é€‰æ‹©é—®é¢˜å¸Œæœ›é€‰å–å¯¹è®­ç»ƒæ•°æ®å…·æœ‰è‰¯å¥½åˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾ï¼Œè¿™æ ·å¯ä»¥æé«˜å†³ç­–æ ‘å­¦ä¹ çš„æ•ˆçŽ‡ã€‚å¦‚æžœåˆ©ç”¨ä¸€ä¸ªç‰¹å¾è¿›è¡Œåˆ†ç±»çš„ç»“æžœä¸Žéšæœºåˆ†ç±»çš„ç»“æžœæ²¡æœ‰å¾ˆå¤§å·®åˆ«ï¼Œåˆ™ç§°è¿™ä¸ªç‰¹å¾æ˜¯æ²¡æœ‰åˆ†ç±»èƒ½åŠ›çš„ï¼ˆå¯¹è±¡æ˜¯å¦å–œæ¬¢æ‰“æ¸¸æˆåº”è¯¥ä¸ä¼šæˆä¸ºå…³é”®ç‰¹å¾å§ï¼Œä¹Ÿè®¸ä¹Ÿä¼šâ€¦â€¦ï¼‰ã€‚ä¸ºäº†è§£å†³ç‰¹å¾é€‰æ‹©é—®é¢˜ï¼Œæ‰¾å‡ºæœ€ä¼˜ç‰¹å¾ï¼Œå…ˆè¦ä»‹ç»ä¸€äº›ä¿¡æ¯è®ºé‡Œé¢çš„æ¦‚å¿µã€‚ ç†µï¼ˆentropyï¼‰ç†µæ˜¯è¡¨ç¤ºéšæœºå˜é‡ä¸ç¡®å®šæ€§çš„åº¦é‡ã€‚è®¾$X$æ˜¯ä¸€ä¸ªå–æœ‰é™ä¸ªå€¼çš„ç¦»æ•£éšæœºå˜é‡ï¼Œå…¶æ¦‚çŽ‡åˆ†å¸ƒä¸º$$P(X=x_i)=p_i, i=1,2,â€¦,n$$åˆ™éšæœºå˜é‡çš„ç†µå®šä¹‰ä¸º$$entropy(X) = -\sum_{i=1}^n P_ilog_2 P_i$$å¦å¤–ï¼Œ$0log0=0$ï¼Œå½“å¯¹æ•°çš„åº•ä¸º2æ—¶ï¼Œç†µçš„å•ä½ä¸ºbitï¼›ä¸ºeæ—¶ï¼Œå•ä½ä¸ºnatã€‚ç†µè¶Šå¤§ï¼Œéšæœºå˜é‡çš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ã€‚ä»Žå®šä¹‰å¯éªŒè¯$0&lt;=H(p)&lt;=logn$.pythonå®žçŽ°è®¡ç®—å¦‚ä¸‹ï¼š 12calc_entropy = lambda P_: sum(map(lambda p: -p * np.log2(p), P_))# å…¶ä¸­P_ä¸ºXçš„æ¦‚çŽ‡åˆ†å¸ƒï¼Œpä¸ºXå–æŸä¸ªéšæœºå˜é‡çš„æ¦‚çŽ‡ æ¡ä»¶ç†µï¼ˆconditional entropyï¼‰è®¾æœ‰éšæœºå˜é‡$(X,Y)$ï¼Œå…¶è”åˆæ¦‚çŽ‡åˆ†å¸ƒä¸º$$P(X=x_i,Y=y_i)=p_{ij}, i=1,2,â€¦,n;j=1,2,â€¦,m$$æ¡ä»¶ç†µ$H(Y|X)$è¡¨ç¤ºåœ¨å·²çŸ¥éšæœºå˜é‡Xçš„æ¡ä»¶ä¸‹éšæœºå˜é‡Yçš„ä¸ç¡®å®šæ€§ã€‚éšæœºå˜é‡Xç»™å®šçš„æ¡ä»¶ä¸‹éšæœºå˜é‡Yçš„æ¡ä»¶ç†µ$H(Y|X)$ï¼Œå®šä¹‰ä¸ºXç»™å®šæ¡ä»¶ä¸‹Yçš„æ¡ä»¶æ¦‚çŽ‡åˆ†å¸ƒçš„ç†µå¯¹Xçš„æ•°å­¦æœŸæœ›$$entropy(Y|X) = \sum_{i=1}^k p_i H(Y|X=x_i)$$è¿™é‡Œ$p_i=P(X=x_i), i=1,2,â€¦,n$ã€‚ç”¨pythonå®žçŽ°æ±‚æ¡ä»¶ç†µæ—¶ï¼Œåªéœ€è¦æŠŠP_æ›´æ¢ä¸ºfeat_value_cate_På†è°ƒç”¨calc_entropyï¼Œç„¶åŽæŠŠæ‰€æœ‰åˆ†ç»„çš„æ¦‚çŽ‡ä¸Žå¯¹åº”çš„ç†µç›¸ä¹˜å†ç›¸åŠ ï¼š 12345# groupä¸ºYå¯¹äºŽè¿™ä¸ªç‰¹å¾Xå–ä¸åŒçš„å€¼çš„åˆ†ç»„for feat_value, group in groups: feat_value_P = len(group) / len(df) # ç‰¹å¾Xå–æŸå€¼çš„æ¦‚çŽ‡ feat_value_cate_P = group[cate].value_counts() / group[cate].count() # ç‰¹å¾Xå–æŸå€¼å¯¹åº”ä¸åŒçš„ç±»åˆ«çš„æ¦‚çŽ‡ feat_value_entropy += feat_value_P * calc_entropy(feat_value_cate_P) ä¿¡æ¯å¢žç›Šï¼ˆinformation gainï¼‰ä¿¡æ¯å¢žç›Šè¡¨ç¤ºå¾—çŸ¥ç‰¹å¾Xçš„ä¿¡æ¯è€Œä½¿å¾—ç±»Yçš„ä¿¡æ¯çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚ç‰¹å¾Aå¯¹è®­ç»ƒæ•°æ®é›†Dçš„ä¿¡æ¯å¢žç›Š$g(D,A)$ï¼Œå®šä¹‰ä¸ºé›†åˆDçš„ç»éªŒç†µH(D)ä¸Žç‰¹å¾Aç»™å®šæ¡ä»¶ä¸‹Dçš„ç»éªŒæ¡ä»¶ç†µH(D|A)ä¹‹å·®ï¼Œå³$$g(D,A)=H(D)âˆ’H(D|A)$$è¿™ä¸ªå·®åˆç§°ä¸ºäº’ä¿¡æ¯ï¼Œè¡¨ç¤ºç”±äºŽç‰¹å¾Aè€Œä½¿å¾—å¯¹æ•°æ®é›†Dçš„åˆ†ç±»ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚ä¿¡æ¯å¢žç›Šå¤§çš„ç‰¹å¾å…·æœ‰æ›´å¼ºçš„åˆ†ç±»èƒ½åŠ›ã€‚è®¾è®­ç»ƒæ•°æ®ä¸º$D$ï¼Œ$|D|$è¡¨ç¤ºå…¶æ ·æœ¬å®¹é‡ï¼Œå³æ ·æœ¬ä¸ªæ•°ã€‚è®¾$D$æœ‰$K$ä¸ªç±»$C_k$ï¼Œ$k=1,2,â€¦,K$ï¼Œ$|C_k|$ä¸ºå±žäºŽç±»$C_k$çš„æ ·æœ¬ä¸ªæ•°ï¼Œ$\sum_{k=1}^K |C_k|=|D|$. è®¾ç‰¹å¾Aæœ‰nä¸ªä¸åŒçš„å–å€¼${a_1,a_2,â€¦a_n}$, æ ¹æ®ç‰¹å¾A çš„å–å€¼å°†Dåˆ’åˆ†ä¸ºnä¸ªå­é›†$D_1,D_2,â€¦,D_n$, $|D_i|$ä¸ºçš„æ ·æœ¬$D_i$ä¸ªæ•°ï¼Œ$\sum_{i=1}^n |D_i|=|D|$ã€‚è®°å­é›†$D_i$ä¸­å±žäºŽç±»$C_k$çš„æ ·æœ¬çš„é›†åˆä¸º$D_{ik}$ï¼Œå³$D_{ik}=D_i\bigcap C_k$ï¼Œ$|D_{ik}|$ä¸º$D_{ik}$çš„æ ·æœ¬ä¸ªæ•°ã€‚ è®¡ç®—ä¿¡æ¯å¢žç›Šçš„ç®—æ³•å¦‚ä¸‹ï¼š è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›†$D$å’Œç‰¹å¾$A$ï¼› è¾“å‡ºï¼šç‰¹å¾Aå¯¹è®­ç»ƒæ•°æ®é›†$D$çš„ä¿¡æ¯å¢žç›Š$g(D,A)$. è®¡ç®—æ•°æ®é›†Dçš„ç»éªŒç†µH(D)$$H(D)=-\sum_{i=1}^k \frac{|C_k|}{|D|} log_2 \frac {|C_k|}{|D|}$$ è®¡ç®—ç‰¹å¾Aå¯¹æ•°æ®é›†Dçš„ç»éªŒæ¡ä»¶ç†µ$H(D|A)$$$H(D|A)=\sum_{i=1}^n \frac{|D_i|}{|D|}H(D_i)=\sum_{i=1}^n \frac{|D_i|}{|D|} \sum_{i=1}^K \frac{|D_{ik}|}{|D|} log_2 \frac{|D_{ik}|}{|D|}$$ è®¡ç®—ä¿¡æ¯å¢žç›Š$$g(D,A)=H(D)âˆ’H(D|A)$$ å†³ç­–æ ‘çš„ç”Ÿæˆæœ¬æ¬¡æˆ‘ä»¬åªä»‹ç»ID3ç®—æ³•ï¼ŒID3ç®—æ³•ç”±Ross Quinlanå‘æ˜Žï¼Œå»ºç«‹åœ¨â€œå¥¥å¡å§†å‰ƒåˆ€â€çš„åŸºç¡€ä¸Šï¼šè¶Šæ˜¯å°åž‹çš„å†³ç­–æ ‘è¶Šä¼˜äºŽå¤§çš„å†³ç­–æ ‘ï¼ˆbe simpleç®€å•ç†è®ºï¼‰ã€‚ID3ç®—æ³•ä¸­æ ¹æ®ä¿¡æ¯å¢žç›Šè¯„ä¼°å’Œé€‰æ‹©ç‰¹å¾ï¼Œæ¯æ¬¡é€‰æ‹©ä¿¡æ¯å¢žç›Šæœ€å¤§çš„ç‰¹å¾ä½œä¸ºåˆ¤æ–­æ¨¡å—å»ºç«‹å­ç»“ç‚¹ã€‚ID3ç®—æ³•å¯ç”¨äºŽåˆ’åˆ†æ ‡ç§°åž‹æ•°æ®é›†ï¼Œæ²¡æœ‰å‰ªæžçš„è¿‡ç¨‹ï¼Œä¸ºäº†åŽ»é™¤è¿‡åº¦æ•°æ®åŒ¹é…çš„é—®é¢˜ï¼Œå¯é€šè¿‡è£å‰ªåˆå¹¶ç›¸é‚»çš„æ— æ³•äº§ç”Ÿå¤§é‡ä¿¡æ¯å¢žç›Šçš„å¶å­èŠ‚ç‚¹ï¼ˆä¾‹å¦‚è®¾ç½®ä¿¡æ¯å¢žç›Šé˜€å€¼ï¼‰ã€‚ä½¿ç”¨ä¿¡æ¯å¢žç›Šçš„è¯å…¶å®žæ˜¯æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œé‚£å°±æ˜¯å®ƒåå‘äºŽå…·æœ‰å¤§é‡å€¼çš„å±žæ€§ã€‚å°±æ˜¯è¯´åœ¨è®­ç»ƒé›†ä¸­ï¼ŒæŸä¸ªå±žæ€§æ‰€å–çš„ä¸åŒå€¼çš„ä¸ªæ•°è¶Šå¤šï¼Œé‚£ä¹ˆè¶Šæœ‰å¯èƒ½æ‹¿å®ƒæ¥ä½œä¸ºåˆ†è£‚å±žæ€§ï¼Œè€Œè¿™æ ·åšæœ‰æ—¶å€™æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå¦å¤–ID3ä¸èƒ½å¤„ç†è¿žç»­åˆ†å¸ƒçš„æ•°æ®ç‰¹å¾ï¼ŒäºŽæ˜¯å°±æœ‰äº†C4.5ç®—æ³•ã€‚CARTç®—æ³•ä¹Ÿæ”¯æŒè¿žç»­åˆ†å¸ƒçš„æ•°æ®ç‰¹å¾ã€‚123456789101112131415161718192021222324252627282930def select(df, features, cate , H_D): gain_dict = &#123;&#125; for feat in features: groups = df.groupby(feat) feat_value_entropy = 0 for feat_value, group in groups: feat_value_P = len(group) / len(df) # ç‰¹å¾å–æŸå€¼çš„æ¦‚çŽ‡ feat_value_cate_P = group[cate].value_counts() / group[cate].count() # ç‰¹å¾å–æŸå€¼å¯¹åº”ä¸åŒçš„ç±»åˆ«çš„æ¦‚çŽ‡ feat_value_entropy += feat_value_P * calc_entropy(feat_value_cate_P) imfor_gain = H_D - feat_value_entropy gain_dict[feat] = imfor_gain return max(gain_dict, key=lambda x:gain_dict[x])def create_tree(df, cate, H_D ): feat = df.columns[:-1].tolist() cate_values = df[cate].unique() if len(cate_values)==1: return cate_values[0] if len(feat) == 0: # ç”¨å®Œæ‰€æœ‰ç‰¹å¾åŽ temp = df[cate].value_counts().to_dict() return max(temp, key=lambda x:temp[x]) # å–æœ€å¤šçš„ç±»åˆ«ä½œä¸ºè¿”å›žå€¼ best_feat = select(df, feat, cate, H_D) my_tree = &#123; best_feat:&#123;&#125; &#125; unique_feat_values = df[best_feat].unique() for feat_value in unique_feat_values: df_ = df[df[best_feat] == feat_value].copy() df_ = df_.drop(best_feat, axis=1) # è¿™é‡Œä¸€å®šä¸èƒ½æ˜¯dfï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªæ–°çš„df_ï¼Œæ‰èƒ½ä½¿é€’å½’*ä¸­çš„feat*è¶Šæ¥è¶Šå° my_tree[best_feat][feat_value] = create_tree(df_, cate, H_D ) return my_tree æˆ‘ä»¬è¿™é‡Œç”¨Pythonè¯­è¨€çš„å­—å…¸å¥—å­—å…¸ç±»åž‹å­˜å‚¨æ ‘çš„ä¿¡æ¯ï¼Œç®€å•æ–¹ä¾¿ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„æ•°æ®ç»“æž„å­˜å‚¨æ ‘ã€‚æ¥ç”Ÿæˆä¸€ä¸ªæ ‘ï¼š1234567df = pd.read_excel("TreeData.xlsx", index_col="id")cate = df.columns[-1]P_cate = df[cate].value_counts() / df[cate].count()H_D = calc_entropy(P_cate)tree = create_tree(df,cate, H_D)print(tree)# &#123;'æœ‰è‡ªå·±çš„æˆ¿å­': &#123;'å¦': &#123;'æœ‰å·¥ä½œ': &#123;'å¦': 'å¦', 'æ˜¯': 'æ˜¯'&#125;&#125;, 'æ˜¯': 'æ˜¯'&#125;&#125; å†³ç­–æ ‘çš„å¯è§†åŒ–æˆ‘ä»¬ä¸»è¦ç”¨pythonçš„matplotlibæ¥å¤„ç†å›¾åƒï¼Œå®ƒçš„annotateå¾ˆæ–¹ä¾¿ç”¨äºŽæ³¨é‡Šã€‚ï¼ˆä»¥ä¸‹ä»£ç æ¥æºï¼šæœºå™¨å­¦ä¹ å®žæˆ˜ï¼Œæˆ‘å¯¹å…¶ç®€å•çš„æ›´æ”¹äº†ä¸€ä¸‹ï¼‰å…ˆèŽ·å¾—å¶å­èŠ‚ç‚¹ä¸ªæ•°å’Œæ ‘çš„æ·±åº¦ï¼š1234567891011121314151617181920212223def get_leafs_num(tree_): num_leafs = 0 first_key = list(tree_.keys())[0] second_dict = tree_[first_key] for key in second_dict.keys(): if type(second_dict[key]).__name__ == "dict": num_leafs += get_leafs_num(second_dict[key]) else: num_leafs += 1 return num_leafsdef get_tree_depth(tree_): max_depth = 0 first_key = list(tree_.keys())[0] second_dict = tree_[first_key] for key in second_dict.keys(): if type(second_dict[key]).__name__ == "dict": # å¦‚æžœè¿˜æ˜¯å­—å…¸ï¼Œç»§ç»­æ·±å…¥ this_depth = 1 + get_tree_depth(second_dict[key]) else: this_depth = 1 if this_depth &gt; max_depth: max_depth = this_depth return max_depth ç„¶åŽå†ç”»å›¾ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import matplotlib.pyplot as pltplt.rcParams['font.sans-serif']=['SimHei'] plt.rcParams['axes.unicode_minus']=False decision_node=&#123;"boxstyle": "sawtooth", "fc": "0.8", &#125;leaf_node=&#123;"boxstyle": "round4", "fc": "0.8"&#125;arrow_args=&#123;"arrowstyle": "&lt;-"&#125;def plot_node(node_txt, centerPt, parentPt, node_type): global ax1 ax1.annotate(node_txt, xy=parentPt, xycoords='axes fraction',xytext=centerPt, textcoords='axes fraction',va="center", ha="center", bbox=node_type, arrowprops=arrow_args)def plot_mid_text(cntrPt, parentPt, txt_string): # åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„çº¿ä¸Šå†™ä¸Šå­— global ax1 xMid = (parentPt[0] - cntrPt[0]) / 2.0 + cntrPt[0] yMid = (parentPt[1] - cntrPt[1]) / 2.0 + cntrPt[1] ax1.text(xMid, yMid, txt_string) # text() çš„ä½¿ç”¨def plot_tree( tree_, parent_point, node_txt): global ax1,xOff,yOff,totalD,totalW num_leafs = get_leafs_num(tree_) depth = get_tree_depth(tree_) first_key = list(tree_.keys())[0] center_point = (xOff + (1.0 + float(num_leafs)) / 2.0 / totalW, yOff) plot_mid_text( center_point, parent_point, node_txt) # åœ¨çˆ¶å­èŠ‚ç‚¹é—´å¡«å……æ–‡æœ¬ä¿¡æ¯ plot_node(first_key, center_point, parent_point, decision_node) # ç»˜åˆ¶å¸¦ç®­å¤´çš„æ³¨è§£ second_dict = tree_[first_key] yOff = yOff - 1.0 / totalD for key in second_dict.keys(): if type(second_dict[key]).__name__ == 'dict': # åˆ¤æ–­æ˜¯ä¸æ˜¯å­—å…¸ï¼Œ plot_tree(second_dict[key], center_point, str(key)) # é€’å½’ç»˜åˆ¶æ ‘å½¢å›¾ else: # å¦‚æžœæ˜¯å¶èŠ‚ç‚¹ xOff = xOff + 1.0 / totalW plot_node(second_dict[key], (xOff, yOff), center_point, leaf_node) plot_mid_text((xOff, yOff), center_point, str(key)) yOff = yOff + 1.0 / totalDdef show_tree(tree_): global ax1,xOff,yOff,totalD,totalW fig = plt.figure(1, facecolor='white') fig.clf() # æ¸…ç©ºç»˜å›¾åŒº axprops = dict(xticks=[], yticks=[]) ax1 = plt.subplot(111, frameon=False, **axprops) totalW = float(get_leafs_num(tree_)) totalD = float(get_tree_depth(tree_)) xOff = -0.5 / totalW # è¿½è¸ªå·²ç»ç»˜åˆ¶çš„èŠ‚ç‚¹ä½ç½® åˆå§‹å€¼ä¸º å°†æ€»å®½åº¦å¹³åˆ† åœ¨å–ç¬¬ä¸€ä¸ªçš„ä¸€åŠ yOff = 1.0 plot_tree(tree_, (0.5, 1.0), '') # è°ƒç”¨å‡½æ•°ï¼Œå¹¶æŒ‡å‡ºæ ¹èŠ‚ç‚¹æºåæ ‡ plt.show() ä¸‹é¢ç”¨ä¸€ä¸ªå®žä¾‹æ¥å¯è§†åŒ–ä¸€ä¸‹ï¼š1234tree = &#123;'æœ‰è‡ªå·±çš„æˆ¿å­': &#123;'å¦': &#123;'æœ‰å·¥ä½œ': &#123;'å¦': 'å¦', 'æ˜¯': 'æ˜¯'&#125;&#125;, 'æ˜¯': 'æ˜¯'&#125;&#125;print(tree)show_tree(tree) å¯è§†åŒ–ç»“æžœå¦‚ä¸‹ï¼š ç”±äºŽç¯‡å¹…è¿‡é•¿ï¼Œå®Œæ•´ä»£ç ï¼ˆç»“æž„åŒ–å°è£…ï¼‰å°±ä¸åœ¨è¿™é‡Œç»™å‡ºï¼Œè¯¦æƒ…å‚è§æˆ‘çš„GitHubã€‚ æµ‹è¯•è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨uciçš„lenseéšå½¢çœ¼é•œæµ‹è¯•é›†,æ€»æ ·æœ¬ä¸º24ä¸ªï¼Œå››ä¸ªç‰¹å¾ï¼Œä¸‰ä¸ªç±»åˆ«ã€‚æˆ‘ä»¬é€šè¿‡ç½‘ç»œçˆ¬è™«ï¼Œç›´æŽ¥ä»Žè¯¥ç½‘å€æŠ“å–æ•°æ®ï¼Œå¹¶è½¬æ¢ä¸ºdataframeç±»åž‹ã€‚ â€“ 3 Classes: 1 : the patient should be fitted with hard contact lenses, 2 : the patient should be fitted with soft contact lenses, 3 : the patient should not be fitted with contact lenses. â€“ 4 Features: 1. age of the patient: (1) young, (2) pre-presbyopic, (3) presbyopic 2. spectacle prescription: (1) myope, (2) hypermetrope 3. astigmatic: (1) no, (2) yes 4. tear production rate: (1) reduced, (2) normal ä¸‹é¢æˆ‘ä»¬ç»™å‡ºä»£ç ï¼š1234567891011121314151617181920212223242526from ID3 import ID3_treeimport requestsimport pandas as pddef get_data(): url = "http://archive.ics.uci.edu/ml/machine-learning-databases/lenses/lenses.data" data = requests.get(url).text verctors = data.split('\n') verctors = [ver.split() for ver in verctors] features = ["id","age","prescript","astigmatic","tearRate","category"] df = pd.DataFrame(verctors,columns=features, dtype=int) df = df.set_index("id").dropna() key_list = [&#123;"1":"young", "2":"pre-presbyopic", "3":"presbyopic"&#125;, &#123;"1": "myope", "2": "hypermetrope"&#125; , &#123;"1": "no", "2": "yes"&#125;, &#123;"1": "reduced", "2":"normal"&#125;,&#123;"1":"hard","2":"soft","3":"no lenses"&#125;] for i in range(5): df.iloc[:,i] = df.iloc[:,i].apply(lambda x:key_list[i][x]) return dfif __name__ == "__main__": df = get_data() # print(df) id3_tree = ID3_tree(df) id3_tree = id3_tree.train(df) my_tree = id3_tree.my_tree print(my_tree) id3_tree.show_tree(my_tree) å¾—å‡ºçš„å†³ç­–æ ‘å¦‚ä¸‹ï¼š åŽç»­ç”±äºŽæœ¬æ–‡åªç»™å‡ºäº†ID3ç®—æ³•ç”Ÿæˆå†³ç­–æ ‘å’Œå†³ç­–æ ‘çš„å¯è§†åŒ–ï¼Œæ—¥åŽæˆ‘å°†ç»§ç»­ç»™å‡ºC4.5çš„ç”Ÿæˆå†³ç­–æ ‘ç®—æ³•ã€å†³ç­–æ ‘çš„å‡æžé—®é¢˜ä¸ŽåŠCARTåˆ†ç±»å’Œå›žå½’æ ‘çš„æž„é€ ã€‚ç„¶åŽæˆ‘ä»¬è¿˜å¯ä»¥æŠŠå®ƒæ‹“å®½ï¼Œå¼•å…¥é›†æˆå­¦ä¹ çš„éšæœºæ£®æž—ã€‚ ä½œè€…æ—¶é—´ç²¾åŠ›æœ‰é™ï¼Œæˆ‘å°±å…ˆå†™åˆ°è¿™é‡Œå•¦ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè®°å¾—è”ç³»æˆ‘å“¦ã€‚ å‚è€ƒæ–‡çŒ® ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æŽèˆª è‘— æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾ã€Šæœºå™¨å­¦ä¹ å®žæˆ˜ã€‹Peter Harrington è‘— äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Radial basis function kernel]]></title>
    <url>%2F2018%2F03%2F18%2FRadial-basis-function-kernel%2F</url>
    <content type="text"><![CDATA[é«˜æ–¯å¾„å‘åŸºå‡½æ•°ç®€ä»‹ï¼šåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œï¼ˆé«˜æ–¯ï¼‰å¾„å‘åŸºå‡½æ•°æ ¸ï¼ˆè‹±è¯­ï¼šRadial basis function kernelï¼‰ï¼Œæˆ–ç§°ä¸ºRBFæ ¸ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„æ ¸å‡½æ•°ã€‚å®ƒæ˜¯æ”¯æŒå‘é‡æœºåˆ†ç±»ä¸­æœ€ä¸ºå¸¸ç”¨çš„æ ¸å‡½æ•°ã€‚â€”â€” ç»´åŸºç™¾ç§‘ é«˜æ–¯å¾„å‘åŸºå‡½æ•°é«˜æ–¯å¾„å‘åŸºå‡½æ•°å…¬å¼å¦‚ä¸‹ï¼š$$K(x_1,x_2)=\exp{(-\frac{\parallel x_1-x_2 \parallel^2 }{2\sigma^2})}, \sigma&gt;0$$ é‚£ä¹ˆå®ƒæœ‰ä»€ä¹ˆå‡ ä½•æ„ä¹‰å‘¢?å…ˆçœ‹çœ‹xç»è¿‡æ˜ å°„ä»¥åŽï¼Œåœ¨é«˜ç»´ç©ºé—´é‡Œè¿™ä¸ªç‚¹åˆ°åŽŸç‚¹çš„è·ç¦»å…¬å¼ï¼š $$ \parallel x_i-0\parallel^2 = \parallel x_i \parallel^2=\left \langle \Phi (x_i), \Phi (x_i)\right \rangle=K(x_i,x_i)=1$$è¿™è¡¨æ˜Žæ ·æœ¬xæ˜ å°„åˆ°é«˜ç»´ç©ºé—´åŽï¼Œåœ¨é«˜ç»´ç©ºé—´ä¸­çš„ç‚¹$\Phi (x_i)$åˆ°é«˜ç»´ç©ºé—´ä¸­åŽŸç‚¹çš„è·ç¦»ä¸º1ï¼Œä¹Ÿå³$\Phi (x_i)$å­˜åœ¨äºŽä¸€ä¸ªè¶…çƒé¢ä¸Šã€‚ ä¸ºä»€ä¹ˆæ ¸å‡½æ•°èƒ½æ˜ å°„åˆ°é«˜ç»´ç©ºé—´å‘¢ï¼Ÿå…ˆè€ƒè™‘æ™®é€šçš„å¤šé¡¹å¼æ ¸å‡½æ•°ï¼š$K(x,y)=(x^T\cdot y+m)^p$,å…¶ä¸­$x,y\in \mathbb{R}^n$ï¼Œå¤šé¡¹å¼å‚æ•°$p,m\in \mathbb{R}$è€ƒè™‘$x=(x_1,x_2),y=(y_1,y_2),m=0,p=2$ï¼Œå³$K(x,y)=(x^T\cdot y)^2=x_1^2y_1^2+2x_1x_2y_1y_2+x_2^2y_2^2$çŽ°åœ¨å›žåˆ°ä¹‹å‰çš„æ˜ å°„$k(x,y)=\left \langle \Phi(x),\Phi(y)\right \rangle$ï¼Œå¹¶å–$\Phi(x)=(x_1^2,\sqrt{2}x_1x_2,x_2^2)$åˆ™æœ‰$k(x,y)=\left \langle \Phi(x),\Phi(y)\right \rangle=x_1^2y_1^2+2x_1x_2y_1y_2+x_2^2y_2^2=(x^T\cdot y)^2=K(x,y)$è¿™å°±æ˜¯å‰é¢çš„$K(x,y)$ï¼Œå› æ­¤ï¼Œè¯¥æ ¸å‡½æ•°å°±å°†2ç»´æ˜ å°„åˆ°äº†3ç»´ç©ºé—´ã€‚ å¾„å‘åŸºæ ¸åˆä¸ºä»€ä¹ˆèƒ½å¤Ÿæ˜ å°„åˆ°æ— é™ç»´ç©ºé—´å‘¢ï¼Ÿçœ‹å®Œäº†æ™®é€šå¤šé¡¹å¼æ ¸å‡½æ•°ç”±2ç»´å‘3ç»´çš„æ˜ å°„ï¼Œå†æ¥çœ‹çœ‹é«˜æ–¯å¾„å‘åŸºå‡½æ•°ä¼šæŠŠ2ç»´å¹³é¢ä¸Šä¸€ç‚¹æ˜ å°„åˆ°å¤šå°‘ç»´ã€‚$$\begin{eqnarray}K(x,y) &amp; = &amp; \exp(| x_1-x_2 |^2 ) \&amp; = &amp; \exp(-(x_1-y_1)^2-(x_2-y_2)^2) \&amp; = &amp; \exp(-x_1^2+2x_1y_1-y_1^2-x_2^2+2x_2y_2-y_2^2) \&amp; = &amp; \exp(-|x|^2)\exp(-|y|^2)\exp(2x^Ty)\\end{eqnarray}$$å°†æœ€åŽä¸€é¡¹æ³°å‹’å±•å¼€ä½ å°±ä¼šæç„¶å¤§æ‚Ÿï¼š$$K(x,y)=\exp(-|x|^2)\exp(-|y|^2)\sum_{n=0}^{\infty}\frac{(2x^Ty)^n}{n!}$$ å†å…·ä½“ä¸€ç‚¹ï¼šé«˜æ–¯æ ¸æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š$K(x_1,x_2)=\exp{(-\frac{\parallel x_1-x_2 \parallel^2 }{2\sigma^2})}, \sigma&gt;0$å°½ç®¡æˆ‘ä¸ä¼šè§£é‡Šå®ƒï¼ˆä½†ç›¸ä¿¡æˆ‘ï¼‰é«˜æ–¯æ ¸å¯ä»¥ç®€å•ä¿®æ­£ä¸ºè¿™ä¸ªæ ·å­ï¼š$K(x_1,x_2)=\exp(-\frac{x_1\cdot x_2}{\sigma^2}),\sigma&gt;0$ï¼Œè¿™é‡Œ$x_1\cdot x_2$å¯è§£é‡Šä¸ºå†…ç§¯ã€‚å†ç”¨æ³°å‹’å±•å¼€å°±ä¼šå¾—åˆ°$K(x_1,x_2)=\sum_{n=0}^{\infty}\frac{(x_1\cdot x_2)^n}{\sigma^nn!}$æ±‚å’Œå·é‡Œé¢çš„å…ƒç´ æ˜¯ä¸æ˜¯çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰å‘¢ï¼Ÿæ²¡é”™ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªnæ¬¡å¤šé¡¹å¼æ ¸ã€‚å› ä¸ºæ¯ä¸€ä¸ªå¤šé¡¹å¼æ ¸éƒ½å°†ä¸€ä¸ªå‘é‡æŠ•å½±åˆ°æ›´é«˜ç»´çš„ç©ºé—´ä¸­ï¼Œå› æ­¤é«˜æ–¯æ ¸æ˜¯é‚£äº›$degree\geq0$çš„å¤šé¡¹å¼æ ¸çš„ç»„åˆï¼Œæ‰€ä»¥æˆ‘ä»¬è¯´é«˜æ–¯æ ¸æ˜¯æŠ•å½±åˆ°æ— ç©·ç»´ç©ºé—´ä¸­ã€‚ å‚è€ƒQuoraä¸Šçš„é—®é¢˜ï¼šhttps://www.quora.com/Machine-Learning/Why-does-the-RBF-radial-basis-function-kernel-map-into-infinite-dimensional-space-mentioned-many-times-in-machine-learning-lectures æœ€åŽåˆå­¦è€…ä½¿ç”¨markdownä¸ŽLaTeXçš„è¯­æ³•çœŸä¸é€‚åº”å•Šï¼Œå°±å†™åˆ°è¿™é‡Œå§ï¼Œå†™ç¯‡åšå®¢å¤ªç´¯äº†orzé¥­éƒ½æ²¡åƒï¼Œå…³äºŽRBFç¥žç»ç½‘ç»œçš„è¯ï¼Œä»¥åŽç”¨åˆ°å†æ¥è®²å§ï¼Œç´¯æ­»æˆ‘æƒ¹ã€‚å¦‚æœ‰ç–‘é—®ï¼Œæ¬¢è¿Žå’¨è¯¢ï¼Œè”ç³»æ–¹å¼è§â€œå…³äºŽâ€é¡µé¢ã€‚]]></content>
      <categories>
        <category>math</category>
        <category>theory</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python çš„é—­åŒ…ã€è£…é¥°å™¨]]></title>
    <url>%2F2018%2F03%2F17%2Fpython-%E7%9A%84%E9%97%AD%E5%8C%85%E3%80%81%E8%A3%85%E9%A5%B0%E5%99%A8%2F</url>
    <content type="text"><![CDATA[ä¸€ã€é—­åŒ…ï¼ˆClosureï¼‰ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œé—­åŒ…ï¼ˆè‹±è¯­ï¼šClosureï¼‰ï¼Œåˆç§°è¯æ³•é—­åŒ…ï¼ˆLexical Closureï¼‰æˆ–å‡½æ•°é—­åŒ…ï¼ˆfunction closuresï¼‰ï¼Œæ˜¯å¼•ç”¨äº†è‡ªç”±å˜é‡çš„å‡½æ•°ã€‚è¿™ä¸ªè¢«å¼•ç”¨çš„è‡ªç”±å˜é‡å°†å’Œè¿™ä¸ªå‡½æ•°ä¸€åŒå­˜åœ¨ï¼Œå³ä½¿å·²ç»ç¦»å¼€äº†åˆ›é€ å®ƒçš„çŽ¯å¢ƒä¹Ÿä¸ä¾‹å¤–ã€‚æ‰€ä»¥ï¼Œæœ‰å¦ä¸€ç§è¯´æ³•è®¤ä¸ºé—­åŒ…æ˜¯ç”±å‡½æ•°å’Œä¸Žå…¶ç›¸å…³çš„å¼•ç”¨çŽ¯å¢ƒç»„åˆè€Œæˆçš„å®žä½“ã€‚é—­åŒ…åœ¨è¿è¡Œæ—¶å¯ä»¥æœ‰å¤šä¸ªå®žä¾‹ï¼Œä¸åŒçš„å¼•ç”¨çŽ¯å¢ƒå’Œç›¸åŒçš„å‡½æ•°ç»„åˆå¯ä»¥äº§ç”Ÿä¸åŒçš„å®žä¾‹ã€‚â€”â€” ç»´åŸºç™¾ç§‘) è¿™é‡Œæˆ‘ç»™ä¸ªç®€å•çš„è§£é‡Šï¼šä¸€ä¸ªé—­åŒ…å°±æ˜¯ä½ è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°Aï¼Œè¿™ä¸ªå‡½æ•°Aè¿”å›žäº†ä¸€ä¸ªå‡½æ•°Bç»™ä½ ã€‚è¿™ä¸ªè¿”å›žçš„å‡½æ•°Bå°±å«åšé—­åŒ…ã€‚ä½ åœ¨è°ƒç”¨å‡½æ•°Açš„æ—¶å€™ä¼ é€’çš„å‚æ•°å°±æ˜¯è‡ªç”±å˜é‡ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š1234567def func(name): def inner_func(age): print 'name:', name, 'age:', age return inner_funcbb = func('matrix')bb(26) # &gt;&gt;&gt; name: matrix age: 26 è¿™é‡Œé¢è°ƒç”¨funcçš„æ—¶å€™å°±äº§ç”Ÿäº†ä¸€ä¸ªé—­åŒ…â€“ inner_func,å¹¶ä¸”è¯¥é—­åŒ…æŒæœ‰è‡ªç”±å˜é‡â€“ nameï¼Œå› æ­¤è¿™ä¹Ÿæ„å‘³ç€ï¼Œå½“å‡½æ•°funcçš„ç”Ÿå‘½å‘¨æœŸç»“æŸä¹‹åŽï¼Œnameè¿™ä¸ªå˜é‡ä¾ç„¶å­˜åœ¨ï¼Œå› ä¸ºå®ƒè¢«é—­åŒ…å¼•ç”¨äº†ï¼Œæ‰€ä»¥ä¸ä¼šè¢«å›žæ”¶ã€‚ ä¹Ÿæœ‰äººè¯´è¿™ç§å†…éƒ¨å‡½æ•°inner_funcå¯ä»¥ä½¿ç”¨å¤–éƒ¨å‡½æ•°çš„å˜é‡nameçš„è¡Œä¸ºå°±å«é—­åŒ…ã€‚ äºŒã€è£…é¥°å™¨ï¼ˆDecoratorï¼‰ä»€ä¹ˆæ˜¯è£…é¥°å™¨ï¼Ÿ â€œè£…é¥°å™¨çš„åŠŸèƒ½æ˜¯å°†è¢«è£…é¥°çš„å‡½æ•°å½“ä½œå‚æ•°ä¼ é€’ç»™ä¸Žè£…é¥°å™¨å¯¹åº”çš„å‡½æ•°ï¼ˆåç§°ç›¸åŒçš„å‡½æ•°ï¼‰ï¼Œå¹¶è¿”å›žåŒ…è£…åŽçš„è¢«è£…é¥°çš„å‡½æ•°â€ å¬èµ·æ¥æœ‰ç‚¹ç»•ï¼Œæ²¡å…³ç³»ï¼Œç›´æŽ¥çœ‹ç¤ºæ„å›¾,å…¶ä¸­aä¸º ä¸Žè£…é¥°å™¨@aå¯¹åº”çš„å‡½æ•°ï¼Œbä¸ºè£…é¥°å™¨ä¿®é¥°çš„å‡½æ•°ï¼Œè£…é¥°å™¨@açš„ä½œç”¨æ˜¯ï¼šç®€è€Œè¨€ä¹‹ï¼š@a å°±æ˜¯å°† b ä¼ é€’ç»™ a()ï¼Œå¹¶è¿”å›žæ–°çš„ b = a(b) ä¸¾ä¸ªä¾‹å­ å…ˆå¯¼å…¥åŒ…ï¼š 1234from functools import reduceimport mathimport logginglogging.basicConfig(level=logging.INFO) å®šä¹‰ä¸€ä¸ªæ£€æŸ¥å‚æ•°çš„è£…é¥°å™¨ï¼š 123456789def checkParams(fn): def wrapper(*numbers): temp = map(lambda x:isinstance(x,(int,)),numbers) # æ£€æŸ¥å‚æ•°æ˜¯å¦éƒ½ä¸ºæ•´åž‹ if reduce(lambda x,y: x and y, temp): # è‹¥éƒ½ä¸ºæ•´åž‹ return fn(*numbers) # åˆ™è°ƒç”¨fn(*numbers)è¿”å›žè®¡ç®—ç»“æžœ #å¦åˆ™é€šè¿‡loggingè®°å½•é”™è¯¯ä¿¡æ¯ï¼Œå¹¶å‹å¥½é€€å‡º logging.warning("variable numbers cannot be added") return return wrapper #fnå¼•ç”¨gcdï¼Œè¢«å°å­˜åœ¨é—­åŒ…çš„æ‰§è¡ŒçŽ¯å¢ƒä¸­è¿”å›ž ç„¶åŽå®šä¹‰æ±‚æœ€å¤§å…¬çº¦æ•°çš„å‡½æ•°ï¼ˆèƒ½æ±‚å¤šä¸ªçš„æœ€å¤§å…¬çº¦æ•°ï¼‰ï¼š 123def gcd(*numbers): """return the greatest common divisor of the given integers.""" return reduce(math.gcd, numbers) è°ƒç”¨ 123&gt;&gt;&gt;gcd = checkParams(gcd)&gt;&gt;&gt;gcd(3, 'hello')# è¾“å‡º WARNING:root: variable numbers cannot be added æ³¨æ„checkParamså‡½æ•°ï¼š é¦–å…ˆçœ‹å‚æ•°fnï¼Œå½“æˆ‘ä»¬è°ƒç”¨checkParams(gcd)çš„æ—¶å€™ï¼Œå®ƒå°†æˆä¸ºå‡½æ•°å¯¹è±¡gcdçš„ä¸€ä¸ªæœ¬åœ°(Local)å¼•ç”¨ï¼› åœ¨checkParamså†…éƒ¨ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªwrapperå‡½æ•°ï¼Œæ·»åŠ äº†å‚æ•°ç±»åž‹æ£€æŸ¥çš„åŠŸèƒ½ï¼Œç„¶åŽè°ƒç”¨äº†fn(*numbers)ï¼Œæ ¹æ®LEGBæ³•åˆ™ï¼Œè§£é‡Šå™¨å°†æœç´¢å‡ ä¸ªä½œç”¨åŸŸï¼Œå¹¶æœ€ç»ˆåœ¨(Enclosingå±‚) checkParamså‡½æ•°çš„æœ¬åœ°ä½œç”¨åŸŸä¸­æ‰¾åˆ°fnï¼› æ³¨æ„æœ€åŽçš„return wrapperï¼Œè¿™å°†åˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Œfnå˜é‡(gcdå‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨)å°†ä¼šå°å­˜åœ¨é—­åŒ…çš„æ‰§è¡ŒçŽ¯å¢ƒä¸­ï¼Œä¸ä¼šéšç€checkParamsçš„è¿”å›žè€Œè¢«å›žæ”¶ï¼› å½“è°ƒç”¨gcd = checkParams(gcd)æ—¶ï¼ŒgcdæŒ‡å‘äº†æ–°çš„wrapperå¯¹è±¡ï¼Œå®ƒæ·»åŠ äº†å‚æ•°æ£€æŸ¥å’Œè®°å½•æ—¥å¿—çš„åŠŸèƒ½ï¼ŒåŒæ—¶åˆèƒ½å¤Ÿé€šè¿‡å°å­˜çš„fnï¼Œç»§ç»­è°ƒç”¨åŽŸå§‹çš„gcdè¿›è¡Œæœ€å¤§å…¬çº¦æ•°è¿ç®—ã€‚ å› æ­¤è°ƒç”¨gcd(3, â€˜helloâ€™)å°†ä¸ä¼šè¿”å›žè®¡ç®—ç»“æžœï¼Œè€Œæ˜¯æ‰“å°å‡ºæ—¥å¿—ï¼šroot: variable numbers cannot be addedã€‚ æœ‰äººè§‰å¾—add = checkParams(add)è¿™æ ·çš„å†™æ³•æœªå…å¤ªè¿‡éº»çƒ¦ï¼ŒäºŽæ˜¯pythonæä¾›äº†ä¸€ç§æ›´ä¼˜é›…çš„å†™æ³•ï¼Œè¢«ç§°ä¸ºè¯­æ³•ç³–ï¼š12345@checkParamsdef lcm(*numbers): """return lowest common multiple.""" f = lambda a,b:int((a*b)/gcd(a,b)) return reduce(f, numbers) å…¶å®žè¿™åªæ˜¯ä¸€ç§å†™æ³•ä¸Šçš„ä¼˜åŒ–ï¼Œè§£é‡Šå™¨ä»ç„¶ä¼šå°†å®ƒè½¬åŒ–ä¸ºgcd = checkParams(gcd)æ¥æ‰§è¡Œã€‚]]></content>
      <categories>
        <category>math</category>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>fun math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hexoå¸¸ç”¨å‘½ä»¤ç¬”è®°]]></title>
    <url>%2F2018%2F03%2F13%2Fhexo%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[hexo123npm install hexo -g #å®‰è£…npm update hexo -g #å‡çº§hexo init #åˆå§‹åŒ– ç®€å†™12345hexo n "æˆ‘çš„åšå®¢" == hexo new "æˆ‘çš„åšå®¢" #æ–°å»ºæ–‡ç« hexo p == hexo publishhexo g == hexo generate#ç”Ÿæˆhexo s == hexo server #å¯åŠ¨æœåŠ¡é¢„è§ˆhexo d == hexo deploy#éƒ¨ç½² æœåŠ¡å™¨1234hexo server #Hexo ä¼šç›‘è§†æ–‡ä»¶å˜åŠ¨å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œæ‚¨æ— é¡»é‡å¯æœåŠ¡å™¨ã€‚hexo server -s #é™æ€æ¨¡å¼hexo server -p 5000 #æ›´æ”¹ç«¯å£hexo server -i 192.168.1.1 #è‡ªå®šä¹‰ IP 123hexo clean #æ¸…é™¤ç¼“å­˜ ç½‘é¡µæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥å¿½ç•¥æ­¤æ¡å‘½ä»¤hexo g #ç”Ÿæˆé™æ€ç½‘é¡µhexo d #å¼€å§‹éƒ¨ç½² ç›‘è§†æ–‡ä»¶å˜åŠ¨12hexo generate #ä½¿ç”¨ Hexo ç”Ÿæˆé™æ€æ–‡ä»¶å¿«é€Ÿè€Œä¸”ç®€å•hexo generate --watch #ç›‘è§†æ–‡ä»¶å˜åŠ¨ å®ŒæˆåŽéƒ¨ç½²123# ä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ç›¸åŒçš„hexo generate --deployhexo deploy --generate ç®€å†™12hexo deploy -ghexo server -g è‰ç¨¿1hexo publish [layout] &lt;title&gt; æ¨¡ç‰ˆ12345hexo new &quot;postName&quot; #æ–°å»ºæ–‡ç« hexo new page &quot;pageName&quot; #æ–°å»ºé¡µé¢hexo generate #ç”Ÿæˆé™æ€é¡µé¢è‡³publicç›®å½•hexo server #å¼€å¯é¢„è§ˆè®¿é—®ç«¯å£ï¼ˆé»˜è®¤ç«¯å£4000ï¼Œ&apos;ctrl + c&apos;å…³é—­serverï¼‰hexo deploy #å°†.deployç›®å½•éƒ¨ç½²åˆ°GitHub å¦‚ï¼š123hexo new [layout] &lt;title&gt;hexo new photo &quot;My Gallery&quot;hexo new &quot;Hello World&quot; --lang tw å˜é‡ æè¿° layout å¸ƒå±€ title æ ‡é¢˜ date æ–‡ä»¶å»ºç«‹æ—¥æœŸ 12345678title: ä½¿ç”¨Hexoæ­å»ºä¸ªäººåšå®¢layout: postdate: 2014-03-03 19:07:43comments: truecategories: Blogtags: [Hexo]keywords: Hexo, Blogdescription: ç”Ÿå‘½åœ¨äºŽæŠ˜è…¾ï¼ŒåˆæŠŠåšå®¢æŠ˜è…¾åˆ°Hexoäº†ã€‚ç»™Hexoç‚¹èµžã€‚]]></content>
      <categories>
        <category>hexo</category>
        <category>Instructions</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[my_knn]]></title>
    <url>%2F2018%2F03%2F13%2Fmy-knn%2F</url>
    <content type="text"><![CDATA[å…³äºŽåœ¨ä¸€ä¸ªæœˆå‰ï¼Œéœ€è¦ç”¨1nnåšäºŒåˆ†ç±»çš„æµ‹è¯•çš„æ—¶å€™ï¼Œå¼€å§‹å› ä¸ºç”¨sklearnè®­ç»ƒæ•°æ®æ—¶ç”¨é”™äº†æ•°æ®é›†ï¼Œç™¾æ€ä¸å¾—å…¶è§£ï¼ŒäºŽæ˜¯è‡ªå·±å†™äº†ä¸ªknnæ¥è®­ç»ƒï¼Œå½“æ—¶å†™å¥½åŽï¼Œæ‰çœŸæ­£æŠŠåŽŸç†ç»™å¼„æ‡‚äº†orzï¼ŒåŽŸæ¥æ˜¯æ•°æ®é›†è®­ç»ƒæ—¶ç”¨é”™äº†ã€‚ã€‚ã€‚æ”¹æ­£åŽå¯¹æ¯”äº†ä¸€ä¸‹è‡ªå·±çš„knnå’Œsklearnçš„knnçš„å‡†ç¡®çŽ‡éƒ½å·®ä¸å¤šï¼ˆä¹Ÿå°±æ˜¯è¯´æµ‹è¯•é€šè¿‡å•¦ï¼‰ï¼Œå°±ä¸Šä¼ åˆ°äº†æˆ‘çš„GitHubã€‚ å½“æ—¶æˆ‘è™½ç„¶æœ‰ä¸ªç”¨è…¾è®¯äº‘æ­å»ºçš„åšå®¢ï¼Œä½†åŸºæœ¬ä¸Šéƒ½æ²¡åœ¨ä¸Šé¢å†™è¿‡äº†orzï¼Œæœ¬åšå®¢å½“æ—¶è¿˜æ²¡æœ‰é—®ä¸–ï¼Œæ­£å¥½åŸºäºŽGitHubçš„æœåŠ¡å™¨æœ€è¿‘æ­äº†è¿™ä¸ªåšå®¢ï¼Œç©ºç©ºçš„ä¹Ÿä¸å¥½ï¼Œæœ€è¿‘è€å¸ˆç¬¬ä¸€è®²å°±è®²knnï¼Œé‚£å°±æŠŠä¹‹å‰çš„ä»£ç è´´ä¸Šå§ã€‚ åŽŸç†å¯¹äºŽä¸€ä¸ªè¾“å…¥çš„æµ‹è¯•æ•°æ®ï¼Œè®¡ç®—è¯¥æ ·æœ¬ç‚¹åˆ°è®­ç»ƒæ•°æ®å„æ ·æœ¬ç‚¹çš„è·ç¦»ï¼Œç„¶åŽå¯¹æ‰€æœ‰è·ç¦»ç”±å°åˆ°å¤§æŽ’åˆ—ï¼Œå–å‰kä¸ªæ•°æ®ï¼›ç»Ÿè®¡è¯¥kä¸ªæ•°æ®ä¸­å¯¹åº”çš„æ ‡ç­¾å‡ºçŽ°æ¬¡æ•°æœ€å¤šçš„æ ‡ç­¾ï¼Œåˆ™è¯¥æµ‹è¯•æ ·æœ¬å°±è¢«æ ‡è®°ä¸ºè¯¥æ ‡ç­¾ã€‚ ç®—æ³• è¾“å…¥: è®­ç»ƒæ•°æ®é›†ï¼š$T={(X_1,y_1),(X_2,y_2),â€¦,(X_N,y_N)}$, å…¶ä¸­$X_i={x_i^1,x_i^2,â€¦,x_i^n}$,æœ‰nä¸ªç‰¹å¾ï¼ŒNä¸ªæ ·æœ¬ç‚¹; è¾“å…¥ï¼šæœ€è¿‘é‚»ä¸ªæ•°kï¼ŒåŠè¦é¢„æµ‹çš„æ ·æœ¬ç‚¹$X_0={x_0^1,,x_0^2,â€¦,x_0^n}$; è®¡ç®—ï¼šæ ·æœ¬ç‚¹X_0åˆ°è®­ç»ƒæ•°æ®é›†Tä¸­å„æ ·æœ¬ç‚¹çš„è·ç¦»ï¼ˆä¸€èˆ¬ä¸ºæ¬§æ°è·ç¦»ï¼‰; æŽ’åºï¼šå°†ä»¥ä¸Šç®—å‡ºçš„è·ç¦»ç”±å°åˆ°å¤§æŽ’åºï¼Œå¹¶é€‰å‡ºå‰kä¸ªè·ç¦»æ•°æ®; ç»Ÿè®¡ï¼šç»Ÿè®¡å‰kä¸ªè·ç¦»æ•°æ®ä¸­å„ä¸ªæ ‡ç­¾å¯¹åº”çš„ä¸ªæ•°ï¼Œé€‰å‡ºä¸ªæ•°æœ€å¤šçš„é‚£ä¸ªæ ‡ç­¾ï¼Œå³ä¸ºè¯¥æ ·æœ¬ç‚¹é¢„æµ‹çš„ç»“æžœã€‚ ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556import numpy as npfrom sklearn.datasets import load_irisfrom sklearn.model_selection import train_test_splitclass my_knn(object): """docstring for my_knn""" def __init__(self, k): super(my_knn, self).__init__() self.k = k def train(self, X_train, y_train): self.X_train, self.y_train = np.array(X_train), np.array(y_train) if len(self.X_train) != len(self.y_train): raise ValueError("X_test,y_test or y_train was not equail!" "The length of X_test,y_test is %s" "But the length of y_train is %s" % (len(self.X_train), len(self.y_train))) return self def predict_one(self, X): dist2xtrain = np.sum((X - self.X_train)**2, axis=1)**0.5 index = dist2xtrain.argsort() # ä»Žå°åˆ°å¤§ï¼ˆè¿‘åˆ°è¿œï¼‰ label_count = &#123;&#125; for i in range(self.k): label = self.y_train[index[i]] label_count[label] = label_count.get(label, 0) + 1 # å°†label_countçš„å€¼ä»Žå¤§åˆ°å°æŽ’åˆ—label_countçš„é”® y_predict = sorted(label_count, key=lambda x: label_count[x], reverse=True)[0] return y_predict def predict_all(self, X): return np.array(list(map(self.predict_one, X))) def calc_accuracy(self, X, y): predict = self.predict_all(X) total = X.shape[0] right = sum(predict == y) accuracy = right/total return accuracyif __name__ == "__main__": data_set = load_iris() datas = data_set["data"] labels = data_set['target'] X_train, X_test, y_train, y_test = train_test_split(datas, labels, test_size=0.4, random_state=0) knn = my_knn(1) knn = knn.train(X_train,y_train) accuracy = knn.calc_accuracy(X_test,y_test) print("%.3f%%" % (accuracy * 100)) from sklearn.neighbors import KNeighborsClassifier neigh = KNeighborsClassifier(n_neighbors=1) neigh.fit(X_train, y_train) print(neigh.score(X_train,y_train)) print(neigh.score(X_test, y_test)) æœ€åŽå…³äºŽå¯¹knnçš„kdæ ‘åŠ é€Ÿè¿™éƒ¨åˆ†è¿˜éœ€è¦æ—¥åŽçš„åŽç»­å­¦ä¹ ï¼Œè¿™é‡Œå°±å…ˆä¸è¯´å•¦ï¼ˆå…¶å®žæ˜¯æˆ‘ä¹Ÿä¸ä¼š23333ï¼‰ã€‚ç”±äºŽæˆ‘å¯¹markdownè¯­æ³•ä¸å¤ªç†Ÿæ‚‰ï¼Œå†™èµ·æ–‡ç« æ¥çš„æœ‰ç‚¹åˆ«æ‰­è¿˜æœ›ç†è§£ï¼ˆé€ƒã€‚ å†™ç»™è‡ªå·± è¿˜æ˜¯è¦å¤šèŠ±ç‚¹æ—¶é—´å­¦ä¹ å•Šï¼ä¸€ä¸ªå¤šæœˆæ²¡å­¦ä¹ å°±å¿˜å¾—å·®ä¸å¤šäº†orz,è¿˜å¥½çœ‹ä¸€ä¸‹å°±èƒ½å›žæƒ³èµ·æ¥ã€‚å¤šç»ƒä¹ å§ï¼]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[my_bayes]]></title>
    <url>%2F2018%2F03%2F13%2Fmy-bayes%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ¬å‘¨ä¸€æ™šä¸Šè€å¸ˆè®²åˆ°äº†naive bayesï¼ˆæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼‰ï¼ŒäºŽæ˜¯è‡ªå·±ç”¨pythonæ¥å®žçŽ°äº†ä¸€ä¸‹ã€‚çŽ°åœ¨è¿™ä¸ªè„šæœ¬å¯¹äºŽæ¯”è¾ƒå¤§çš„æ•°æ®å¯èƒ½ä¼šè®¡ç®—çš„æ¯”è¾ƒæ…¢ï¼Œè¿˜éœ€è¦ä»¥åŽæ…¢æ…¢å†ç ”ç©¶ä¸€ä¸‹é‡Œé¢çš„åŠ é€Ÿã€‚ æœ¬ç¨‹åºä¸»è¦åˆ©ç”¨äº†pandasé‡Œdataframeçš„groupbyåˆ†ç»„å‡½æ•°ï¼Œå¤§å¤§çš„æ–¹ä¾¿äº†å¯¹æ•°æ®çš„ç»Ÿè®¡ã€‚å¯¹äºŽæ¡ä»¶æ¦‚çŽ‡ï¼Œæœ‰ä¸åŒçš„æ ‡ç­¾ï¼Œä¸åŒçš„ç‰¹å¾å’Œç‰¹å¾é‡Œçš„ä¸åŒæ•°æ®ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†dictæ•°æ®ç»“æž„ï¼Œç¬¬ä¸€å±‚keyä¸ºæ ‡ç­¾ï¼Œvalueæ˜¯ä¸€ä¸ªæ–°çš„dictï¼›ç¬¬äºŒå±‚ï¼ˆå‰é¢é‚£ä¸ªæ–°çš„dictï¼‰çš„keyä¸ºç‰¹å¾ï¼Œvalueæ˜¯ä¸€ä¸ªSeriesæˆ–è€…å­—å…¸ï¼›ç¬¬ä¸‰å±‚çš„key/indexä¸ºç‰¹å¾çš„å–å€¼ï¼Œvalueä¸ºé¢‘æ•°/æ¦‚çŽ‡ã€‚ã€ã€ï¼ˆè™½ç„¶çœ‹èµ·æ¥æ¯”è¾ƒæ‹—å£ï¼Œä½†æˆ‘æ„Ÿè§‰è¿™æ ·èƒ½å¤Ÿæ¯”è¾ƒæ¸…æ™°çš„åˆ†æ¸…äº†å„ä¸ªæ¡ä»¶æ¦‚çŽ‡äº†ï¼Œå¦‚æžœä½ æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œæ¬¢è¿Žç•™è¨€ç»™æˆ‘ï¼Œè°¢è°¢ã€‚ï¼‰ ç®—æ³• è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›†åŠå…¶æ ‡ç­¾é›†ï¼Œè¦é¢„æµ‹çš„æ•°æ®é›† ç»Ÿè®¡å„æ ‡ç­¾å‡ºçŽ°çš„é¢‘æ•°ï¼Œå¹¶æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ï¼Œè®¡ç®—å…ˆéªŒæ¦‚çŽ‡ ç»Ÿè®¡åœ¨å„æ ‡ç­¾ä¸‹å„ä¸ªç‰¹å¾çš„é¢‘æ•°ï¼Œå¹¶æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ï¼Œè®¡ç®—æ¡ä»¶æ¦‚çŽ‡ æŸ¥æ‰¾è¦é¢„æµ‹æ•°æ®é›†å„ç‰¹å¾åœ¨ä¸åŒæ ‡ç­¾ä¸‹çš„æ¡ä»¶æ¦‚çŽ‡å’Œå…ˆéªŒæ¦‚çŽ‡ç›¸ä¹˜å¾—åˆ°ï¼ˆåŠï¼‰åŽéªŒæ¦‚çŽ‡ å¯¹åŠåŽéªŒæ¦‚çŽ‡è¿›è¡Œä»Žå¤§åˆ°å°æŽ’åºï¼Œé€‰å‡ºæœ€å¤§å€¼å¯¹åº”çš„æ ‡ç­¾ï¼Œå³ä¸ºé¢„æµ‹ç»“æžœ å®žä¾‹åŒ–æµ‹è¯•psï¼šè¿™é‡ŒåŠåŽéªŒæ¦‚çŽ‡ä¸ºæˆ‘è‡ªå·±çš„å®šä¹‰ï¼š$P(Y_j) *\prod_{i=1}^N P(A_i|Y_j) ; i:1\to n_{feature}; j:1\to n_{label}$ è§£é‡Šæœ¬ç¨‹åºä¸»è¦åˆ†ä¸ºä¸€ä¸‹éƒ¨åˆ†ï¼š å®šä¹‰ä¸€ä¸ªbayesåˆ†ç±»å™¨ï¼ˆç±»ï¼‰ è®¡ç®—å…ˆéªŒæ¦‚çŽ‡ è®¡ç®—æ‰€æœ‰æ¡ä»¶æ¦‚çŽ‡ è¿›è¡Œè°ƒç”¨è®­ç»ƒ å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œé¢„æµ‹ å®žä¾‹åŒ–æµ‹è¯• ä»¥ä¸Šå„å¯¹åº”ä¹‹ä¸‹çš„å„ä¸ªå‡½æ•°ï¼šï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œç›´æŽ¥ä¸Šä»£ç ï¼‰ ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import numpy as npimport pandas as pdclass my_naive_bayes(object): def __init__(self, df): super(my_naive_bayes, self).__init__() self.df = df self.X_train = df.iloc[:,:-1] self.y_train = df.iloc[:,-1] self.label_set = set(self.y_train) self.features = df.columns[:-1] self.label_name = df.columns[-1] self.feature_dict = &#123;&#125; self.n_sample = len(df) def get_prior_p(self, g): n = len(g) prior_p = &#123;&#125; for label in self.label_set: prior_p[label] = g.size()[label] / self.n_sample return prior_p def get_cond_p(self, g): cond_p = &#123;&#125; for label, group in g: cond_p[label] = &#123;&#125; for feature in self.features: counts = group[feature].value_counts() cond_p[label][feature] = counts / sum(counts) return cond_p def train(self, ): for feature in self.features: self.feature_dict[feature] = set(self.df[feature]) g = self.df.groupby(self.label_name) self.prior_p = self.get_prior_p(g) self.cond_p = self.get_cond_p(g) return self def predict_one(self, test_X): semi_post_p = &#123;&#125; for label in self.label_set: temp = 1 for feature in self.features: temp = temp * self.cond_p[label][feature][test_X[feature]] semi_post_p[label] = self.prior_p[label] * temp return max(semi_post_p, key=semi_post_p.get)if __name__ == '__main__': df = pd.read_excel("bayes_data.xlsx",index_col="index") # n = len(df) # train_n = int(n*0.6) # train_df = df[:train_n] # test_df = df[train_n:] bayes = my_naive_bayes(df) bayes = bayes.train() test_x = df.loc[6] label = bayes.predict_one(test_x) print(label) æœ€åŽï¼Œå¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Šï¼]]></content>
      <categories>
        <category>machine_leanring</category>
        <category>code</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[18_03_07]]></title>
    <url>%2F2018%2F03%2F07%2F18-03-07%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©æ˜¯å¼€å­¦ç¬¬ä¸‰å¤©ï¼Œå„ç§äº‹æƒ…èŽ«åçƒ¦èºã€‚]]></content>
      <categories>
        <category>diary</category>
      </categories>
      <tags>
        <tag>diary</tag>
        <tag>life-style</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SVM explained-well]]></title>
    <url>%2F2018%2F03%2F02%2FSVM-explained-well%2F</url>
    <content type="text"><![CDATA[Support vector machines (SVM) User copperking stepped up to the plate: â€œWe have 2 colors of balls on the table that we want to separate. We get a stick and put it on the table, this works pretty well right? Some villain comes and places more balls on the table, it kind of works but one of the balls is on the wrong side and there is probably a better place to put the stick now. SVMs try to put the stick in the best possible place by having as big a gap on either side of the stick as possible. Now when the villain returns the stick is still in a pretty good spot. There is another trick in the SVM toolbox that is even more important. Say the villain has seen how good you are with a stick so he gives you a new challenge. svm7-300x167.png Thereâ€™s no stick in the world that will let you split those balls well, so what do you do? You flip the table of course! Throwing the balls into the air. Then, with your pro ninja skills, you grab a sheet of paper and slip it between the balls. Now, looking at the balls from where the villain is standing, they balls will look split by some curvy line. Boring adults the call balls data, the stick a classifier, the biggest gap trick optimization, call flipping the table kernelling and the piece of paper a hyperplane.â€ I think the last step is the most beautiful no mater in mathematic or machine learning! Hope it will help you. source: http://bytesizebio.net/2014/02/05/support-vector-machines-explained-well/]]></content>
      <categories>
        <category>theory</category>
      </categories>
      <tags>
        <tag>machine_leanring</tag>
        <tag>fun math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[new-post]]></title>
    <url>%2F2018%2F02%2F27%2Fnew-post%2F</url>
    <content type="text"><![CDATA[this is a test blog.welcome to treamyâ€™s world. Create a new post1$ hexo new "My New Post" add some code1&gt;&gt;&gt; print("My New Post") æ ‡ç­¾é¡µé¢1&gt;è¿è¡Œä»¥ä¸‹å‘½ä»¤1$ hexo new page "tags" åŒæ—¶ï¼Œåœ¨/sourceç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ªtagsæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªindex.mdæ–‡ä»¶ æŽ¨é€åˆ°æœåŠ¡å™¨ä¸Š1$ hexo g -d å…ˆgenerateä¸€ä¸‹ç”Ÿæˆé™æ€é¡µé¢ï¼Œå†deployéƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚å¥½åƒhexo d -gä¹Ÿå¯ä»¥ã€‚ã€‚ä¸€æ¬¡è®°é”™äº†å†™æˆè¿™ä¸ªä¹Ÿè¡Œã€‚ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥åœ¨ä¸€ä¸ªç½‘é¡µä¸Šçœ‹åˆ°è¯´ä»–ä»¬å·¦å³æ˜¯ç›¸åŒçš„ï¼Œè¿˜æ˜¯ç”¨å‰é¢é‚£ä¸ªè¾ƒå¥½è§£è¯»çš„å§ã€‚]]></content>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F02%2F27%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
