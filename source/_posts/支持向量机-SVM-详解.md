---
title: æ”¯æŒå‘é‡æœº(SVM)è¯¦è§£
tags:
  - machine_leanring
  - python
categories:
  - machine_leanring
  - code
mathjax: true
date: 2018-05-07 12:48:26
---




> P.S. é‰´äºŽä¸ªäººæ°´å¹³æœ‰é™ï¼Œè‹¥æœ‰è¡¨è¿°é”™è¯¯ä¹‹å¤„æ•¬è¯·æŒ‡å‡ºï¼Œæ„¿æˆ‘ä»¬å…±åŒè¿›æ­¥~

# åŸºæœ¬åž‹æŽ¨å¯¼

SVMä¸€ç›´æ˜¯æˆ‘æœ€å–œæ¬¢çš„å‡ ä¸ªç®—æ³•ä¹‹ä¸€ï¼Œæ‰€ä»¥æ²¡äº‹å–œæ¬¢æŽ¨ä¸€æŽ¨ã€‚

è¿™é‡Œå°è¯•ç”¨ç®€å•ç›´ç™½çš„è¯­è¨€æ¥å¯¹å®ƒçš„æŽ¨å¯¼è¿‡ç¨‹è¿›è¡Œä»‹ç»~å¦‚æžœä½ è§‰å¾—ä½ å·²ç»æŠŠé«˜æ•°å’Œé«˜ä¸­æ•°å­¦å¿˜å¾—å·®ä¸å¤šäº†ï¼Œæˆ‘æƒ³è¿™æˆ–è®¸å°±æ˜¯ä½ ä¸€ç›´åœ¨æ‰¾çš„ç®€æ˜ŽSVMæŽ¨å¯¼è¿‡ç¨‹ä»‹ç»~ðŸ˜‹

ç»™å®š$D=\{(x_1,y_1),(x_2,y_2),...,(x_m,y_m)\},y_i \in \{-1,+1\}$ï¼ŒSVMè€ƒè™‘åŸºäºŽè®­ç»ƒé›†$D$åœ¨æ ·æœ¬ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢(hiperplane)ï¼Œå°†ä¸åŒç±»åˆ«çš„æ ·æœ¬åˆ†å¼€ã€‚

![å›¾1](/images/SVM/P1.png)


åˆ’åˆ†è¶…å¹³é¢æ–¹ç¨‹ï¼š
$${\bf \omega}^Tx+b=0 \tag{1}$$
ï¼ˆåˆ«æ…Œï¼Œå®ƒå…¶å®žå°±æ˜¯ä¸€æ¡ç›´çº¿å…¬å¼è€Œå·²ï¼‰
å…¶ä¸­$\omega=(\omega_1;\omega_2;...;\omega_d;)$ä¸ºæ³•å‘é‡ï¼Œå†³å®šäº†è¶…å¹³é¢çš„æ–¹å‘ï¼›$b$ä¸ºä½ç§»é¡¹ï¼Œå†³å®šäº†è¶…å¹³é¢ä¸ŽåŽŸç‚¹ä¹‹é—´çš„è·ç¦»ã€‚é€šå¸¸åˆ’åˆ†è¶…å¹³é¢ç”¨$(\omega,b)$æ¥è¡¨ç¤ºï¼Œå› ä¸ºå…¶å¯è¢«æ³•å‘é‡$\omega$å’Œä½ç§»$b$ç¡®å®šã€‚
æ ·æœ¬ç©ºé—´ä¸­ä»»æ„ç‚¹$x$åˆ°è¶…å¹³é¢$(\omega,b)$çš„è·ç¦»å¯å†™ä¸º
$$r=\frac{|\omega^Tx+b|}{||\omega||} \tag{2}$$
ï¼ˆå†æ¬¡åˆ«æ…Œï¼Œè®©æˆ‘ä»¬è½¬åŠ¨æˆ‘ä»¬æŽŒæ¡äº†åˆä¸­æ•°å­¦çŸ¥è¯†çš„å°è„‘ç“œæ¥æƒ³ä¸€ä¸‹ï¼Œå…¶å®žè¿™å°±æ˜¯ç‚¹åˆ°ç›´çº¿çš„è·ç¦»å…¬å¼å¯¹å§ï¼‰
å‡è®¾è¶…å¹³é¢$(\omega,b)$èƒ½å°†è®­ç»ƒæ ·æœ¬æ­£ç¡®åˆ†ç±»ï¼Œå¯¹äºŽ$(x_i,y_i)\in D$,æœ‰ä»¥ä¸‹å¼å­ï¼š
$$\begin{cases}\omega^Tx_i+b > 0, & y_i = +1\\\omega^Tx_i+b < 0, & y_i = -1\end{cases} \tag{3}$$
è¿™å…¶å®žä¾¿æ˜¯**é€»è¾‘å›žå½’**çš„æ€è·¯ï¼Œéžé»‘å³ç™½ï¼Œä½†æ˜¯è¿™æ˜Žæ˜¾å¯¹è‡ªå·±çš„ç®—æ³•å¤ªè‡ªä¿¡äº†å¯¹å§ã€‚æˆ‘ä»¬å¯çˆ±çš„æ”¯æŒå‘é‡æœºå¯¹æ­¤è¡¨ç¤ºæ€€ç–‘ï¼Œå¹¶ä¸”å¤šç•™äº†ä¸€ä¸ªå¿ƒçœ¼ï¼ŒäºŽæ˜¯å®ƒä»¤ï¼š
$$\begin{cases}\omega^Tx_i+b \geq +1, & y_i = +1\\\omega^Tx_i+b \leq -1, & y_i = -1\end{cases} \tag{4}$$

å¦‚å›¾æ‰€ç¤ºï¼š
![å›¾2](/images/SVM/P2.jpg)

å…¶ä¸­è·ç¦»åˆ’åˆ†è¶…å¹³é¢æœ€è¿‘çš„å‡ ä¸ªè®­ç»ƒæ ·æœ¬ç‚¹ä½¿ä¸Šå¼çš„ç­‰å·æˆç«‹ï¼Œè¿™å‡ ä¸ªè®­ç»ƒæ ·æœ¬å°±è¢«ç§°ä½œ**æ”¯æŒå‘é‡ï¼ˆsupport vectorï¼‰**ï¼Œä¸¤ä¸ªå¼‚ç±»æ”¯æŒå‘é‡åˆ°è¶…å¹³é¢çš„è·ç¦»ä¹‹å’Œï¼Œä¹Ÿç§°ä¸º**é—´éš”ï¼ˆmarginï¼‰**ï¼Œä¸º
$$\gamma = \frac{2}{||\omega||} \tag{5}$$
(å…¶å®žå°±æ˜¯ $\omega^Tx_i+b = +1 $å’Œ$ \omega^Tx_i+b = -1 $ä¸¤ä¸ªè¶…å¹³é¢ä¹‹é—´çš„è·ç¦»å…¬å¼)

é‚£ä¹ˆæŒ‰æˆ‘ä»¬çš„è®¾æƒ³ï¼Œæˆ‘ä»¬åšåˆ†ç±»å­¦ä¹ ï¼Œå®žé™…ä¸Šå°±æ˜¯ä¸ºäº†æ‰¾åˆ°ä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢å°†è¿™äº›æ ·æœ¬ç»™éš”å¼€ï¼Œé‚£ä¹ˆä»€ä¹ˆæ ·å­çš„åˆ’åˆ†è¶…å¹³é¢æ˜¯æœ€æœ‰æ•ˆçš„å‘¢ï¼Ÿ
ä»Žç›´è§‚ä¸Šæ¥çœ‹ï¼Œä½äºŽæ­£è´Ÿæ ·æœ¬â€œæ­£ä¸­é—´â€çš„åˆ’åˆ†è¶…å¹³é¢ï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾**çº¢è‰²**çš„é‚£ä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢ï¼Œåº”è¯¥æ˜¯æœ€å¥½çš„ï¼Œå› ä¸ºå®ƒçš„é²æ£’æ€§æœ€å¥½ï¼Œå¯¹æœªçŸ¥æ ·æœ¬çš„æ³›åŒ–æ€§æœ€å¥½ã€‚

## é‚£ä¹ˆå¦‚ä½•åŽ»å¾—åˆ°è¿™ä¸ªåˆšå¥½ä½äºŽæ­£è´Ÿæ ·æœ¬â€œæ­£ä¸­é—´â€çš„åˆ’åˆ†è¶…å¹³é¢å‘¢ï¼Ÿ

æ€è€ƒä¸€ä¸‹ï¼Œæ˜¯ä¸æ˜¯åªè¦æˆ‘ä»¬è®©é—´éš”æœ€å¤§ï¼Œè¿™æ ·åªè¦æˆ‘ä»¬å–é—´éš”ä¸­é—´çš„é‚£æ¡ç›´çº¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªæœ€æ£’çš„åˆ’åˆ†è¶…å¹³é¢äº†ï¼Ÿ
æ¢å¥è¯è¯´ï¼Œå¯¹äºŽåŸºäºŽSVMçš„åˆ†ç±»å­¦ä¹ è€Œè¨€ï¼Œé—®é¢˜å·²ç»ä»Žæ‰¾åˆ°ä¸€ä¸ªæœ€å¥½çš„åˆ’åˆ†è¶…å¹³é¢è½¬æ¢ä¸ºäº†æ‰¾åˆ°æ ·æœ¬ç©ºé—´é‡Œçš„æœ€å¤§åŒ–é—´éš”ã€‚
æˆ‘ä»¬ç”¨æ•°å­¦è¯­è¨€æ¥æè¿°ä¸€ä¸‹è¿™ä¸ªæ›´æ–°åŽçš„é—®é¢˜ï¼Œå°±å˜æˆäº†æ‰¾åˆ°èƒ½æ»¡è¶³$å¼(4)$çš„çº¦æŸæ¡ä»¶çš„å‚æ•°$\omega$å’Œ$b$ï¼Œå¹¶ä¸”è¦ä½¿å¾—$\gamma = \frac{2}{||\omega||}$ä¸­çš„$\gamma$æœ€å¤§ã€‚
ç”¨æ•°å­¦å…¬å¼æ¥è¡¨ç¤ºæ˜¯è¿™ä¸ªæ ·å­:
$$max_{\omega,b} \frac{2}{||\omega||},s.t. y_i(\omega^Tx_i+b) \geq 1, i = 1,2,...,m \tag{6}$$
OKï¼Œä½ å¯èƒ½ä¼šå–Šï¼š
ç­‰ç­‰ç­‰ç­‰ï¼Œ$max_{\omega,b} \frac{2}{||\omega||}$æ˜¯è¡¨ç¤º$\max ,\gamma$æˆ‘æ‡‚ï¼Œä½†æ˜¯ä½ è¿™ä¸ªæ¡ä»¶$y_i(\omega^Tx_i+b) \geq 1, i = 1,2,...,m$æ˜¯ä»€ä¹ˆé¬¼ä½ è¦ä¸è¦è§£é‡Šä¸€ä¸‹ï¼Ÿ

å—¯å’³ï¼Œè®©æˆ‘ä»¬æš‚åœä¸€ä¸‹ï¼Œå›žçœ‹ä¸€ä¸‹çº¦æŸæ¡ä»¶(å³æ­£ç¡®åˆ†ç±»çš„æ¡ä»¶)ï¼š
$$\begin{cases}\omega^Tx_i+b \geq +1, & y_i = +1\\\omega^Tx_i+b \leq -1, & y_i = -1\end{cases} \tag{7}$$
æ³¨æ„ï¼Œæ˜¯ä¸æ˜¯ä¸Šä¸‹ä¸¤ä¸ªçº¦æŸæ¡ä»¶çš„å·¦å³å¼å­ç›¸ä¹˜ï¼ˆ$ \omega^Tx_i+b \geq +1 * y_i = +1$ or $\omega^Tx_i+b \leq -1 * y_i = -1$ ï¼‰å°±ç­‰äºŽ$y_i(\omega^Tx_i+b) \geq 1$äº†ï¼Ÿ

OKï¼Œè®©æˆ‘ä»¬ç»§ç»­å¾€ä¸‹ã€‚å¯¹äºŽå¼å­
$$max_{\omega,b} \frac{2}{||\omega||},s.t. y_i(\omega^Tx_i+b) \geq 1, i = 1,2,...,m \tag{8}$$
æ˜¾ç„¶ï¼Œä¸ºäº†æœ€å¤§åŒ–é—´éš”ï¼Œä»…éœ€æœ€å¤§åŒ–$\frac{1}{||\omega||}$ï¼Œä¸ºäº†ä½¿ç›®æ ‡å‡½æ•°å…‰æ»‘ä»Žè€Œæ–¹ä¾¿è®¡ç®—ï¼ŒäºŽæ˜¯è¿™ç­‰ä»·äºŽæœ€å°åŒ–$||\omega||^2$ã€‚
äºŽæ˜¯ä¸Šå¼æˆ‘ä»¬å¯ä»¥é‡å†™ä¸ºï¼š
$$min_{\omega,b}\frac{1}{2}||\omega||^2,s.t. y_i(\omega^Tx_i+b) \geq 1, i = 1,2,...,m \tag{9}$$
è¿™å°±æ˜¯SVMçš„**åŸºæœ¬åž‹**ã€‚

æˆ‘ä»¬éœ€è¦æ³¨æ„åˆ°ï¼Œå®ƒå…¶å®žæ˜¯ä¸€ä¸ª**å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼ˆconvex quadratic programmingï¼‰**ï¼Œå¯ä»¥ç”¨ä¹‹å‰çš„æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ±‚è§£ã€‚


## SVMçš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°

é¦–å…ˆå›žé¡¾ä¸€ä¸‹æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ ‡å‡†åž‹
$$\min \ f(x)ï¼› \ \ s.t. g_i(x) \leq 0ï¼› i = 1,...,m, h_i(x) = 0ï¼› i = 1,...,m  \tag{10}$$
ä½ å¯ä»¥çœ‹åˆ°ï¼ŒSVMåŸºæœ¬å¼ç›¸å¯¹æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ ‡å‡†åž‹è€Œè¨€ï¼Œæœ‰
$f(\omega, b) = \frac{1}{2}||\omega||^2$
$g(\omega, b) = 1-y_i(\omega^Tx_i+b) \leq 0,i=1,2,...,m.$
$h(\omega, b) = 0$

å› æ­¤ï¼Œæˆ‘ä»¬å°†SVMçš„$f(\omega, b)ã€g(\omega, b)ã€h(\omega, b)$ä»£å…¥(10)åŽï¼Œå°±å¯ä»¥å¾—åˆ°è¯¥é—®é¢˜çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°äº†ï¼Œå³
$$L(\omega,b, \alpha) = \frac{1}{2}||\omega||^2 + \sum_{i=1}^m \alpha_i (1-y_i(\omega^Tx_i + b)) \tag{11}$$
å…¶ä¸­$\alpha = (\alpha_1; \alpha_2;...;\alpha_m)$,æ‹‰æ ¼æœ—æ—¥ä¹˜å­$\alpha_i \geq 0$ã€‚

é€šå¸¸ä¸€ä¸ªä¼˜åŒ–é—®é¢˜å¯ä»¥ä»Žä¸¤ä¸ªè§’åº¦æ¥è€ƒè™‘ï¼Œå³ä¸»é—®é¢˜(primal problem)å’Œå¯¹å¶é—®é¢˜(dual problem)ã€‚åœ¨çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ä¸­ï¼Œå¸¸å¸¸åˆ©ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§å°†åŽŸå§‹é—®é¢˜ï¼ˆä¸»é—®é¢˜ï¼‰è½¬æ¢æˆå¯¹å¶é—®é¢˜ï¼Œé€šè¿‡è§£å¯¹å¶é—®é¢˜æ¥å¾—åˆ°åŽŸå§‹é—®é¢˜çš„è§£ã€‚è¿™æ ·åšæ˜¯å› ä¸ºå¯¹å¶é—®é¢˜çš„å¤æ‚åº¦å¾€å¾€ä½ŽäºŽä¸»é—®é¢˜ã€‚
æ‰€ä»¥åœ¨æ±‚è§£SVMçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿä¼šé€šè¿‡å…¶æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§ï¼Œå°†è¯¥ä¸»é—®é¢˜$å¼(9)$è½¬æ¢æˆå¯¹å¶é—®é¢˜ï¼Œç„¶åŽè¿›è¡Œæ±‚è§£ã€‚



## SVMçš„å¯¹å¶é—®é¢˜
éœ€è¦è¯´æ˜Žçš„æ˜¯ï¼Œå› ä¸ºä¸»é—®é¢˜æœ¬èº«æ˜¯ä¸€ä¸ªå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œå› æ­¤å®ƒæ˜¯èƒ½ç›´æŽ¥ç”¨çŽ°æˆçš„ä¼˜åŒ–è®¡ç®—åŒ…æ±‚è§£çš„ï¼Œä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•å¾—åˆ°å…¶å¯¹å¶é—®é¢˜æ˜¯ä¸ºäº†ä¼˜åŒ–è¿ç®—æ•ˆçŽ‡ã€‚

é‚£ä¹ˆè®©æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹SVMçš„ä¸»é—®é¢˜$å¼(9)$å’ŒSVMçš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°$å¼(10)$ï¼Œå…¶ä¸­$\alpha = (\alpha_1; \alpha_2;...;\alpha_m)$,æ‹‰æ ¼æœ—æ—¥ä¹˜å­$\alpha_i \geq 0$ã€‚

ä½ å¯ä»¥å‘çŽ°ï¼ŒSVMæ°æ°æ»¡è¶³äº†å‰é¢åšå®¢ä¸­æˆ‘ä»¬è®²è¿‡çš„çš„å¼ºå¯¹å¶æ€§ã€‚

å› æ­¤ï¼Œè€ƒè™‘ä»¤$L(\omega,b, \alpha)$å¯¹$\omega$å’Œ$b$çš„åå¯¼ä¸º0å¯å¾—
$$\omega = \sum_{i=1}^m \alpha_i y_i x_i \tag{12}$$
$$0 = \sum_{i=1}^m \alpha_i y_i \tag{13}$$
å°†å¼(12)ä»£å…¥(11)ï¼Œå°±å¯ä»¥å°†$L(\omega,b, \alpha)$ä¸­çš„$\omega$å’Œ$b$æ¶ˆåŽ»ï¼Œå†è€ƒè™‘å¼(13)çš„çº¦æŸï¼Œå°±å¾—åˆ°å¼ï¼ˆ9ï¼‰çš„å¯¹å¶é—®é¢˜ã€‚
$$max_{\alpha} \sum_{i=1}^m \alpha_i - \frac{1}{2} \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j y_i y_j x_i^T x_j \tag{14}$$
$$s.t. \sum_{i=1}^m \alpha_i y_i = 0, \alpha_i \geq 0, i=1,2,...,m$$

æ±‚è§£è¯¥æ¨¡åž‹ï¼Œè§£å‡º$\alpha$åŽï¼Œæ±‚å‡º$\omega$å’Œ$b$å³å¯å¾—åˆ°æ¨¡åž‹
$$f(x) = \omega^T x + b = \sum_{i=1}^m \alpha_i y_i x_i^Tx + b \tag{15}$$
ä»Žå¯¹å¶é—®é¢˜ï¼ˆ14ï¼‰è§£å‡ºçš„$\alpha_i$æ˜¯å¼(11)ä¸­çš„æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œå®ƒæ°å¥½å¯¹åº”ç€è®­ç»ƒæ ·æœ¬$(x_i,y_i)$ã€‚å› ä¸ºå¼(9)ä¸­æœ‰ä¸ç­‰å¼çº¦æŸï¼Œå› æ­¤ä¸Šè¿°è¿‡ç¨‹è¿˜éœ€æ»¡è¶³KKTæ¡ä»¶ï¼Œå³
$$\begin{cases}\alpha_i \geq 0\\ y_i f(x_i)-1 \geq 0\\ \alpha_i(y_i f(x_i)-1) = 0\end{cases} \tag{16}$$

äºŽæ˜¯ï¼Œå¯¹ä»»æ„è®­ç»ƒæ ·æœ¬$(x_i,y_i)$ï¼Œæ€»æœ‰$\alpha_i=0$æˆ–$y_i f(x_i)=1$ã€‚
* è‹¥$\alpha_i = 0$ï¼Œåˆ™è¯¥æ ·æœ¬å°†ä¸ä¼šåœ¨å¼ï¼ˆ4.1ï¼‰çš„æ±‚å’Œä¸­å‡ºçŽ°ï¼Œä¹Ÿå°±ä¸ä¼šå¯¹$f(x)$äº§ç”Ÿä»»ä½•å½±å“ï¼›
* è‹¥$\alpha_i > 0$ï¼Œåˆ™å¿…æœ‰$y_i f(x_i)=1$ï¼Œæ‰€å¯¹åº”çš„æ ·æœ¬ç‚¹ä½äºŽæœ€å¤§é—´éš”è¾¹ç•Œä¸Šï¼Œæ˜¯ä¸€ä¸ªæ”¯æŒå‘é‡ã€‚

è¿™æ˜¾ç¤ºå‡ºæ”¯æŒå‘é‡æœºçš„ä¸€ä¸ªé‡è¦æ€§è´¨ï¼š
> è®­ç»ƒå®ŒæˆåŽï¼Œå¤§éƒ¨åˆ†çš„è®­ç»ƒæ ·æœ¬éƒ½ä¸éœ€ä¿ç•™ï¼Œæœ€ç»ˆæ¨¡åž‹ä»…ä¸Žæ”¯æŒå‘é‡æœ‰å…³ã€‚

é‚£ä¹ˆå¦‚ä½•æ±‚è§£å¼ï¼ˆ14ï¼‰å‘¢ï¼Ÿ
ä¸éš¾å‘çŽ°ï¼Œè¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œå¯ä½¿ç”¨é€šç”¨çš„äºŒæ¬¡è§„åˆ’ç®—æ³•æ¥æ±‚è§£ï¼Œè¿™ä¸€éƒ¨åˆ†å¯ä»¥å‚è€ƒåˆšæ‰å¯¹ã€äºŒæ¬¡è§„åˆ’ã€‘çš„è®²è§£ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨SMOç­‰ç®—æ³•å¯¹å…¶è¿›è¡Œæ±‚è§£ã€‚
å…³äºŽSMOç®—æ³•ï¼Œæˆ‘ä»¬å°±ä¸‹æ¬¡å†è¯´å•¦~

# ç¼–ç¨‹å®žçŽ°
è§æˆ‘GitHubã€‚


# å‚è€ƒèµ„æ–™

> [1] ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æŽèˆª è‘—  æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾
> [2]ã€Šæœºå™¨å­¦ä¹ ã€‹ å‘¨å¿—åŽ è‘— æ¸…åŽå¤§å­¦å‡ºç‰ˆç¤¾
> [3] Stanford CS229 Machine Learningçš„æ•™å­¦èµ„æ–™ï¼šhttp://cs229.stanford.edu/section/cs229-cvxopt.pdf
